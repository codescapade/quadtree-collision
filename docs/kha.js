!function(e,t){"use strict";e.kha=e.kha||{},e.kha.input=e.kha.input||{};var i,r={},n=function(){return R.__string_rec(this,"")},a=a||{};function s(e,t){var i=Object.create(e);for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var o=function(e,t,i,r,n,a,s,o){this.bounds=new li(e-.5*i,t-.5*r,i,r),this.xVelocity=n,this.yVelocity=a,this.worldBounds=s,this.image=o,this.collided=!1,this.selected=!1};r.Box=o,o.__name__=!0,o.prototype={xVelocity:null,yVelocity:null,bounds:null,collided:null,selected:null,color:null,worldBounds:null,image:null,update:function(e){this.bounds.x+=this.xVelocity*e,this.bounds.y+=this.yVelocity*e,this.bounds.x<this.worldBounds.x?(this.bounds.x=this.worldBounds.x,this.xVelocity=-this.xVelocity):this.bounds.x+this.bounds.width>this.worldBounds.x+this.worldBounds.width&&(this.bounds.x=this.worldBounds.x+this.worldBounds.width-this.bounds.width,this.xVelocity=-this.xVelocity),this.bounds.y<this.worldBounds.y?(this.bounds.y=this.worldBounds.y,this.yVelocity=-this.yVelocity):this.bounds.y+this.bounds.height>this.worldBounds.y+this.worldBounds.height&&(this.bounds.y=this.worldBounds.y+this.worldBounds.height-this.bounds.height,this.yVelocity=-this.yVelocity)},render:function(e){this.selected?this.color=-16711936:this.collided?this.color=-65536:this.color=-1,e.set_color(this.color),e.drawScaledImage(this.image,this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height)},__class__:o};var l=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};r.EReg=l,l.__name__=!0,l.prototype={r:null,match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw new M("EReg::matched")},__class__:l};var u=function(){};r.HxOverrides=u,u.__name__=!0,u.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(t[0]),i.setUTCMinutes(t[1]),i.setUTCSeconds(t[2]),i;case 10:var r=e.split("-");return new Date(r[0],r[1]-1,r[2],0,0,0);case 19:var n=e.split(" "),a=n[0].split("-"),s=n[1].split(":");return new Date(a[0],a[1]-1,a[2],s[0],s[1],s[2]);default:throw new M("Invalid date format : "+e)}},u.cca=function(e,t){var i=e.charCodeAt(t);if(i==i)return i},u.substr=function(e,t,i){if(null==i)i=e.length;else if(i<0){if(0!=t)return"";i=e.length+i}return e.substr(t,i)},u.remove=function(e,t){var i=e.indexOf(t);return-1!=i&&(e.splice(i,1),!0)},u.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(e){this.buttonDown=!1,this.mouseY=0,this.mouseX=0,this.world=e,Vt.get().notify(ui(this,this.mouseDown),ui(this,this.mouseUp),ui(this,this.mouseMove),null),Lt.get().notify(ui(this,this.keyDown),null)};r.Input=h,h.__name__=!0,h.prototype={world:null,mouseX:null,mouseY:null,buttonDown:null,update:function(){this.buttonDown&&this.world.createBox(this.mouseX,this.mouseY)},mouseDown:function(e,t,i){this.mouseX=t,this.mouseY=i,this.buttonDown=!0,this.world.selectBoxes(t,i)},mouseUp:function(e,t,i){this.buttonDown=!1},mouseMove:function(e,t,i,r){this.buttonDown&&(this.mouseX=e,this.mouseY=t)},keyDown:function(e){80==e?this.world.togglePause():71==e?this.world.toggleGrid():82==e&&this.world.reset()},__class__:h};var d=function(){};r.Main=d,d.__name__=!0,d.main=function(){fe.start(new ce("Quadtree Collision",d.width,d.height,null,null),function(e){z.loadEverything(function(){d.lastTime=ue.time(),d.backBuffer=j.createRenderTarget(d.width,d.height),d.world=new p(1,100,d.width-1,d.height-100),ue.addTimeTask(d.update,0,.016666666666666666),fe.notifyOnFrames(d.render)})})},d.update=function(){var e=ue.time(),t=e-d.lastTime;d.world.update(t),d.lastTime=e},d.render=function(e){d.backBuffer.get_g2().begin(),d.world.render(d.backBuffer.get_g2()),d.backBuffer.get_g2().end();var t=e[0].get_g2();t.begin(),se.scale(d.backBuffer,e[0],fe.get_screenRotation()),t.end()},Math.__name__=!0;var c=function(){};r.Reflect=c,c.__name__=!0,c.field=function(e,t){try{return e[t]}catch(e){e instanceof M&&e.val;return null}},c.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)};var f=function(){};r.Std=f,f.__name__=!0,f.string=function(e){return R.__string_rec(e,"")},f.parseInt=function(e){if(null!=e)for(var t=0,i=e.length;t<i;){var r=t++,n=e.charCodeAt(r);if(n<=8||n>=14&&32!=n&&45!=n){var a=parseInt(e,"x"==e[r+1]||"X"==e[r+1]?16:10);return isNaN(a)?null:a}}return null};var _=function(){};r.StringTools=_,_.__name__=!0,_.endsWith=function(e,t){var i=t.length,r=e.length;return r>=i&&e.indexOf(t,r-i)==r-i};var g=function(){};r.Type=g,g.__name__=!0,g.createEnum=function(e,t,i){var r=c.field(e,t);if(null==r)throw new M("No such constructor "+t);if(c.isFunction(r)){if(null==i)throw new M("Constructor "+t+" need parameters");return r.apply(e,i)}if(null!=i&&0!=i.length)throw new M("Constructor "+t+" does not need parameters");return r},g.getInstanceFields=function(e){var t=[];for(var i in e.prototype)t.push(i);return u.remove(t,"__class__"),u.remove(t,"__properties__"),t};var m={};r["_UInt.UInt_Impl_"]=m,m.__name__=!0,m.gt=function(e,t){var i=e<0;return i!=t<0?i:e>t},m.gte=function(e,t){var i=e<0;return i!=t<0?i:e>=t},m.toFloat=function(e){return e<0?4294967296+e:e+0};var p=function(e,t,i,r){this.collisions=0,this.fps=0,this.boxesSelected=0,this.showGrid=!0,this.paused=!1,this.calculations=0,this.fontSize=20,this.bounds=new li(e,t,i,r),this.tree=new oi(this.bounds),this.boxes=[],this.collisionList=[],this.font=z.fonts.get("kenney_mini"),this.boxImage=z.images.get("square"),this.frameTimes=[],this.lastFrameTime=ue.realTime(),this.input=new h(this)};r.World=p,p.__name__=!0,p.prototype={tree:null,bounds:null,input:null,boxes:null,collisionList:null,font:null,fontSize:null,boxImage:null,frameTimes:null,lastFrameTime:null,calculations:null,paused:null,showGrid:null,boxesSelected:null,fps:null,collisions:null,update:function(e){this.input.update(),this.paused||this.checkCollisions(e)},render:function(e){this.showGrid?this.tree.drawTree(e):(e.set_color(-1),e.drawRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height));for(var t=0,i=this.boxes;t<i.length;){var r=i[t];++t,r.render(e)}this.updateFPS(),this.renderText(e)},togglePause:function(){this.paused=!this.paused,this.paused||(this.boxesSelected=0)},toggleGrid:function(){this.showGrid=!this.showGrid},selectBoxes:function(e,t){if(this.paused){for(var i=0,r=this.boxes;i<r.length;){var n=r[i];++i,n.selected=!1}this.boxesSelected=0;for(var a=0,s=this.boxes;a<s.length;){var o=s[a];if(++a,o.bounds.hasPoint(e,t)){o.selected=!0;var l=this.tree.getShapeList(o);this.boxesSelected=l.length+1;for(var u=0;u<l.length;){var h=l[u];++u,h.selected=!0}break}}}},reset:function(){for(;this.boxes.length>0;)this.boxes.pop();this.tree.clear()},createBox:function(e,t){if(!this.paused){var i=this.rndInRange(-200,200),r=this.rndInRange(-200,200),n=Math.floor(this.rndInRange(8,12)),a=Math.floor(this.rndInRange(8,12)),s=new o(e,t,n,a,i,r,this.bounds,this.boxImage);this.boxes.push(s)}},checkCollisions:function(e){this.tree.clear();for(var t=0,i=this.boxes;t<i.length;){var r=i[t];++t,r.update(e),r.collided=!1,r.selected=!1,this.tree.insert(r)}this.calculations=0,this.collisions=0;for(var n=0,a=this.boxes;n<a.length;){var s=a[n];for(++n;this.collisionList.length>0;)this.collisionList.pop();this.tree.getShapeList(s,this.collisionList);for(var o=0,l=this.collisionList;o<l.length;){var u=l[o];++o,this.calculations++,s.bounds.intersects(u.bounds)&&(s.collided=!0,this.collisions++)}}},updateFPS:function(){var e=ue.realTime();this.frameTimes.push(e-this.lastFrameTime),this.lastFrameTime=e,this.frameTimes.length>100&&this.frameTimes.shift();for(var t=0,i=0,r=this.frameTimes;i<r.length;){var n=r[i];++i,t+=n}t/=this.frameTimes.length,this.fps=Math.ceil(1/t)},renderText:function(e){e.set_font(this.font),e.set_fontSize(this.fontSize),e.set_color(-1),e.drawString("FPS: "+this.fps,20,10),e.drawString("Boxes: "+this.boxes.length,20,40),e.drawString("Boxes selected: "+this.boxesSelected,20,70),e.drawString("Collision checks",330,10),this.paused&&e.drawString("Paused",330,70),e.drawString("With quadtree:",500,10),e.drawString(""+this.calculations,670,10),e.drawString("Without quadtree:",500,40),e.drawString(""+this.boxes.length*this.boxes.length,670,40),e.drawString("Total collisions:",500,70),e.drawString(""+this.collisions,670,70)},rndInRange:function(e,t){return Math.random()*(t-e)+e},__class__:p};var v=function(){};r["haxe.IMap"]=v,v.__name__=!0,v.__isInterface__=!0;var b=function(){};r["haxe.Log"]=b,b.__name__=!0,b.formatOutput=function(e,t){var i=f.string(e);if(null==t)return i;var r=t.fileName+":"+t.lineNumber;if(null!=t.customParams)for(var n=0,a=t.customParams;n<a.length;){var s=a[n];++n,i+=", "+f.string(s)}return r+": "+i},b.trace=function(e,t){var i=b.formatOutput(e,t);"undefined"!=typeof console&&null!=console.log&&console.log(i)};var w=function(){};r["haxe._Unserializer.DefaultResolver"]=w,w.__name__=!0,w.prototype={resolveClass:function(e){return r[e]},resolveEnum:function(e){return a[e]},__class__:w};var y=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=y.DEFAULT_RESOLVER;null==t&&(t=new w,y.DEFAULT_RESOLVER=t),this.resolver=t};r["haxe.Unserializer"]=y,y.__name__=!0,y.initCodes=function(){for(var e=[],t=0,i=y.BASE64.length;t<i;){var r=t++;e[y.BASE64.charCodeAt(r)]=r}return e},y.run=function(e){return new y(e).unserialize()},y.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var e=0,t=!1,i=this.pos;;){var r=this.buf.charCodeAt(this.pos);if(r!=r)break;if(45!=r){if(r<48||r>57)break;e=10*e+(r-48),this.pos++}else{if(this.pos!=i)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(t>=43&&t<58||101==t||69==t))break;this.pos++}return parseFloat(u.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new M("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new M("Invalid object key");var i=this.unserialize();e[t]=i}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new M("Invalid enum format");var i=this.readDigits();if(0==i)return g.createEnum(e,t);for(var r=[];i-- >0;)r.push(this.unserialize());return g.createEnum(e,t,r)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new M("Class not found "+e);return t;case 66:var i=this.unserialize(),r=this.resolver.resolveEnum(i);if(null==r)throw new M("Enum not found "+i);return r;case 67:var n=this.unserialize(),a=this.resolver.resolveClass(n);if(null==a)throw new M("Class not found "+n);var s=Object.create(a.prototype);if(this.cache.push(s),s.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new M("Invalid custom data");return s;case 77:var o=new A;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw new M("Invalid string reference");return this.scache[h];case 97:this.buf;var d=[];for(this.cache.push(d);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var f=this.readDigits();d[d.length+f-1]=null}else d.push(this.unserialize())}return d;case 98:var _=new T;this.cache.push(_);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var g=this.unserialize(),m=this.unserialize();null!=mi[g]?_.setReserved(g,m):_.h[g]=m}return this.pos++,_;case 99:var p=this.unserialize(),v=this.resolver.resolveClass(p);if(null==v)throw new M("Class not found "+p);var b=Object.create(v.prototype);return this.cache.push(b),this.unserializeObject(b),b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var w=this.unserialize(),k=this.resolver.resolveEnum(w);if(null==k)throw new M("Enum not found "+w);this.pos++;var S=this.readDigits(),N=k.__constructs__.slice()[S];if(null==N)throw new M("Unknown enum index "+w+"@"+S);var C=this.unserializeEnum(k,N);return this.cache.push(C),C;case 107:return NaN;case 108:var D=new B;this.cache.push(D);for(this.buf;104!=this.buf.charCodeAt(this.pos);)D.add(this.unserialize());return this.pos++,D;case 109:return-1/0;case 110:return null;case 111:var E={};return this.cache.push(E),this.unserializeObject(E),E;case 112:return 1/0;case 113:var P=new I;this.cache.push(P);this.buf;for(var L=this.buf.charCodeAt(this.pos++);58==L;){var V=this.readDigits(),F=this.unserialize();P.h[V]=F,L=this.buf.charCodeAt(this.pos++)}if(104!=L)throw new M("Invalid IntMap format");return P;case 114:var W=this.readDigits();if(W<0||W>=this.cache.length)throw new M("Invalid reference");return this.cache[W];case 115:var R=this.readDigits(),G=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<R)throw new M("Invalid bytes length");var H=y.CODES;null==H&&(H=y.initCodes(),y.CODES=H);for(var U=this.pos,Z=3&R,O=U+(R-Z),z=new x(new ArrayBuffer(3*(R>>2)+(Z>=2?Z-1:0))),X=0;U<O;){var K=H[G.charCodeAt(U++)],j=H[G.charCodeAt(U++)];z.b[X++]=K<<2|j>>4;var Y=H[G.charCodeAt(U++)];z.b[X++]=j<<4|Y>>2;var Q=H[G.charCodeAt(U++)];z.b[X++]=Y<<6|Q}if(Z>=2){var J=H[G.charCodeAt(U++)],q=H[G.charCodeAt(U++)];if(z.b[X++]=J<<2|q>>4,3==Z){var $=H[G.charCodeAt(U++)];z.b[X++]=q<<4|$>>2}}return this.pos+=R,this.cache.push(z),z;case 116:return!0;case 118:var ee;return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(ee=u.strDate(u.substr(this.buf,this.pos,19)),this.pos+=19):ee=new Date(this.readFloat()),this.cache.push(ee),ee;case 119:var te=this.unserialize(),ie=this.resolver.resolveEnum(te);if(null==ie)throw new M("Enum not found "+te);var re=this.unserializeEnum(ie,this.unserialize());return this.cache.push(re),re;case 120:throw M.wrap(this.unserialize());case 121:var ne=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<ne)throw new M("Invalid string length");var ae=u.substr(this.buf,this.pos,ne);return this.pos+=ne,ae=decodeURIComponent(ae.split("+").join(" ")),this.scache.push(ae),ae;case 122:return 0}throw this.pos--,new M("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:y};var x=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b};r["haxe.io.Bytes"]=x,x.__name__=!0,x.ofData=function(e){var t=e.hxBytes;return null!=t?t:new x(e)},x.prototype={length:null,b:null,data:null,blit:function(e,t,i,r){if(e<0||i<0||r<0||e+r>this.length||i+r>t.length)throw new M(V.OutsideBounds);0==i&&r==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(i,i+r),e)},getFloat:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},getInt32:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t,i){if(e<0||t<0||e+t>this.length)throw new M(V.OutsideBounds);null==i&&(i=k.UTF8);var r="",n=this.b,a=e,s=e+t;switch(i._hx_index){case 0:for(;a<s;){var o=n[a++];if(o<128){if(0==o)break;r+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&n[a++];r+=String.fromCodePoint(l)}else if(o<240){var u=(31&o)<<12|(127&n[a++])<<6|127&n[a++];r+=String.fromCodePoint(u)}else{var h=(15&o)<<18|(127&n[a++])<<12|(127&n[a++])<<6|127&n[a++];r+=String.fromCodePoint(h)}}break;case 1:for(;a<s;){var d=n[a++]|n[a++]<<8;r+=String.fromCodePoint(d)}}return r},toString:function(){return this.getString(0,this.length)},__class__:x};var k=a["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}},I=function(){this.h={}};r["haxe.ds.IntMap"]=I,I.__name__=!0,I.__interfaces__=[v],I.prototype={h:null,__class__:I};var B=function(){this.length=0};r["haxe.ds.List"]=B,B.__name__=!0,B.prototype={h:null,q:null,length:null,add:function(e){var t=new S(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},__class__:B};var S=function(e,t){this.item=e,this.next=t};r["haxe.ds._List.ListNode"]=S,S.__name__=!0,S.prototype={item:null,next:null,__class__:S};var A=function(){this.h={__keys__:{}}};r["haxe.ds.ObjectMap"]=A,A.__name__=!0,A.__interfaces__=[v],A.prototype={h:null,set:function(e,i){var r=e.__id__;null==r&&(r=e.__id__=t.$haxeUID++),this.h[r]=i,this.h.__keys__[r]=e},__class__:A};var T=function(){this.h={}};r["haxe.ds.StringMap"]=T,T.__name__=!0,T.__interfaces__=[v],T.prototype={h:null,rh:null,setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},__class__:T};var N=function(){this.pos=0,this.size=0};r["haxe.io.BytesBuffer"]=N,N.__name__=!0,N.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(e){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,e)},addBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new M(V.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var r=new Uint8Array(e.b.buffer,e.b.byteOffset+t,i);this.u8.set(r,this.pos),this.pos+=i}},grow:function(e){for(var t=this.pos+e,i=0==this.size?16:this.size;i<t;)i=3*i>>1;var r=new ArrayBuffer(i),n=new Uint8Array(r);this.size>0&&n.set(this.u8),this.size=i,this.buffer=r,this.u8=n,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new x(new ArrayBuffer(0));var e=new x(this.buffer);return e.length=this.pos,e},__class__:N};var C=function(){};r["haxe.io.Input"]=C,C.__name__=!0,C.prototype={bigEndian:null,readByte:function(){throw new M("Not implemented")},readBytes:function(e,t,i){var r=i,n=e.b;if(t<0||i<0||t+i>e.length)throw new M(V.OutsideBounds);try{for(;r>0;)n[t]=this.readByte(),++t,--r}catch(e){var a=e instanceof M?e.val:e;if(!(a instanceof L))throw e}return i-r},readFullBytes:function(e,t,i){for(;i>0;){var r=this.readBytes(e,t,i);if(0==r)throw new M(V.Blocked);t+=r,i-=r}},read:function(e){for(var t=new x(new ArrayBuffer(e)),i=0;e>0;){var r=this.readBytes(t,i,e);if(0==r)throw new M(V.Blocked);i+=r,e-=r}return t},readInt32:function(){var e=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte();return this.bigEndian?r|i<<8|t<<16|e<<24:e|t<<8|i<<16|r<<24},readString:function(e,t){var i=new x(new ArrayBuffer(e));return this.readFullBytes(i,0,e),i.getString(0,e,t)},__class__:C};var D=function(e,t,i){if(null==t&&(t=0),null==i&&(i=e.length-t),t<0||i<0||t+i>e.length)throw new M(V.OutsideBounds);this.b=e.b,this.pos=t,this.len=i,this.totlen=i};r["haxe.io.BytesInput"]=D,D.__name__=!0,D.__super__=C,D.prototype=s(C.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(e){return e<0?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(0==this.len)throw new M(new L);return this.len--,this.b[this.pos++]},readBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new M(V.OutsideBounds);if(0==this.len&&i>0)throw new M(new L);this.len<i&&(i=this.len);for(var r=this.b,n=e.b,a=0,s=i;a<s;){var o=a++;n[t+o]=r[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:D});var E=function(){};r["haxe.io.Output"]=E,E.__name__=!0,E.prototype={bigEndian:null,writeByte:function(e){throw new M("Not implemented")},writeBytes:function(e,t,i){if(t<0||i<0||t+i>e.length)throw new M(V.OutsideBounds);for(var r=e.b,n=i;n>0;)this.writeByte(r[t]),++t,--n;return i},write:function(e){for(var t=e.length,i=0;t>0;){var r=this.writeBytes(e,i,t);if(0==r)throw new M(V.Blocked);i+=r,t-=r}},writeFloat:function(e){this.writeInt32(F.floatToI32(e))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:E};var P=function(){this.b=new N};r["haxe.io.BytesOutput"]=P,P.__name__=!0,P.__super__=E,P.prototype=s(E.prototype,{b:null,writeByte:function(e){this.b.addByte(e)},writeBytes:function(e,t,i){return this.b.addBytes(e,t,i),i},getBytes:function(){return this.b.getBytes()},__class__:P});var L=function(){};r["haxe.io.Eof"]=L,L.__name__=!0,L.prototype={toString:function(){return"Eof"},__class__:L};var V=a["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(i=function(e){return{_hx_index:3,e:e,__enum__:"haxe.io.Error",toString:n}},i.__params__=["e"],i)},F=function(){};r["haxe.io.FPHelper"]=F,F.__name__=!0,F.floatToI32=function(e){return F.helper.setFloat32(0,e,!0),F.helper.getInt32(0,!0)};var W={};r["haxe.io._UInt8Array.UInt8Array_Impl_"]=W,W.__name__=!0,W.fromBytes=function(e,t,i){return null==t&&(t=0),null==i&&(i=e.length-t),new Uint8Array(e.b.bufferValue,t,i)};var M=function(e){Error.call(this),this.val=e,Error.captureStackTrace&&Error.captureStackTrace(this,M)};r["js._Boot.HaxeError"]=M,M.__name__=!0,M.wrap=function(e){return e instanceof Error?e:new M(e)},M.__super__=Error,M.prototype=s(Error.prototype,{val:null,__class__:M});var R=function(){};r["js.Boot"]=R,R.__name__=!0,R.getClass=function(e){if(null==e)return null;if(e instanceof Array)return Array;var t=e.__class__;if(null!=t)return t;var i=R.__nativeClassName(e);return null!=i?R.__resolveNativeClass(i):null},R.__string_rec=function(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";var i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(e.__enum__){var r=a[e.__enum__],n=r.__constructs__[e._hx_index],s=r[n];return s.__params__?(t+="\t",n+"("+function(i){for(var r=[],n=0,a=s.__params__;n<a.length;){var o=a[n];n+=1,r.push(R.__string_rec(e[o],t))}return r}().join(",")+")"):n}if(e instanceof Array){var o="[";t+="\t";for(var l=0,u=e.length;l<u;){var h=l++;o+=(h>0?",":"")+R.__string_rec(e[h],t)}return o+="]"}var d;try{d=e.toString}catch(e){e instanceof M&&e.val;return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d){var c=e.toString();if("[object Object]"!=c)return c}var f="{\n";t+="\t";var _=null!=e.hasOwnProperty,g=null;for(g in e)_&&!e.hasOwnProperty(g)||"prototype"!=g&&"__class__"!=g&&"__super__"!=g&&"__interfaces__"!=g&&"__properties__"!=g&&(2!=f.length&&(f+=", \n"),f+=t+g+" : "+R.__string_rec(e[g],t));return f+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},R.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;if(Object.prototype.hasOwnProperty.call(e,"__interfaces__"))for(var i=e.__interfaces__,r=0,n=i.length;r<n;){var a=i[r++];if(a==t||R.__interfLoop(a,t))return!0}return R.__interfLoop(e.__super__,t)},R.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array;case fi:return"boolean"==typeof e;case di:return null!=e;case ci:return"number"==typeof e;case hi:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(R.__downcastCheck(e,t))return!0}else if("object"==typeof t&&R.__isNativeObj(t)&&e instanceof t)return!0;return t==_i&&null!=e.__name__||(t==gi&&null!=e.__ename__||null!=e.__enum__&&a[e.__enum__]==t)}},R.__downcastCheck=function(e,t){return e instanceof t||!!t.__isInterface__&&R.__interfLoop(R.getClass(e),t)},R.__cast=function(e,t){if(null==e||R.__instanceof(e,t))return e;throw new M("Cannot cast "+f.string(e)+" to "+f.string(t))},R.__nativeClassName=function(e){var t=R.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},R.__isNativeObj=function(e){return null!=R.__nativeClassName(e)},R.__resolveNativeClass=function(e){return t[e]};var G=function(){this.squareDescription={name:"square",original_height:20,file_sizes:[104],original_width:20,files:["square.png"],type:"image"},this.square=null};r["kha._Assets.ImageList"]=G,G.__name__=!0,G.prototype={get:function(e){return c.field(this,e)},square:null,squareDescription:null,__class__:G};var H=function(){};r["kha._Assets.SoundList"]=H,H.__name__=!0,H.prototype={__class__:H};var U=function(){};r["kha._Assets.BlobList"]=U,U.__name__=!0,U.prototype={__class__:U};var Z=function(){this.kenney_miniDescription={name:"kenney_mini",file_sizes:[26156],files:["kenney_mini.ttf"],type:"font"},this.kenney_mini=null};r["kha._Assets.FontList"]=Z,Z.__name__=!0,Z.prototype={get:function(e){return c.field(this,e)},kenney_mini:null,kenney_miniDescription:null,__class__:Z};var O=function(){};r["kha._Assets.VideoList"]=O,O.__name__=!0,O.prototype={__class__:O};var z=function(){};r["kha.Assets"]=z,z.__name__=!0,z.loadEverything=function(e,t,i,r){for(var n=[G,H,U,Z,O],a=[z.images,z.sounds,z.blobs,z.fonts,z.videos],s=0,o=0;o<n.length;){var l=n[o];++o;for(var u=0,h=g.getInstanceFields(l);u<h.length;){var d=h[u];++u,_.endsWith(d,"Description")&&(s+=1)}}if(0!=s)for(var f=s,m=function(e,t,r){var n=e.name;switch(e.type){case"blob":z.loadBlob(n,function(e){t()},r,{fileName:"kha/Assets.hx",lineNumber:122,className:"kha.Assets",methodName:"loadEverything"});break;case"font":z.loadFont(n,function(e){t()},r,{fileName:"kha/Assets.hx",lineNumber:124,className:"kha.Assets",methodName:"loadEverything"});break;case"image":z.loadImage(n,function(e){t()},r,{fileName:"kha/Assets.hx",lineNumber:113,className:"kha.Assets",methodName:"loadEverything"});break;case"sound":z.loadSound(n,function(r){null==i||i(e)?r.uncompress(t):t()},r,{fileName:"kha/Assets.hx",lineNumber:115,className:"kha.Assets",methodName:"loadEverything"});break;case"video":z.loadVideo(n,function(e){t()},r,{fileName:"kha/Assets.hx",lineNumber:126,className:"kha.Assets",methodName:"loadEverything"})}},p=function(){f-=1,z.progress=1-f/s,0==f&&e()},v=function(e){z.reporter(r,{fileName:"kha/Assets.hx",lineNumber:137,className:"kha.Assets",methodName:"loadEverything"})(e),p()},b=0,w=n.length;b<w;)for(var y=b++,x=a[y],k=0,I=g.getInstanceFields(n[y]);k<I.length;){var B=I[k];if(++k,_.endsWith(B,"Description")){var S=c.field(x,B);null==t||t(S)?m(S,p,v):p()}}else e()},z.loadImage=function(e,t,i,r){var n=c.field(z.images,e+"Description");ne.loadImageFromDescription(n,function(i){z.images[e]=i,t(i)},z.reporter(i,r))},z.loadBlob=function(e,t,i,r){var n=c.field(z.blobs,e+"Description");ne.loadBlobFromDescription(n,function(i){z.blobs[e]=i,t(i)},z.reporter(i,r))},z.loadSound=function(e,t,i,r){var n=c.field(z.sounds,e+"Description");ne.loadSoundFromDescription(n,function(i){z.sounds[e]=i,t(i)},z.reporter(i,r))},z.loadFont=function(e,t,i,r){var n=c.field(z.fonts,e+"Description");ne.loadFontFromDescription(n,function(i){z.fonts[e]=i,t(i)},z.reporter(i,r))},z.loadVideo=function(e,t,i,r){var n=c.field(z.videos,e+"Description");ne.loadVideoFromDescription(n,function(i){z.videos[e]=i,t(i)},z.reporter(i,r))},z.reporter=function(e,t){if(null!=e)return e;var i=b.trace,r=t;return function(e){i(e,r)}};var X=function(){};r["kha.Canvas"]=X,X.__name__=!0,X.__isInterface__=!0,X.prototype={get_width:null,get_height:null,get_g2:null,get_g4:null,width:null,height:null,g2:null,g4:null,__class__:X};var K=function(){};r["kha.Resource"]=K,K.__name__=!0,K.__isInterface__=!0;var j=function(){};r["kha.Image"]=j,j.__name__=!0,j.__interfaces__=[K,X],j.create=function(e,t,i,r){return null==i&&(i=0),null==r&&(r=0),null==ge.gl?new Y(e,t,i,!1):new pe(e,t,i,!1,0,1)},j.createRenderTarget=function(e,t,i,r,n,a){return null==a&&(a=0),null==n&&(n=1),null==r&&(r=0),null==i&&(i=0),null==ge.gl?new Y(e,t,i,!0):new pe(e,t,i,!0,r,n)},j.fromImage=function(e,t){if(null==ge.gl){var i=new Y(e.width,e.height,0,!1);return i.image=e,i.createTexture(),i}var r=new pe(e.width,e.height,0,!1,0,1);return r.image=e,r.createTexture(),r},j.fromBytes=function(e,t,i,r,n){if(null==r&&(r=0),null==n&&(n=0),null!=ge.gl){var a=new pe(t,i,r,!1,0,1);return a.image=a.bytesToArray(e),a.createTexture(),a}var s=new Y(t,i,r,!1),o=s.get_g2().canvas,l=new ImageData(new Uint8ClampedArray(e.b.bufferValue),t,i);return o.putImageData(l,0,0),s},j.fromVideo=function(e){if(null==ge.gl){var t=new Y(e.element.videoWidth,e.element.videoHeight,0,!1);return t.video=e.element,t.createTexture(),t}var i=new pe(e.element.videoWidth,e.element.videoHeight,0,!1,0,1);return i.video=e.element,i.createTexture(),i},j.get_nonPow2Supported=function(){return null!=ge.gl},j.renderTargetsInvertedY=function(){return!0},j.prototype={lock:function(e){return null==e&&(e=0),null},unlock:function(){},width:null,get_width:function(){return 0},height:null,get_height:function(){return 0},realWidth:null,get_realWidth:function(){return 0},realHeight:null,get_realHeight:function(){return 0},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null},__class__:j};var Y=function(e,t,i,r){this.g2canvas=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=r,this.image=null,this.video=null,r&&this.createTexture()};r["kha.CanvasImage"]=Y,Y.__name__=!0,Y.init=function(){var e=window.document.createElement("canvas");null!=e&&(Y.context=e.getContext("2d"),e.width=2048,e.height=2048,Y.context.globalCompositeOperation="copy")},Y.__super__=j,Y.prototype=s(j.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,g2canvas:null,get_g2:function(){if(null==this.g2canvas){var e=window.document.createElement("canvas");this.image=e;var t=e.getContext("2d");e.width=this.get_width(),e.height=this.get_height(),this.g2canvas=new Ut(t)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=ge.gl&&(this.texture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.texture),ge.gl.texParameteri(3553,10240,9729),ge.gl.texParameteri(3553,10241,9729),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=ge.gl.createFramebuffer(),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),ge.gl.bindFramebuffer(36160,null)):null!=this.video?ge.gl.texImage2D(3553,0,6408,6408,5121,this.video):ge.gl.texImage2D(3553,0,6408,6408,5121,this.image),ge.gl.bindTexture(3553,null))},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new x(new ArrayBuffer(0==this.format?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=ge.gl){if(this.texture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.texture),ge.gl.texParameteri(3553,10240,9729),ge.gl.texParameteri(3553,10241,9729),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),ge.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Uint8Array(this.bytes.b.bufferValue)),1282==ge.gl.getError()){for(var e=new x(new ArrayBuffer(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var r=t++,n=0,a=this.get_width();n<a;){var s=n++,o=this.bytes,l=r*this.get_width()+s,u=o.b[l],h=r*this.get_width()*4+4*s;e.b[h]=u;var d=r*this.get_width()*4+4*s+1;e.b[d]=u;var c=r*this.get_width()*4+4*s+2;e.b[c]=u;var f=r*this.get_width()*4+4*s+3;e.b[f]=255}ge.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Uint8Array(e.b.bufferValue))}ge.gl.bindTexture(3553,null),this.bytes=null}},__class__:Y});var Q={};r["kha._Color.Color_Impl_"]=Q,Q.__name__=!0,Q.fromBytes=function(e,t,i,r){return null==r&&(r=255),Q._new(r<<24|e<<16|t<<8|i)},Q.fromFloats=function(e,t,i,r){return null==r&&(r=1),Q._new((255*r|0)<<24|(255*e|0)<<16|(255*t|0)<<8|255*i|0)},Q._new=function(e){return e};var J=function(){};r["kha.Display"]=J,J.__name__=!0,J.get_primary=function(){return J.instance},J.prototype={get_frequency:function(){return 60},__class__:J};var q=function(){};r["kha.DisplayMode"]=q,q.__name__=!0;var $=function(e,t,i,r){this.window=e,this.graphics1=t,this.graphics2=i,this.graphics4=r};r["kha.Framebuffer"]=$,$.__name__=!0,$.__interfaces__=[X],$.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(e,t,i){this.graphics1=e,this.graphics2=t,this.graphics4=i},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return fe.windowWidth(this.window)},height:null,get_height:function(){return fe.windowHeight(this.window)},__class__:$};var ee=function(e,t,i,r,n,a){null==a&&(a=1),null==n&&(n=8),null==r&&(r=16),null==i&&(i=32),null==t&&(t=!0),null==e&&(e=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=e,this.verticalSync=t,this.colorBufferBits=i,this.depthBufferBits=r,this.stencilBufferBits=n,this.samplesPerPixel=a};r["kha.FramebufferOptions"]=ee,ee.__name__=!0,ee.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:ee};var te=function(){};r["kha.AlignedQuad"]=te,te.__name__=!0,te.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:te};var ie=function(e,t,i,r,n,a,s,o){this.mySize=e,this.width=n,this.height=a,this.chars=s,this.baseline=t;for(var l=0;l<s.length;){var u=s[l];++l,u.yoff+=this.baseline}this.texture=j.create(n,a,1);for(var h=this.texture.lock(),d=0,c=0,f=a;c<f;){c++;for(var _=0,g=n;_<g;){_++;var m=o.readU8(d);h.b[d]=m,++d}}this.texture.unlock()};r["kha.KravurImage"]=ie,ie.__name__=!0,ie.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(e,t,i,r){if(t>=this.chars.length)return null;var n=1/this.width,a=1/this.height,s=this.chars[t];if(null==s)return null;var o=Math.round(i+s.xoff),l=Math.round(r+s.yoff);return e.x0=o,e.y0=l,e.x1=o+s.x1-s.x0,e.y1=l+s.y1-s.y0,e.s0=s.x0*n,e.t0=s.y0*a,e.s1=s.x1*n,e.t1=s.y1*a,e.xadvance=s.xadvance,e},__class__:ie};var re=function(e){this.images=new I,this.blob=e};r["kha.Kravur"]=re,re.__name__=!0,re.__interfaces__=[K],re.prototype={oldGlyphs:null,blob:null,images:null,_get:function(e){var t=Qe.fontGlyphs;if(t!=this.oldGlyphs){this.oldGlyphs=t;for(var i=(ie.charBlocks=[t[0]])[0]+1,r=1,n=t.length;r<n;){var a=r++;t[a]!=i?(ie.charBlocks.push(t[a-1]),ie.charBlocks.push(t[a]),i=t[a]+1):++i}ie.charBlocks.push(t[t.length-1])}var s=1e4*e+t.length;if(!this.images.h.hasOwnProperty(s)){for(var o=64,l=32,u=new Array(t.length),h=0,d=u.length;h<d;){u[h++]=new it}for(var c=null,f=-1;f<=0;)l<o?l*=2:o*=2,c=Mt.alloc(o*l),f=ut.stbtt_BakeFontBitmap(this.blob,0,e,c,o,l,t,u);var _=new rt;ut.stbtt_InitFont(_,this.blob,0);var g=ut.stbtt_GetFontVMetrics(_),m=ut.stbtt_ScaleForPixelHeight(_,e),p=Math.round(g.ascent*m),v=Math.round(g.descent*m),b=Math.round(g.lineGap*m),w=new ie(0|e,p,v,b,o,l,u,c);return this.images.h[s]=w,w}return this.images.h[s]},__class__:re};var ne=function(){};r["kha.LoaderImpl"]=ne,ne.__name__=!0,ne.loadImageFromDescription=function(e,t,i){var r=Object.prototype.hasOwnProperty.call(e,"readable")&&e.readable;if(_.endsWith(e.files[0],".hdr"))ne.loadBlobFromDescription(e,function(e){var i=Rt.parse(e.toBytes()),n=j.fromBytes(x.ofData(i.data.buffer),i.width,i.height,2,r?1:0);t(n)},i);else{var n=window.document.createElement("img");n.onerror=function(t){i({url:e.files[0],error:t})},n.onload=function(e){var i=j.fromImage(n,r);t(i)},n.crossOrigin="",n.src=e.files[0]}},ne.loadSoundFromDescription=function(e,t,i){if(ge._hasWebAudio){var r=window.document.createElement("audio");if(""!=r.canPlayType("audio/mp4"))for(var n=0,a=e.files.length;n<a;){var s=n++,o=e.files[s];if(_.endsWith(o,".mp4"))return void new Yt(o,t,i)}if(""!=r.canPlayType("audio/mp3"))for(var l=0,u=e.files.length;l<u;){var h=l++,d=e.files[h];if(_.endsWith(d,".mp3"))return void new Yt(d,t,i)}if(""!=r.canPlayType("audio/wav"))for(var c=0,f=e.files.length;c<f;){var g=c++,m=e.files[g];if(_.endsWith(m,".wav"))return void new Yt(m,t,i)}for(var p=0,v=e.files.length;p<v;){var b=p++,w=e.files[b];if(_.endsWith(w,".ogg"))return void new Yt(w,t,i)}}else if(ge.mobile){var y=window.document.createElement("audio");if(""!=y.canPlayType("audio/mp4"))for(var x=0,k=e.files.length;x<k;){var I=x++,B=e.files[I];if(_.endsWith(B,".mp4"))return void new Xt(B,t,i)}if(""!=y.canPlayType("audio/mp3"))for(var S=0,A=e.files.length;S<A;){var T=S++,N=e.files[T];if(_.endsWith(N,".mp3"))return void new Xt(N,t,i)}if(""!=y.canPlayType("audio/wav"))for(var C=0,D=e.files.length;C<D;){var E=C++,P=e.files[E];if(_.endsWith(P,".wav"))return void new Xt(P,t,i)}for(var L=0,V=e.files.length;L<V;){var F=L++,W=e.files[F];if(_.endsWith(W,".ogg"))return void new Xt(W,t,i)}}else new Kt(e.files,t,i)},ne.loadVideoFromDescription=function(e,t,i){jt.fromFile(e.files,t)},ne.loadRemote=function(e,t,i){var r=new XMLHttpRequest;r.open("GET",e.files[0],!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=200&&r.status<400||0==r.status&&""==r.statusText){var n=null,a=r.response;if(null!=a){var s=new Uint8Array(a);n=x.ofData(s)}else{if(null==r.responseBody)return void i({url:e.files[0]});var o=VBArray(r.responseBody).toArray();n=new x(new ArrayBuffer(o.length));for(var l=0,u=o.length;l<u;){var h=l++;n.b[h]=o[h]}}t(new Mt(n))}else i({url:e.files[0]})},r.send(null)},ne.loadBlobFromDescription=function(e,t,i){ne.loadRemote(e,t,i)},ne.loadFontFromDescription=function(e,t,i){ne.loadBlobFromDescription(e,function(e){t(new re(e))},i)};var ae=function(e,t,i,r,n,a){this.x=e,this.y=t,this.width=i,this.height=r,this.scaleFactor=n,this.rotation=a};r["kha.TargetRectangle"]=ae,ae.__name__=!0,ae.prototype={x:null,y:null,width:null,height:null,scaleFactor:null,rotation:null,__class__:ae};var se=function(){};r["kha.Scaler"]=se,se.__name__=!0,se.targetRect=function(e,t,i,r,n){var a,s,o,l,u;switch(n){case 0:e/t>i/r?(o=e*(u=i/e),a=0,s=.5*(r-(l=t*u))):(l=t*(u=r/t),a=.5*(i-(o=e*u)),s=0);break;case 90:e/t>r/i?(o=e*(u=r/e),a=.5*(i-(l=t*u))+l,s=0):(a=l=t*(u=i/t),s=.5*(r-(o=e*u)));break;case 180:e/t>i/r?(a=o=e*(u=i/e),s=.5*(r-(l=t*u))+l):(a=.5*(i-(o=e*(u=r/t)))+o,s=l=t*u);break;case 270:e/t>r/i?(a=.5*(i-(l=t*(u=r/e))),s=o=e*u):(l=t*(u=i/t),a=0,s=.5*(r-(o=e*u))+o)}return new ae(a,s,o,l,u,n)},se.scale=function(e,t,i){var r=t.get_g2(),n=se.getScaledTransformation(e.get_width(),e.get_height(),t.get_width(),t.get_height(),i);r.transformationIndex++,r.transformationIndex==r.transformations.length&&r.transformations.push(new ii(1,0,0,0,1,0,0,0,1));var a=r.transformations[r.transformationIndex];a._00=n._00,a._10=n._10,a._20=n._20,a._01=n._01,a._11=n._11,a._21=n._21,a._02=n._02,a._12=n._12,a._22=n._22,r.setTransformation(r.transformations[r.transformationIndex]),r.set_color(-1),r.set_opacity(1),r.drawImage(e,0,0),r.popTransformation()},se.getScaledTransformation=function(e,t,i,r,n){var a=se.targetRect(e,t,i,r,n),s=a.scaleFactor,o=new ii(s,0,a.x,0,s,a.y,0,0,1);switch(n){case 0:break;case 90:var l=Math.PI/2,u=Math.cos(l),h=-Math.sin(l),d=Math.sin(l),c=Math.cos(l);o=new ii(o._00*u+o._10*d+0*o._20,o._00*h+o._10*c+0*o._20,0*o._00+0*o._10+1*o._20,o._01*u+o._11*d+0*o._21,o._01*h+o._11*c+0*o._21,0*o._01+0*o._11+1*o._21,o._02*u+o._12*d+0*o._22,o._02*h+o._12*c+0*o._22,0*o._02+0*o._12+1*o._22);break;case 180:var f=Math.PI,_=Math.cos(f),g=-Math.sin(f),m=Math.sin(f),p=Math.cos(f);o=new ii(o._00*_+o._10*m+0*o._20,o._00*g+o._10*p+0*o._20,0*o._00+0*o._10+1*o._20,o._01*_+o._11*m+0*o._21,o._01*g+o._11*p+0*o._21,0*o._01+0*o._11+1*o._21,o._02*_+o._12*m+0*o._22,o._02*g+o._12*p+0*o._22,0*o._02+0*o._12+1*o._22);break;case 270:var v=3*Math.PI/2,b=Math.cos(v),w=-Math.sin(v),y=Math.sin(v),x=Math.cos(v);o=new ii(o._00*b+o._10*y+0*o._20,o._00*w+o._10*x+0*o._20,0*o._00+0*o._10+1*o._20,o._01*b+o._11*y+0*o._21,o._01*w+o._11*x+0*o._21,0*o._01+0*o._11+1*o._21,o._02*b+o._12*y+0*o._22,o._02*w+o._12*x+0*o._22,0*o._02+0*o._12+1*o._22)}return o};var oe=function(){};r["kha.TimeTask"]=oe,oe.__name__=!0,oe.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:oe};var le=function(e,t,i){this.task=e,this.priority=t,this.id=i,this.active=!0,this.paused=!1};r["kha.FrameTask"]=le,le.__name__=!0,le.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:le};var ue=function(){};r["kha.Scheduler"]=ue,ue.__name__=!0,ue.init=function(){ue.deltas=[];for(var e=0,t=ue.DIF_COUNT;e<t;){var i=e++;ue.deltas[i]=0}ue.stopped=!0,ue.frame_tasks_sorted=!0,ue.current=ue.lastTime=ue.realTime(),ue.currentFrameTaskId=0,ue.currentTimeTaskId=0,ue.currentGroupId=0,ue.timeTasks=[],ue.pausedTimeTasks=[],ue.outdatedTimeTasks=[],ue.timeTasksScratchpad=[],ue.frameTasks=[],ue.toDeleteFrame=[]},ue.start=function(e){null==e&&(e=!1),ue.vsync=ve.get(0).get_vSynced();var t=J.get_primary().get_frequency();t>=57&&t<=63&&(t=60),ue.onedifhz=1/t,ue.stopped=!1,ue.resetTime(),ue.lastTime=ue.realTime()-ue.startTime;for(var i=0,r=ue.DIF_COUNT;i<r;){var n=i++;ue.deltas[n]=0}if(e){for(var a=0,s=ue.timeTasks;a<s.length;){var o=s[a];++a,o.paused=!1}for(var l=0,u=ue.frameTasks;l<u.length;){var h=u[l];++l,h.paused=!1}}},ue.executeFrame=function(){var e=ue.realTime()-ue.startTime-ue.lastTime,t=ue.current;if(e>=0){if(null==ai.the())if(e>ue.maxframetime)ue.startTime+=e-ue.maxframetime,t+=e=ue.maxframetime;else if(ue.vsync){for(var i=ue.onedifhz;i<e-ue.onedifhz;)i+=ue.onedifhz;e=i;for(var r=0,n=ue.DIF_COUNT-2;r<n;){var a=r++;e+=ue.deltas[a],ue.deltas[a]=ue.deltas[a+1]}e+=ue.deltas[ue.DIF_COUNT-2],e/=ue.DIF_COUNT,ue.deltas[ue.DIF_COUNT-2]=i,t+=e}else{for(var s=0,o=ue.DIF_COUNT-1;s<o;){var l=s++;ue.deltas[l]=ue.deltas[l+1]}ue.deltas[ue.DIF_COUNT-1]=e;for(var h=0,d=0,c=ue.DIF_COUNT;d<c;){var f=d++;h+=ue.deltas[f]}t+=h/=ue.DIF_COUNT}else t+=e;ue.lastTime=t,ue.stopped||(ue.current=t);for(var _=0,g=ue.pausedTimeTasks;_<g.length;){var m=g[_];++_,m.next+=e}if(ue.stopped)for(var p=0,v=ue.timeTasks;p<v.length;){var b=v[p];++p,b.next+=e}ue.executeTimeTasks(t);for(var w=0,y=ue.outdatedTimeTasks;w<y.length;){var x=y[w];++w,x.next<t-10&&ue.timeTasksScratchpad.push(x)}for(var k=0,I=ue.timeTasksScratchpad;k<I.length;){var B=I[k];++k,u.remove(ue.outdatedTimeTasks,B)}for(;ue.timeTasksScratchpad.length>0;)u.remove(ue.timeTasksScratchpad,ue.timeTasksScratchpad[0])}ue.sortFrameTasks();for(var S=0,A=ue.frameTasks;S<A.length;){var T=A[S];++S,ue.stopped||T.paused||!T.active||T.task()||(T.active=!1)}for(var N=0,C=ue.frameTasks;N<C.length;){var D=C[N];++N,D.active||ue.toDeleteFrame.push(D)}for(;ue.toDeleteFrame.length>0;)u.remove(ue.frameTasks,ue.toDeleteFrame.pop())},ue.executeTimeTasks=function(e){for(;ue.timeTasks.length>0&&(ue.activeTimeTask=ue.timeTasks[0],ue.activeTimeTask.next<=e);)ue.activeTimeTask.next+=ue.activeTimeTask.period,u.remove(ue.timeTasks,ue.activeTimeTask),ue.activeTimeTask.active&&ue.activeTimeTask.task()?ue.activeTimeTask.period>0&&(0==ue.activeTimeTask.duration||ue.activeTimeTask.duration>=ue.activeTimeTask.start+ue.activeTimeTask.next)?ue.insertSorted(ue.timeTasks,ue.activeTimeTask):ue.archiveTimeTask(ue.activeTimeTask,e):(ue.activeTimeTask.active=!1,ue.archiveTimeTask(ue.activeTimeTask,e));ue.activeTimeTask=null},ue.archiveTimeTask=function(e,t){},ue.time=function(){return ue.current},ue.realTime=function(){return fe.get_time()},ue.resetTime=function(){var e=fe.get_time(),t=e-ue.startTime;ue.startTime=e;for(var i=0,r=ue.timeTasks;i<r.length;){var n=r[i];++i,n.start-=t,n.next-=t}for(var a=0,s=ue.DIF_COUNT;a<s;){var o=a++;ue.deltas[o]=0}ue.current=0,ue.lastTime=0},ue.addBreakableTimeTaskToGroup=function(e,t,i,r,n){null==n&&(n=0),null==r&&(r=0);var a=new oe;return a.active=!0,a.task=t,a.id=++ue.currentTimeTaskId,a.groupId=e,a.start=ue.current+i,a.period=0,0!=r&&(a.period=r),a.duration=0,0!=n&&(a.duration=a.start+n),a.next=a.start,ue.insertSorted(ue.timeTasks,a),a.id},ue.addTimeTaskToGroup=function(e,t,i,r,n){return null==n&&(n=0),null==r&&(r=0),ue.addBreakableTimeTaskToGroup(e,function(){return t(),!0},i,r,n)},ue.addTimeTask=function(e,t,i,r){return null==r&&(r=0),null==i&&(i=0),ue.addTimeTaskToGroup(0,e,t,i,r)},ue.insertSorted=function(e,t){for(var i=0,r=e.length;i<r;){var n=i++;if(e[n].next>t.next)return void e.splice(n,0,t)}e.push(t)},ue.sortFrameTasks=function(){ue.frame_tasks_sorted||(ue.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),ue.frame_tasks_sorted=!0)};var he=function(){};r["kha.Shaders"]=he,he.__name__=!0,he.init=function(){var e=[],t=c.field(he,"painter_colored_fragData0"),i=y.run(t);e.push(Mt.fromBytes(i));var r=c.field(he,"painter_colored_fragData1"),n=y.run(r);e.push(Mt.fromBytes(n));var a=c.field(he,"painter_colored_fragData2"),s=y.run(a);e.push(Mt.fromBytes(s)),he.painter_colored_frag=new ct(e,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);var o=[],l=c.field(he,"painter_colored_vertData0"),u=y.run(l);o.push(Mt.fromBytes(u));var h=c.field(he,"painter_colored_vertData1"),d=y.run(h);o.push(Mt.fromBytes(d));var f=c.field(he,"painter_colored_vertData2"),_=y.run(f);o.push(Mt.fromBytes(_)),he.painter_colored_vert=new Nt(o,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);var g=[],m=c.field(he,"painter_image_fragData0"),p=y.run(m);g.push(Mt.fromBytes(p));var v=c.field(he,"painter_image_fragData1"),b=y.run(v);g.push(Mt.fromBytes(b));var w=c.field(he,"painter_image_fragData2"),x=y.run(w);g.push(Mt.fromBytes(x)),he.painter_image_frag=new ct(g,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);var k=[],I=c.field(he,"painter_image_vertData0"),B=y.run(I);k.push(Mt.fromBytes(B));var S=c.field(he,"painter_image_vertData1"),A=y.run(S);k.push(Mt.fromBytes(A));var T=c.field(he,"painter_image_vertData2"),N=y.run(T);k.push(Mt.fromBytes(N)),he.painter_image_vert=new Nt(k,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);var C=[],D=c.field(he,"painter_text_fragData0"),E=y.run(D);C.push(Mt.fromBytes(E));var P=c.field(he,"painter_text_fragData1"),L=y.run(P);C.push(Mt.fromBytes(L));var V=c.field(he,"painter_text_fragData2"),F=y.run(V);C.push(Mt.fromBytes(F)),he.painter_text_frag=new ct(C,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);var W=[],M=c.field(he,"painter_text_vertData0"),R=y.run(M);W.push(Mt.fromBytes(R));var G=c.field(he,"painter_text_vertData1"),H=y.run(G);W.push(Mt.fromBytes(H));var U=c.field(he,"painter_text_vertData2"),Z=y.run(U);W.push(Mt.fromBytes(Z)),he.painter_text_vert=new Nt(W,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);var O=[],z=c.field(he,"painter_video_fragData0"),X=y.run(z);O.push(Mt.fromBytes(X));var K=c.field(he,"painter_video_fragData1"),j=y.run(K);O.push(Mt.fromBytes(j));var Y=c.field(he,"painter_video_fragData2"),Q=y.run(Y);O.push(Mt.fromBytes(Q)),he.painter_video_frag=new ct(O,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);var J=[],q=c.field(he,"painter_video_vertData0"),$=y.run(q);J.push(Mt.fromBytes($));var ee=c.field(he,"painter_video_vertData1"),te=y.run(ee);J.push(Mt.fromBytes(te));var ie=c.field(he,"painter_video_vertData2"),re=y.run(ie);J.push(Mt.fromBytes(re)),he.painter_video_vert=new Nt(J,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"])};var de=function(){this.sampleRate=0,this.channels=0,this.length=0};r["kha.Sound"]=de,de.__name__=!0,de.__interfaces__=[K],de.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(e){if(null==this.uncompressedData){var t=new P,i=Ne.readAll(this.compressedData,t,!0),r=t.getBytes(),n=r.length/4|0;if(1==i.channel){this.length=n/xe.samplesPerSecond;var a=new Float32Array(2*n);this.uncompressedData=a;for(var s=0,o=n;s<o;){var l=s++;this.uncompressedData[2*l]=r.getFloat(4*l),this.uncompressedData[2*l+1]=r.getFloat(4*l)}}else{this.length=n/2/xe.samplesPerSecond;var u=new Float32Array(n);this.uncompressedData=u;for(var h=0,d=n;h<d;){var c=h++;this.uncompressedData[c]=r.getFloat(4*c)}}this.channels=i.channel,this.sampleRate=i.sampleRate,this.compressedData=null,e()}else e()},__class__:de};var ce=function(e,t,i,r,n){null==i&&(i=-1),null==t&&(t=-1),null==e&&(e="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=e,this.window=null==r?new be(null,null,null,null,null,null,null,null,null):r,t>0?(this.window.width=t,this.width=t):this.width=this.window.width,i>0?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=e),this.framebuffer=null==n?new ee(null,null,null,null,null,null):n};r["kha.SystemOptions"]=ce,ce.__name__=!0,ce.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:ce};var fe=function(){};r["kha.System"]=fe,fe.__name__=!0,fe.start=function(e,t){fe.theTitle=e.title,ge.init(e,t)},fe.notifyOnFrames=function(e){fe.renderListeners.push(e)},fe.render=function(e){for(var t=0,i=fe.renderListeners;t<i.length;){var r=i[t];++t,r(e)}},fe.foreground=function(){for(var e=0,t=fe.foregroundListeners;e<t.length;){var i=t[e];++e,i()}},fe.background=function(){for(var e=0,t=fe.backgroundListeners;e<t.length;){var i=t[e];++e,i()}},fe.shutdown=function(){for(var e=0,t=fe.shutdownListeners;e<t.length;){var i=t[e];++e,i()}},fe.get_time=function(){return ge.getTime()},fe.windowWidth=function(e){return null==e&&(e=0),ve.get(e).get_width()},fe.windowHeight=function(e){return null==e&&(e=0),ve.get_all()[e].get_height()},fe.get_screenRotation=function(){return 0};var _e=function(){this.axes=[],this.buttons=[]};r["kha.GamepadStates"]=_e,_e.__name__=!0,_e.prototype={axes:null,buttons:null,__class__:_e};var ge=function(){};r["kha.SystemImpl"]=ge,ge.__name__=!0,ge.init=function(e,t){ge.options=e,ge.mobile=ge.isMobile(),ge.ios=ge.isIOS(),ge.chrome=ge.isChrome(),ge.firefox=ge.isFirefox(),ge.ie=ge.isIE(),ge.mobile||ge.chrome?ge.mobileAudioPlaying=!1:ge.mobileAudioPlaying=!0,ge.initSecondStep(t)},ge.initSecondStep=function(e){ge.init2(ge.options.window.width,ge.options.window.height),e(ge.window)},ge.isMobile=function(){var e=window.navigator.userAgent;return e.indexOf("Android")>=0||e.indexOf("webOS")>=0||e.indexOf("BlackBerry")>=0||e.indexOf("Windows Phone")>=0||!!ge.isIOS()},ge.isIOS=function(){var e=window.navigator.userAgent;return e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0||e.indexOf("iPod")>=0},ge.isChrome=function(){return window.navigator.userAgent.indexOf("Chrome")>=0},ge.isFirefox=function(){return window.navigator.userAgent.indexOf("Firefox")>=0},ge.isIE=function(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},ge.setCanvas=function(e){ge.khanvas=e},ge.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},ge.init2=function(e,t,i){if(ge.keyboard=new Lt,ge.mouse=new Ft,ge.surface=new Wt,ge.gamepads=[],ge.gamepadStates=[],ge.gamepads[0]=new Dt(0),ge.gamepadStates[0]=new _e,ge.gamepads[1]=new Dt(1),ge.gamepadStates[1]=new _e,ge.gamepads[2]=new Dt(2),ge.gamepadStates[2]=new _e,ge.gamepads[3]=new Dt(3),ge.gamepadStates[3]=new _e,window.addEventListener("gamepadconnected",function(e){Dt.sendConnectEvent(e.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(e){Dt.sendDisconnectEvent(e.gamepad.index)}),ge.ie){ge.pressedKeys=[];for(var r=0;r<256;){r++;ge.pressedKeys.push(!1)}for(var n=0;n<256;){n++;ge.pressedKeys.push(null)}}var a=window.document;a.addEventListener("copy",function(e){if(null!=fe.copyListener){var t=fe.copyListener();null!=t&&e.clipboardData.setData("text/plain",t),e.preventDefault()}}),a.addEventListener("cut",function(e){if(null!=fe.cutListener){var t=fe.cutListener();null!=t&&e.clipboardData.setData("text/plain",t),e.preventDefault()}}),a.addEventListener("paste",function(e){if(null!=fe.pasteListener){var t=e.clipboardData.getData("text/plain");fe.pasteListener(t),e.preventDefault()}}),Y.init(),ue.init(),ge.loadFinished(e,t)},ge.getMouse=function(e){return 0!=e?null:ge.mouse},ge.getKeyboard=function(e){return 0!=e?null:ge.keyboard},ge.checkGamepad=function(e){for(var t=0,i=e.axes.length;t<i;){var r=t++;if(null!=e.axes[r]){var n=e.axes[r];ge.gamepadStates[e.index].axes[r]!=n&&(ge.gamepadStates[e.index].axes[r]=n,ge.gamepads[e.index].sendAxisEvent(r,n))}}for(var a=0,s=e.buttons.length;a<s;){var o=a++;null!=e.buttons[o]&&ge.gamepadStates[e.index].buttons[o]!=e.buttons[o].value&&(ge.gamepadStates[e.index].buttons[o]=e.buttons[o].value,ge.gamepads[e.index].sendButtonEvent(o,e.buttons[o].value))}e.axes.length<=4&&e.buttons.length>7&&(ge.gamepadStates[e.index].axes[4]=e.buttons[6].value,ge.gamepads[e.index].sendAxisEvent(4,e.buttons[6].value),ge.gamepadStates[e.index].axes[5]=e.buttons[7].value,ge.gamepads[e.index].sendAxisEvent(5,e.buttons[7].value))},ge.getCanvasElement=function(){return null!=ge.khanvas?ge.khanvas:window.document.getElementById("khanvas")},ge.loadFinished=function(e,t){var i=ge.getCanvasElement();i.style.cursor="default";var r=!1;try{ge.gl=i.getContext("webgl2",{alpha:!1,antialias:ge.options.framebuffer.samplesPerPixel>1,stencil:!0}),ge.gl.pixelStorei(37441,1),ge.halfFloat={HALF_FLOAT_OES:5131},ge.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},ge.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},ge.elementIndexUint=!0,ge.gl.getExtension("EXT_color_buffer_float"),ge.gl.getExtension("OES_texture_float_linear"),ge.gl.getExtension("OES_texture_half_float_linear"),ge.anisotropicFilter=ge.gl.getExtension("EXT_texture_filter_anisotropic"),null==ge.anisotropicFilter&&(ge.anisotropicFilter=ge.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),r=!0,ge.gl2=!0,he.init()}catch(e){e instanceof M&&e.val;b.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:345,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!ge.gl2)try{ge.gl=i.getContext("experimental-webgl",{alpha:!1,antialias:ge.options.framebuffer.samplesPerPixel>1,stencil:!0}),ge.gl.pixelStorei(37441,1),ge.gl.getExtension("OES_texture_float"),ge.gl.getExtension("OES_texture_float_linear"),ge.halfFloat=ge.gl.getExtension("OES_texture_half_float"),ge.gl.getExtension("OES_texture_half_float_linear"),ge.depthTexture=ge.gl.getExtension("WEBGL_depth_texture"),ge.gl.getExtension("EXT_shader_texture_lod"),ge.gl.getExtension("OES_standard_derivatives"),ge.anisotropicFilter=ge.gl.getExtension("EXT_texture_filter_anisotropic"),null==ge.anisotropicFilter&&(ge.anisotropicFilter=ge.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),ge.drawBuffers=ge.gl.getExtension("WEBGL_draw_buffers"),ge.elementIndexUint=ge.gl.getExtension("OES_element_index_uint"),r=!0,he.init()}catch(e){e instanceof M&&e.val;b.trace("Could not initialize WebGL, falling back to <canvas>.",{fileName:"kha/SystemImpl.hx",lineNumber:367,className:"kha.SystemImpl",methodName:"loadFinished"})}if(ge.setCanvas(i),ge.window=new ve(e,t,i),r){var n=new Jt;ge.frame=new $(0,null,null,n),ge.frame.init(new Je(ge.frame),new qt(ge.frame),n)}else{Zt.Kravur=re,re=Zt;var a=new Ut(i.getContext("2d"));ge.frame=new $(0,null,a,null),ge.frame.init(new Je(ge.frame),a,null)}!ge.mobile&&xe._init()?(ge._hasWebAudio=!0,ke._init()):ge.mobile?(ge._hasWebAudio=!1,Ot._init(),ke=Ot):(ge._hasWebAudio=!1,ke=Ht),ei.instance=new ti,ue.start();var s=window,o=s.requestAnimationFrame;null==o&&(o=s.mozRequestAnimationFrame),null==o&&(o=s.webkitRequestAnimationFrame),null==o&&(o=s.msRequestAnimationFrame);var l=null;l=function(e){var t=window;null==o?t.setTimeout(l,16.666666666666668):o(l);var r=ge.getGamepads();if(null!=r)for(var n=0,a=r.length;n<a;){var s=r[n++];null!=s&&ge.checkGamepad(s)}if(ue.executeFrame(),null!=i.getContext){var u=i.clientWidth,h=i.clientHeight;i.width==u&&i.height==h||(i.width=u,i.height=h),fe.render([ge.frame]),null!=ge.gl&&(ge.gl.clearColor(1,1,1,1),ge.gl.colorMask(!1,!1,!1,!0),ge.gl.clear(16384),ge.gl.colorMask(!0,!0,!0,!0))}},null==o?s.setTimeout(l,16.666666666666668):o(l),i.focus(),i.oncontextmenu=function(e){e.stopPropagation(),e.preventDefault()},i.onmousedown=ge.mouseDown,i.onmousemove=ge.mouseMove,null!=ge.keyboard&&(i.onkeydown=ge.keyDown,i.onkeyup=ge.keyUp,i.onkeypress=ge.keyPress),i.onblur=ge.onBlur,i.onfocus=ge.onFocus,i.onmousewheel=i.onwheel=ge.mouseWheel,i.onmouseleave=ge.mouseLeave,i.addEventListener("wheel mousewheel",ge.mouseWheel,!1),i.addEventListener("touchstart",ge.touchDown,!1),i.addEventListener("touchend",ge.touchUp,!1),i.addEventListener("touchmove",ge.touchMove,!1),i.addEventListener("touchcancel",ge.touchCancel,!1),window.addEventListener("unload",function(){fe.shutdown()})},ge.lockMouse=function(){ui(i=ge.khanvas,i.requestPointerLock)?ge.khanvas.requestPointerLock():ge.khanvas.mozRequestPointerLock?ge.khanvas.mozRequestPointerLock():ge.khanvas.webkitRequestPointerLock&&ge.khanvas.webkitRequestPointerLock()},ge.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},ge.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},ge.isMouseLocked=function(){return document.pointerLockElement===ge.khanvas||document.mozPointerLockElement===ge.khanvas||document.webkitPointerLockElement===ge.khanvas},ge.notifyOfMouseLockChange=function(e,t){window.document.addEventListener("pointerlockchange",e,!1),window.document.addEventListener("mozpointerlockchange",e,!1),window.document.addEventListener("webkitpointerlockchange",e,!1),window.document.addEventListener("pointerlockerror",t,!1),window.document.addEventListener("mozpointerlockerror",t,!1),window.document.addEventListener("webkitpointerlockerror",t,!1)},ge.removeFromMouseLockChange=function(e,t){window.document.removeEventListener("pointerlockchange",e,!1),window.document.removeEventListener("mozpointerlockchange",e,!1),window.document.removeEventListener("webkitpointerlockchange",e,!1),window.document.removeEventListener("pointerlockerror",t,!1),window.document.removeEventListener("mozpointerlockerror",t,!1),window.document.removeEventListener("webkitpointerlockerror",t,!1)},ge.setMouseXY=function(e){var t=ge.khanvas.getBoundingClientRect(),i=ge.khanvas.clientLeft,r=ge.khanvas.clientTop;ge.mouseX=(e.clientX-t.left-i)*ge.khanvas.width/(t.width-2*i)|0,ge.mouseY=(e.clientY-t.top-r)*ge.khanvas.height/(t.height-2*r)|0},ge.unlockiOSSound=function(){if(ge.ios&&!ge.iosSoundEnabled){var e=Ot._context.createBuffer(1,1,22050),t=Ot._context.createBufferSource();t.buffer=e,t.connect(Ot._context.destination),t.start(),t.stop(),ge.iosSoundEnabled=!0}},ge.unlockSound=function(){if(!ge.soundEnabled){var e=xe._context;null==e&&(e=ke._context),null!=e&&e.resume().then(function(e){ge.soundEnabled=!0}).catch(function(e){b.trace(e,{fileName:"kha/SystemImpl.hx",lineNumber:607,className:"kha.SystemImpl",methodName:"unlockSound"})}),xe.wakeChannels()}ge.unlockiOSSound()},ge.mouseLeave=function(){ge.mouse.sendLeaveEvent(0)},ge.mouseWheel=function(e){return ge.unlockSound(),ge.insideInputEvent=!0,e.preventDefault(),0==e.deltaMode?(e.deltaY<0?ge.mouse.sendWheelEvent(0,-1):e.deltaY>0&&ge.mouse.sendWheelEvent(0,1),ge.insideInputEvent=!1,!1):1==e.deltaMode?(ge.minimumScroll=0|Math.min(ge.minimumScroll,Math.abs(e.deltaY)),ge.mouse.sendWheelEvent(0,e.deltaY/ge.minimumScroll|0),ge.insideInputEvent=!1,!1):(ge.insideInputEvent=!1,!1)},ge.mouseDown=function(e){ge.insideInputEvent=!0,ge.unlockSound(),ge.setMouseXY(e),1==e.which?(ge.mouse.sendDownEvent(0,0,ge.mouseX,ge.mouseY),null!=ge.khanvas.setCapture?ge.khanvas.setCapture():ge.khanvas.ownerDocument.addEventListener("mousemove",ge.documentMouseMove,!0),ge.khanvas.ownerDocument.addEventListener("mouseup",ge.mouseLeftUp)):2==e.which?(ge.mouse.sendDownEvent(0,2,ge.mouseX,ge.mouseY),ge.khanvas.ownerDocument.addEventListener("mouseup",ge.mouseMiddleUp)):3==e.which&&(ge.mouse.sendDownEvent(0,1,ge.mouseX,ge.mouseY),ge.khanvas.ownerDocument.addEventListener("mouseup",ge.mouseRightUp)),ge.insideInputEvent=!1},ge.mouseLeftUp=function(e){ge.unlockSound(),1==e.which&&(ge.insideInputEvent=!0,ge.khanvas.ownerDocument.removeEventListener("mouseup",ge.mouseLeftUp),null!=ge.khanvas.releaseCapture?ge.khanvas.ownerDocument.releaseCapture():ge.khanvas.ownerDocument.removeEventListener("mousemove",ge.documentMouseMove,!0),ge.mouse.sendUpEvent(0,0,ge.mouseX,ge.mouseY),ge.insideInputEvent=!1)},ge.mouseMiddleUp=function(e){ge.unlockSound(),2==e.which&&(ge.insideInputEvent=!0,ge.khanvas.ownerDocument.removeEventListener("mouseup",ge.mouseMiddleUp),ge.mouse.sendUpEvent(0,2,ge.mouseX,ge.mouseY),ge.insideInputEvent=!1)},ge.mouseRightUp=function(e){ge.unlockSound(),3==e.which&&(ge.insideInputEvent=!0,ge.khanvas.ownerDocument.removeEventListener("mouseup",ge.mouseRightUp),ge.mouse.sendUpEvent(0,1,ge.mouseX,ge.mouseY),ge.insideInputEvent=!1)},ge.documentMouseMove=function(e){e.stopPropagation(),ge.mouseMove(e)},ge.mouseMove=function(e){ge.insideInputEvent=!0;var t=ge.mouseX,i=ge.mouseY;ge.setMouseXY(e);var r=e.movementX,n=e.movementY;null==e.movementX&&(r=null!=e.mozMovementX?e.mozMovementX:null!=e.webkitMovementX?e.webkitMovementX:ge.mouseX-t,n=null!=e.mozMovementY?e.mozMovementY:null!=e.webkitMovementY?e.webkitMovementY:ge.mouseY-i),ge.firefox&&(r=r*window.devicePixelRatio|0,n=n*window.devicePixelRatio|0),ge.mouse.sendMoveEvent(0,ge.mouseX,ge.mouseY,r,n),ge.insideInputEvent=!1},ge.setTouchXY=function(e){var t=ge.khanvas.getBoundingClientRect(),i=ge.khanvas.clientLeft,r=ge.khanvas.clientTop;ge.touchX=(e.clientX-t.left-i)*ge.khanvas.width/(t.width-2*i)|0,ge.touchY=(e.clientY-t.top-r)*ge.khanvas.height/(t.height-2*r)|0},ge.touchDown=function(e){ge.insideInputEvent=!0,ge.unlockSound(),e.stopPropagation(),e.preventDefault();for(var t=0,i=0,r=e.changedTouches;i<r.length;){var n=r[i];++i;var a=n.identifier;ge.ios&&(-1==(a=ge.iosTouchs.indexOf(-1))&&(a=ge.iosTouchs.length),ge.iosTouchs[a]=n.identifier),ge.setTouchXY(n),ge.mouse.sendDownEvent(0,0,ge.touchX,ge.touchY),ge.surface.sendTouchStartEvent(a,ge.touchX,ge.touchY),0==t&&(ge.lastFirstTouchX=ge.touchX,ge.lastFirstTouchY=ge.touchY),++t}ge.insideInputEvent=!1},ge.touchUp=function(e){ge.insideInputEvent=!0,ge.unlockSound();for(var t=0,i=e.changedTouches;t<i.length;){var r=i[t];++t;var n=r.identifier;ge.ios&&(n=ge.iosTouchs.indexOf(n),ge.iosTouchs[n]=-1),ge.setTouchXY(r),ge.mouse.sendUpEvent(0,0,ge.touchX,ge.touchY),ge.surface.sendTouchEndEvent(n,ge.touchX,ge.touchY)}ge.insideInputEvent=!1},ge.touchMove=function(e){ge.insideInputEvent=!0,ge.unlockSound();for(var t=0,i=0,r=e.changedTouches;i<r.length;){var n=r[i];if(++i,ge.setTouchXY(n),0==t){var a=ge.touchX-ge.lastFirstTouchX,s=ge.touchY-ge.lastFirstTouchY;ge.lastFirstTouchX=ge.touchX,ge.lastFirstTouchY=ge.touchY,ge.mouse.sendMoveEvent(0,ge.touchX,ge.touchY,a,s)}var o=n.identifier;ge.ios&&(o=ge.iosTouchs.indexOf(o)),ge.surface.sendMoveEvent(o,ge.touchX,ge.touchY),++t}ge.insideInputEvent=!1},ge.touchCancel=function(e){ge.insideInputEvent=!0,ge.unlockSound();for(var t=0,i=e.changedTouches;t<i.length;){var r=i[t];++t;var n=r.identifier;ge.ios&&(n=ge.iosTouchs.indexOf(n)),ge.setTouchXY(r),ge.mouse.sendUpEvent(0,0,ge.touchX,ge.touchY),ge.surface.sendTouchEndEvent(n,ge.touchX,ge.touchY)}ge.iosTouchs=[],ge.insideInputEvent=!1},ge.onBlur=function(){fe.background()},ge.onFocus=function(){fe.foreground()},ge.keyDown=function(e){ge.insideInputEvent=!0,ge.unlockSound();var t=Lt.keyBehavior;switch(t._hx_index){case 0:ge.defaultKeyBlock(e);break;case 1:e.preventDefault();break;case 2:break;case 3:(0,t.func)(e.keyCode)&&e.preventDefault()}if(e.stopPropagation(),ge.ie){if(ge.pressedKeys[e.keyCode])return void e.preventDefault();ge.pressedKeys[e.keyCode]=!0}else if(e.repeat)return void e.preventDefault();var i=ge.fixedKeyCode(e);ge.keyboard.sendDownEvent(i),ge.insideInputEvent=!1},ge.fixedKeyCode=function(e){switch(e.keyCode){case 91:case 93:return 224;case 186:return 59;case 187:return 61;case 189:return 173;default:return e.keyCode}},ge.defaultKeyBlock=function(e){if(e.ctrlKey||e.metaKey){if(67==e.keyCode||88==e.keyCode||86==e.keyCode)return;e.preventDefault()}else e.keyCode>=112&&e.keyCode<=123||null!=e.key&&1!=e.key.length&&e.preventDefault()},ge.keyUp=function(e){ge.insideInputEvent=!0,ge.unlockSound(),e.preventDefault(),e.stopPropagation(),ge.ie&&(ge.pressedKeys[e.keyCode]=!1);var t=ge.fixedKeyCode(e);ge.keyboard.sendUpEvent(t),ge.insideInputEvent=!1},ge.keyPress=function(e){if(ge.insideInputEvent=!0,ge.unlockSound(),0!=e.which){e.preventDefault(),e.stopPropagation();var t=e.which;ge.keyboard.sendPressEvent(String.fromCodePoint(t)),ge.insideInputEvent=!1}},ge.getGamepadId=function(e){var t=ge.getGamepads();return null!=t&&t[e]?t[e].id:"unkown"},ge.getGamepads=function(){return ge.chrome&&ei.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null};var me=function(){};r["kha.Video"]=me,me.__name__=!0,me.__interfaces__=[K],me.prototype={__class__:me};var pe=function(e,t,i,r,n,a){this.MSAAFrameBuffer=null,this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=t,this.format=i,this.renderTarget=r,this.samples=a,this.image=null,this.video=null,this.depthStencilFormat=n,pe.init(),r&&this.createTexture()};r["kha.WebGLImage"]=pe,pe.__name__=!0,pe.init=function(){null==pe.context&&(pe.canvas=window.document.createElement("canvas"),null!=pe.canvas&&(pe.context=pe.canvas.getContext("2d"),pe.canvas.width=4096,pe.canvas.height=4096,pe.context.globalCompositeOperation="copy"))},pe.formatByteSize=function(e){switch(e){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},pe.__super__=j,pe.prototype=s(j.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,MSAAFrameBuffer:null,MSAAColorBuffer:null,MSAADepthBuffer:null,graphics2:null,graphics4:null,depthStencilFormat:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new qt(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new Jt(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=ge.gl){if(this.texture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.texture),ge.gl.texParameteri(3553,10240,9729),ge.gl.texParameteri(3553,10241,9729),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=ge.gl.createFramebuffer(),ge.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:ge.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:ge.gl.texImage2D(3553,0,ge.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:ge.gl.texImage2D(3553,0,ge.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:ge.gl.texImage2D(3553,0,ge.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,ge.halfFloat.HALF_FLOAT_OES,null);break;case 5:ge.gl.texImage2D(3553,0,ge.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,ge.gl2?6403:6406,5126,null);break;case 6:ge.gl.texImage2D(3553,0,ge.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,ge.gl2?6403:6406,ge.halfFloat.HALF_FLOAT_OES,null);break;default:ge.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(3==this.format){if(ge.gl.texParameteri(3553,10240,9728),ge.gl.texParameteri(3553,10241,9728),ge.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!ge.gl2){var e=ge.gl.createTexture();ge.gl.bindTexture(3553,e),ge.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,3553,e,0),ge.gl.bindTexture(3553,this.texture)}}else{if(this.samples>1&&ge.gl2){var t;switch(this.MSAAFrameBuffer=ge.gl.createFramebuffer(),this.MSAAColorBuffer=ge.gl.createRenderbuffer(),ge.gl.bindRenderbuffer(36161,this.MSAAColorBuffer),this.format){case 0:t=ge.gl.RGBA8;break;case 2:t=ge.gl.RGBA32F;break;case 4:t=ge.gl.RGBA16F;break;case 5:t=33326;break;case 6:t=33325;break;default:t=ge.gl.RGBA8}ge.gl.renderbufferStorageMultisample(36161,this.samples,t,this.get_realWidth(),this.get_realHeight()),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.framebufferRenderbuffer(36160,36064,36161,this.MSAAColorBuffer),ge.gl.bindFramebuffer(36160,this.MSAAFrameBuffer)}ge.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),ge.gl.bindFramebuffer(36160,null)}this.initDepthStencilBuffer(this.depthStencilFormat);var i=ge.gl.checkFramebufferStatus(36160);36053!=i&&b.trace("checkframebufferStatus error "+i,{fileName:"kha/WebGLImage.hx",lineNumber:250,className:"kha.WebGLImage",methodName:"createTexture"}),ge.gl.bindRenderbuffer(36161,null),ge.gl.bindFramebuffer(36160,null)}else if(null!=this.video)ge.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format){case 0:this.image instanceof Uint8Array?ge.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):ge.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 1:ge.gl.texImage2D(3553,0,6409,this.myWidth,this.myHeight,0,6409,5121,this.image);break;case 2:ge.gl.texImage2D(3553,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:ge.gl.texImage2D(3553,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:ge.gl.texImage2D(3553,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,ge.gl2?6403:6406,5126,this.image);break;case 6:ge.gl.texImage2D(3553,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,ge.gl2?6403:6406,ge.halfFloat.HALF_FLOAT_OES,this.image);break;default:ge.gl.texImage2D(3553,0,6408,6408,5121,this.image)}ge.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:null==ge.depthTexture?(this.renderBuffer=ge.gl.createRenderbuffer(),ge.gl.bindRenderbuffer(36161,this.renderBuffer),ge.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),ge.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.depthTexture),1==e?ge.gl.texImage2D(3553,0,ge.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):ge.gl.texImage2D(3553,0,ge.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),ge.gl.texParameteri(3553,10240,9728),ge.gl.texParameteri(3553,10241,9728),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),ge.gl.bindFramebuffer(36160,this.frameBuffer),this.samples>1&&ge.gl2&&(this.MSAADepthBuffer=ge.gl.createRenderbuffer(),ge.gl.bindRenderbuffer(36161,this.MSAADepthBuffer),1==e?ge.gl.renderbufferStorageMultisample(36161,this.samples,33190,this.get_realWidth(),this.get_realHeight()):ge.gl.renderbufferStorageMultisample(36161,this.samples,33189,this.get_realWidth(),this.get_realHeight()),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.framebufferRenderbuffer(36160,36096,36161,this.MSAADepthBuffer),ge.gl.bindFramebuffer(36160,this.MSAAFrameBuffer)),ge.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0),ge.gl.bindFramebuffer(36160,null));break;case 2:case 3:case 4:null==ge.depthTexture?(this.renderBuffer=ge.gl.createRenderbuffer(),ge.gl.bindRenderbuffer(36161,this.renderBuffer),ge.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),ge.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.depthTexture),ge.gl.texImage2D(3553,0,ge.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,ge.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ge.gl.texParameteri(3553,10240,9728),ge.gl.texParameteri(3553,10241,9728),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),ge.gl.bindFramebuffer(36160,this.frameBuffer),this.samples>1&&ge.gl2&&(this.MSAADepthBuffer=ge.gl.createRenderbuffer(),ge.gl.bindRenderbuffer(36161,this.MSAADepthBuffer),ge.gl.renderbufferStorageMultisample(36161,this.samples,35056,this.get_realWidth(),this.get_realHeight()),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.framebufferRenderbuffer(36160,33306,36161,this.MSAADepthBuffer),ge.gl.bindFramebuffer(36160,this.MSAAFrameBuffer)),ge.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(e){ge.gl.activeTexture(33984+e),ge.gl.bindTexture(3553,this.texture),null!=this.video&&ge.gl.texImage2D(3553,0,6408,6408,5121,this.video)},bytesToArray:function(e){switch(this.format){case 0:case 1:return new Uint8Array(e.b.bufferValue);case 2:case 4:case 5:case 6:return new Float32Array(e.b.bufferValue);default:return new Uint8Array(e.b.bufferValue)}},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new x(new ArrayBuffer(pe.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=ge.gl){switch(this.texture=ge.gl.createTexture(),ge.gl.bindTexture(3553,this.texture),ge.gl.texParameteri(3553,10240,9729),ge.gl.texParameteri(3553,10241,9729),ge.gl.texParameteri(3553,10242,33071),ge.gl.texParameteri(3553,10243,33071),this.format){case 0:ge.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(ge.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==ge.gl.getError()){for(var e=new x(new ArrayBuffer(this.get_width()*this.get_height()*4)),t=0,i=this.get_height();t<i;)for(var r=t++,n=0,a=this.get_width();n<a;){var s=n++,o=this.bytes,l=r*this.get_width()+s,u=o.b[l],h=r*this.get_width()*4+4*s;e.b[h]=u;var d=r*this.get_width()*4+4*s+1;e.b[d]=u;var c=r*this.get_width()*4+4*s+2;e.b[c]=u;var f=r*this.get_width()*4+4*s+3;e.b[f]=255}ge.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(e))}break;case 2:ge.gl.texImage2D(3553,0,ge.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:ge.gl.texImage2D(3553,0,ge.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,ge.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:ge.gl.texImage2D(3553,0,ge.gl2?33326:6406,this.get_width(),this.get_height(),0,ge.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:ge.gl.texImage2D(3553,0,ge.gl2?33325:6406,this.get_width(),this.get_height(),0,ge.gl2?6403:6406,ge.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:ge.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}ge.gl.bindTexture(3553,null),this.bytes=null}},__class__:pe});var ve=function(e,t,i){this.canvas=i,this.defaultWidth=e,this.defaultHeight=t,ve.windows.push(this)};r["kha.Window"]=ve,ve.__name__=!0,ve.get=function(e){return ve.windows[e]},ve.get_all=function(){return ve.windows},ve.prototype={canvas:null,defaultWidth:null,defaultHeight:null,get_width:function(){return 0==this.canvas.clientWidth?this.defaultWidth:this.canvas.clientWidth},get_height:function(){return 0==this.canvas.clientHeight?this.defaultHeight:this.canvas.clientHeight},get_vSynced:function(){return!0},__class__:ve};var be=function(e,t,i,r,n,a,s,o,l){null==l&&(l=0),null==s&&(s=!0),null==a&&(a=-1),null==n&&(n=600),null==r&&(r=800),null==i&&(i=-1),null==t&&(t=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=e,this.x=t,this.y=i,this.width=r,this.height=n,this.display=a,this.visible=s,this.windowFeatures=null==o?7:o,this.mode=l};r["kha.WindowOptions"]=be,be.__name__=!0,be.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:be};var we=function(){};r["kha.audio1.AudioChannel"]=we,we.__name__=!0,we.__isInterface__=!0,we.prototype={__class__:we};var ye=function(e){this.value=e};r["kha.internal.IntBox"]=ye,ye.__name__=!0,ye.prototype={value:null,__class__:ye};var xe=function(){};r["kha.audio2.Audio"]=xe,xe.__name__=!0,xe.initContext=function(){try{return void(xe._context=new AudioContext)}catch(e){e instanceof M&&e.val}try{return void(this._context=new webkitAudioContext)}catch(e){e instanceof M&&e.val}},xe._init=function(){if(xe.initContext(),null==xe._context)return!1;xe.samplesPerSecond=Math.round(xe._context.sampleRate);return xe.buffer=new Be(8192,2,0|xe._context.sampleRate),xe.processingNode=xe._context.createScriptProcessor(2048,0,2),xe.processingNode.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(1);if(null!=xe.audioCallback){xe.intBox.value=2*e.outputBuffer.length,xe.audioCallback(xe.intBox,xe.buffer);for(var r=0,n=e.outputBuffer.length;r<n;){var a=r++;t[a]=xe.buffer.data[xe.buffer.readLocation],xe.buffer.readLocation+=1,i[a]=xe.buffer.data[xe.buffer.readLocation],xe.buffer.readLocation+=1,xe.buffer.readLocation>=xe.buffer.size&&(xe.buffer.readLocation=0)}}else for(var s=0,o=e.outputBuffer.length;s<o;){var l=s++;t[l]=0,i[l]=0}},xe.processingNode.connect(xe._context.destination),!0},xe.wakeChannels=function(){ge.mobileAudioPlaying=!0;for(var e=0,t=xe.virtualChannels;e<t.length;){var i=t[e];++e,i.wake()}};var ke=function(){};r["kha.audio2.Audio1"]=ke,ke.__name__=!0,ke._init=function(){var e=new Array(32);ke.soundChannels=e;var t=new Array(32);ke.streamChannels=t;var i=new Array(32);ke.internalSoundChannels=i;var r=new Array(32);ke.internalStreamChannels=r;var n=new Float32Array(512);ke.sampleCache1=n;var a=new Float32Array(512);ke.sampleCache2=a,ke.lastAllocationCount=0,xe.audioCallback=ke.mix},ke.mix=function(e,t){var i=e.value;if(ke.sampleCache1.length<i){if(xe.disableGcInteractions){b.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:50,className:"kha.audio2.Audio1",methodName:"mix"});for(var r=0,n=i;r<n;){r++;t.data[t.writeLocation]=0,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}return ke.lastAllocationCount=0,void(xe.disableGcInteractions=!1)}var a=new Float32Array(2*i);ke.sampleCache1=a;var s=new Float32Array(2*i);ke.sampleCache2=s,ke.lastAllocationCount=0}else ke.lastAllocationCount>100?xe.disableGcInteractions=!0:ke.lastAllocationCount+=1;for(var o=0,l=i;o<l;){var u=o++;ke.sampleCache2[u]=0}for(var h=0;h<32;){var d=h++;ke.internalSoundChannels[d]=ke.soundChannels[d]}for(var c=0;c<32;){var f=c++;ke.internalStreamChannels[f]=ke.streamChannels[f]}for(var _=0,g=ke.internalSoundChannels;_<g.length;){var m=g[_];if(++_,null!=m&&!m.get_finished()){m.nextSamples(ke.sampleCache1,i,t.samplesPerSecond);for(var p=0,v=i;p<v;){var w=p++;ke.sampleCache2[w]+=ke.sampleCache1[w]*m.get_volume()}}}for(var y=0,x=ke.internalStreamChannels;y<x.length;){var k=x[y];if(++y,null!=k&&!k.get_finished()){k.nextSamples(ke.sampleCache1,i,t.samplesPerSecond);for(var I=0,B=i;I<B;){var S=I++;ke.sampleCache2[S]+=ke.sampleCache1[S]*k.get_volume()}}}for(var A=0,T=i;A<T;){var N=A++,C=ke.sampleCache2[N],D=C<1?C:1;t.data[t.writeLocation]=D>-1?D:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}};var Ie=function(e){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=e};r["kha.audio2.AudioChannel"]=Ie,Ie.__name__=!0,Ie.__interfaces__=[we],Ie.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(e,t,i){if(this.paused||this.stopped)for(var r=0,n=t;r<n;){e[r++]=0}else{for(var a=0;a<t;){for(var s=0,o=this.data.length-this.myPosition,l=t-a,u=o<l?o:l;s<u;){s++;e[a++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;a<t;)e[a++]=0}},get_volume:function(){return this.myVolume},finished:null,get_finished:function(){return this.stopped},__class__:Ie};var Be=function(e,t,i){this.size=e;var r=new Float32Array(e);this.data=r,this.channels=t,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};r["kha.audio2.Buffer"]=Be,Be.__name__=!0,Be.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Be};var Se=function(e,t){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=t,this.reader=Ne.openFromBytes(e)};r["kha.audio2.StreamChannel"]=Se,Se.__name__=!0,Se.__interfaces__=[we],Se.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(e,t,i){if(this.paused)for(var r=0,n=t;r<n;){e[r++]=0}else{var a=2*this.reader.read(e,t/2|0,2,i,!0);if(a<t){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var s=a,o=t;s<o;){e[s++]=0}}}},get_volume:function(){return this.myVolume},finished:null,get_finished:function(){return this.atend},__class__:Se};var Ae=function(e,t){this.mode=2,this.aeChannel=e,this.looping=t,this.lastTickTime=ue.realTime(),this.lastPosition=0};r["kha.audio2.VirtualStreamChannel"]=Ae,Ae.__name__=!0,Ae.__interfaces__=[we],Ae.prototype={aeChannel:null,mode:null,lastTickTime:null,lastPosition:null,looping:null,wake:function(){this.updatePosition(),this.aeChannel.set_position(this.lastPosition),this.aeChannel.play()},updatePosition:function(){var e=ue.realTime();switch(this.mode){case 0:this.lastPosition=0;break;case 1:break;case 2:for(this.lastPosition+=e-this.lastTickTime;this.lastPosition>this.get_length();)this.lastPosition-=this.get_length()}this.lastTickTime=e},length:null,get_length:function(){return this.aeChannel.get_length()},__class__:Ae};var Te=function(){};r["kha.audio2.ogg.tools.Crc32"]=Te,Te.__name__=!0,Te.init=function(){if(null==Te.table){var e=new Array(256);Te.table=e;for(var t=0;t<256;){var i=t++,r=i<<24;r=(r=(r=(r=(r=(r=(r=(r=r<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0))<<1^(m.gte(r,1<<31)?79764919:0),Te.table[i]=r}}};var Ne=function(e,t,i){this.seekFunc=t,this.inputLength=i,this.decoder=Ee.start(e),this.decoder.setupSampleNumber(t,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};r["kha.audio2.ogg.vorbis.Reader"]=Ne,Ne.__name__=!0,Ne.openFromBytes=function(e){var t=new D(e),i=t;return new Ne(t,function(e){Ne.seekBytes(i,e)},e.length)},Ne.seekBytes=function(e,t){e.set_position(t)},Ne.readAll=function(e,t,i){null==i&&(i=!1);var r=new D(e),n=Ee.start(r),a=r;n.setupSampleNumber(function(e){Ne.seekBytes(a,e)},e.length);for(var s=n.header,o=new Float32Array(4096*s.channel);;){for(var l=n.read(o,4096,s.channel,s.sampleRate,i),u=0,h=l*s.channel;u<h;){var d=u++;t.writeFloat(o[d])}if(0==l)break;l}return n.header},Ne.prototype={decoder:null,get_header:function(){return this.decoder.header},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(e){return this.decoder.seek(this.seekFunc,this.inputLength,e),this.decoder.currentSample},get_currentMillisecond:function(){var e=this.get_currentSample(),t=this.get_header().sampleRate;return m.toFloat(e)/m.toFloat(t)*1e3},set_currentMillisecond:function(e){return this.set_currentSample(Math.floor(m.toFloat(this.get_header().sampleRate)*(e/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(e,t,i,r,n){return null==n&&(n=!1),this.decoder.ensurePosition(this.seekFunc),null==t&&(t=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==r&&(r=this.get_header().sampleRate),this.decoder.read(e,t,i,r,n)},__class__:Ne};var Ce=function(e){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=e,this.inputPosition=0,this.page=new Oe,Te.init()};r["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Ce,Ce.__name__=!0,Ce.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(e,t){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var r=new Array(i),n=0,a=i;n<a;){r[n++]=this.input.readByte()}if(this.segments=r,this.endSegWithKnownLoc=-2,-1!=e||-1!=t)for(var s=i-1;s>=0&&!(this.segments[s]<255);)s>=0&&(this.endSegWithKnownLoc=s,this.knownLocForPacket=e),--s;if(this.firstDecode){for(var o=0,l=new ze,u=0,h=i;u<h;){var d=u++;o+=this.segments[d]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=e,this.pFirst=l}this.nextSeg=0},clone:function(e){var t=Object.create(Ce.prototype);return e(this.inputPosition),t.input=this.input,t.eof=this.eof,t.validBits=this.validBits,t.discardSamplesDeferred=this.discardSamplesDeferred,t.firstDecode=this.firstDecode,t.nextSeg=this.nextSeg,t.bytesInSeg=this.bytesInSeg,t.acc=t.acc,t.lastSeg=this.lastSeg,t.lastSegWhich=this.lastSegWhich,t.currentLoc=this.currentLoc,t.currentLocValid=this.currentLocValid,t.inputPosition=this.inputPosition,t.firstAudioPageOffset=this.firstAudioPageOffset,t.error=this.error,t.segments=this.segments,t.pFirst=this.pFirst,t.pLast=this.pLast,t.page=this.page.clone(),t},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof M?t.val:t;if(e instanceof Xe)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new M(new Xe(Ke.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t,t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new M(new Xe(Ke.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,t,i,r,n=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var a=t instanceof M?t.val:t;if(!(a instanceof L))throw t;n=!0,e=0}if(n)return!1;if(79==e?(this.inputPosition+=1,r=103!=this.input.readByte()):r=!0,r?i=!0:(this.inputPosition+=1,i=103!=this.input.readByte()),i?t=!0:(this.inputPosition+=1,t=83!=this.input.readByte()),t)throw new M(new Xe(Ke.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(e){if(this.validBits<0)return 0;if(this.validBits<e){if(e>24)return this.readBits(24)+(this.readBits(e-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<e))break}if(this.validBits<0)return 0;var t=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,t}var i=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,i},firstPageValidate:function(){if(1!=this.segments.length)throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},finishDecodePacket:function(e,t,i){var r=i.left.start,n=!1,a=t>>1;if(this.firstDecode)this.currentLoc=-a,this.discardSamplesDeferred=t-i.right.end,n=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,r=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(n&&0!=(4&this.page.flag)){var s=this.knownLocForPacket-(t-i.right.end);if(s<this.currentLoc+i.right.end){var o=s<this.currentLoc?0:s-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:r,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(a-i.left.start),n=!0}return n&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:r,right:i.right.start}},getSampleNumber:function(e,t){var i=this.inputPosition,r=m.gte(t,65536)&&m.gte(t-65536,this.firstAudioPageOffset)?t-65536:this.firstAudioPageOffset;e(this.inputPosition=r);var n=0,a=!1,s=this.findPage(e,t);switch(s._hx_index){case 0:var o=s.last;n=s.end,a=o;break;case 1:throw new M(new Xe(Ke.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;e:for(;!a;){e(this.inputPosition=n);var u=this.findPage(e,t);switch(u._hx_index){case 0:var h=u.last;n=u.end,a=h;break;case 1:break e}r=l+1,l=this.inputPosition}e(this.inputPosition=l),this.inputPosition+=6;for(var d=new Array(6),c=0;c<6;){d[c++]=this.input.readByte()}this.inputPosition+=4;var f=this.input.readInt32();this.inputPosition+=4;var _=this.input.readInt32();if(-1==f&&-1==_||_>0)throw new M(new Xe(Ke.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new ze,this.pLast.pageStart=l,this.pLast.pageEnd=n,this.pLast.lastDecodedSample=f,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=r,e(this.inputPosition=i),f},findPage:function(e,t){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i,r,n=this.inputPosition;if(n-25>t)return De.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,r=103!=this.input.readByte()):r=!0,r?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)continue;var a=new Array(27);if(a[0]=79,a[1]=103,a[2]=103,a[3]=83,this.inputPosition+=1,a[4]=this.input.readByte(),this.inputPosition+=1,a[5]=this.input.readByte(),this.inputPosition+=1,a[6]=this.input.readByte(),this.inputPosition+=1,a[7]=this.input.readByte(),this.inputPosition+=1,a[8]=this.input.readByte(),this.inputPosition+=1,a[9]=this.input.readByte(),this.inputPosition+=1,a[10]=this.input.readByte(),this.inputPosition+=1,a[11]=this.input.readByte(),this.inputPosition+=1,a[12]=this.input.readByte(),this.inputPosition+=1,a[13]=this.input.readByte(),this.inputPosition+=1,a[14]=this.input.readByte(),this.inputPosition+=1,a[15]=this.input.readByte(),this.inputPosition+=1,a[16]=this.input.readByte(),this.inputPosition+=1,a[17]=this.input.readByte(),this.inputPosition+=1,a[18]=this.input.readByte(),this.inputPosition+=1,a[19]=this.input.readByte(),this.inputPosition+=1,a[20]=this.input.readByte(),this.inputPosition+=1,a[21]=this.input.readByte(),this.inputPosition+=1,a[22]=this.input.readByte(),this.inputPosition+=1,a[23]=this.input.readByte(),this.inputPosition+=1,a[24]=this.input.readByte(),this.inputPosition+=1,a[25]=this.input.readByte(),this.inputPosition+=1,a[26]=this.input.readByte(),0!=a[4]){e(this.inputPosition=n);continue}var s=a[22]+(a[23]<<8)+(a[24]<<16)+(a[25]<<24);a[22]=0,a[23]=0,a[24]=0,a[25]=0;for(var o=0,l=0;l<27;){var u=l++;o=o<<8^Te.table[a[u]^o>>>24]}var h=0;try{for(var d=0,c=a[26];d<c;){d++;this.inputPosition+=1;var f=this.input.readByte();o=o<<8^Te.table[f^o>>>24],h+=f}for(var _=0,g=h;_<g;){_++;this.inputPosition+=1;var m=this.input.readByte();o=o<<8^Te.table[m^o>>>24]}}catch(e){var p=e instanceof M?e.val:e;if(p instanceof L){return De.NotFound}throw e}if(o==s){var v=this.inputPosition;return e(this.inputPosition=n-1),De.Found(v,0!=(4&a[5]))}}}}catch(e){var b=e instanceof M?e.val:e;if(b instanceof L){return De.NotFound}throw e}},analyzePage:function(e,t){var i=new ze,r=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var n=new Array(27),a=0;a<27;){n[a++]=this.input.readByte()}var s=n,o=s[26];this.inputPosition+=o;for(var l=new Array(o),u=0,h=o;u<h;){l[u++]=this.input.readByte()}for(var d=l,c=0,f=0,_=s[26];f<_;){c+=d[f++]}if(i.pageEnd=i.pageStart+27+s[26]+c,i.lastDecodedSample=s[6]+(s[7]<<8)+(s[8]<<16)+(s[9]<<16),0!=(4&s[5]))return i.firstDecodedSample=null,e(this.inputPosition=i.pageStart),i;for(var g=0,m=0==(1&s[5]),p=t.modes.length,v=0,b=s[26];v<b;){var w=v++;if(m){if(0==d[w])return e(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var y=this.input.readByte();if(0!=(1&y))return e(this.inputPosition=i.pageStart),null;y>>=1;var x=p-1,k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if((y&=(1<<(x<16384?x<16?k[x]:x<512?5+k[x>>5]:10+k[x>>10]:x<16777216?x<524288?15+k[x>>15]:20+k[x>>20]:x<536870912?25+k[x>>25]:x<-2147483648?30+k[x>>30]:0))-1)>=p)return e(this.inputPosition=i.pageStart),null;r[g++]=t.modes[y].blockflag;var I=d[w]-1;this.inputPosition+=I;for(var B=new Array(I),S=0,A=I;S<A;){B[S++]=this.input.readByte()}}else{var T=d[w];this.inputPosition+=T;for(var N=new Array(T),C=0,D=T;C<D;){N[C++]=this.input.readByte()}}m=d[w]<255}var E=0;g>1&&(E+=r[g-1]?t.blocksize1:t.blocksize0);for(var P=g-2;P>=1;)r[--P]?r[P+1]?E+=t.blocksize1>>1:E+=(t.blocksize1-t.blocksize0>>2)+(t.blocksize0>>1):E+=t.blocksize0>>1,--P;return i.firstDecodedSample=i.lastDecodedSample-E,e(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(e){this.prepHuffman();var t=e.codewordLengths,i=e.codewords,r=e.sortedCodewords;if(e.entries>8?null!=r:null!=i){for(var n=this.acc,a=(n=(-16711936&(n=(-252645136&(n=(-858993460&(n=(-1431655766&n)>>>1|(1431655765&n)<<1))>>>2|(858993459&n)<<2))>>>4|(252645135&n)<<4))>>>8|(16711935&n)<<8)>>>16|n<<16,s=0,o=e.sortedEntries;o>1;){var l=s+(o>>1);m.gte(a,r[l])?(s=l,o-=o>>1):o>>=1}e.sparse||(s=e.sortedValues[s]);var u=t[s];return this.validBits>=u?(this.acc=this.acc>>>u,this.validBits-=u,s):(this.validBits=0,-1)}for(var h=0,d=e.entries;h<d;){var c=h++,f=t[c];if(255!=f&&i[c]==(this.acc&(1<<f)-1))return this.validBits>=f?(this.acc=this.acc>>>f,this.validBits-=f,c):(this.validBits=0,-1)}return this.error=new Xe(Ke.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Ce};var De=a["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(i=function(e,t){return{_hx_index:0,end:e,last:t,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},i.__params__=["end","last"],i),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},Ee=function(e,t){this.header=e,this.decodeState=t,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(e.channel);this.channelBuffers=i;var r=new Array(e.channel);this.previousWindow=r;var n=new Array(e.channel);this.finalY=n;for(var a=0,s=e.channel;a<s;){var o=a++,l=this.channelBuffers,u=new Array(e.blocksize1);l[o]=u;var h=this.previousWindow,d=new Array(e.blocksize1/2|0);h[o]=d,this.finalY[o]=[]}var c=new Array(2);this.a=c;var f=new Array(2);this.b=f;var _=new Array(2);this.c=_;var g=new Array(2);this.window=g;var m=new Array(2);this.bitReverseData=m,this.initBlocksize(0,e.blocksize0),this.initBlocksize(1,e.blocksize1)};r["kha.audio2.ogg.vorbis.VorbisDecoder"]=Ee,Ee.__name__=!0,Ee.start=function(e){var t=new Ce(e),i=Re.read(t),r=new Ee(i,t);return t.startFirstDecode(),r.pumpFirstFrame(),r},Ee.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(e,t,i,r,n){var a=this.header.sampleRate;if(0!=(m.toFloat(r)%m.toFloat(a)|0)){var s=this.header.sampleRate;throw new M("Unsupported sampleRate : can't convert "+f.string(null==s?null:m.toFloat(s))+" to "+r)}if(i%this.header.channel!=0)throw new M("Unsupported channels : can't convert "+this.header.channel+" to "+i);var o=this.header.sampleRate,l=m.toFloat(r)/m.toFloat(o)|0,u=i/this.header.channel|0,h=0,d=Math.floor(t/l);null!=this.totalSample&&d>this.totalSample-this.currentSample&&(d=this.totalSample-this.currentSample);for(var c=0;h<d;){var _=this.channelBufferEnd-this.channelBufferStart;_>=d-h&&(_=d-h);for(var g=this.channelBufferStart,p=this.channelBufferStart+_;g<p;)for(var v=g++,b=0,w=l;b<w;){b++;for(var y=0,x=this.header.channel;y<x;)for(var k=y++,I=0,B=u;I<B;){I++;var S=this.channelBuffers[k][v];S>1?S=1:S<-1&&(S=-1),n&&(e[c]=S,++c)}}if(h+=_,this.channelBufferStart+=_,h==d||0==this.getFrameFloat())break}for(var A=h,T=d;A<T;){A++;for(var N=0,C=l;N<C;){N++;for(var D=0,E=this.header.channel;D<E;){D++;for(var P=0,L=u;P<L;){P++;n&&(e[c]=0,++c)}}}}return this.currentSample+=d,d*l},skipSamples:function(e){var t=0;for(null!=this.totalSample&&e>this.totalSample-this.currentSample&&(e=this.totalSample-this.currentSample);t<e;){var i=this.channelBufferEnd-this.channelBufferStart;if(i>=e-t&&(i=e-t),t+=i,this.channelBufferStart+=i,t==e||0==this.getFrameFloat())break}return this.currentSample+=e,e},setupSampleNumber:function(e,t){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(e,t))},seek:function(e,t,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(e,t),0==this.totalSample))throw new M(new Xe(Ke.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var r=this.decodeState.pFirst,n=this.decodeState.pLast;if(i>=n.lastDecodedSample&&(i=n.lastDecodedSample-1),i<r.lastDecodedSample)this.seekFrameFromPage(e,r.pageStart,0,i);else{for(var a=0;r.pageEnd<n.pageStart;){var s=r.pageEnd,o=n.afterPreviousPageStart,l=r.lastDecodedSample,u=n.lastDecodedSample;if(null==l||null==u)throw new M(new Xe(Ke.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));m.gt(o,s+4e3)&&(o-=4e3);var h=s+Math.floor(m.toFloat(o-s)/m.toFloat(u-l)*(i-l));if(a>=4){var d=s+(o-s>>>1);h=a>=8?d:m.gt(d,h)?h+(d-h>>>1):d+(h-d>>>1)}++a,e(this.decodeState.inputPosition=h);var c=this.decodeState.findPage(e,t);switch(c._hx_index){case 0:c.last,c.end;break;case 1:throw new M(new Xe(Ke.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var f=this.decodeState.analyzePage(e,this.header);if(null==f)throw new M(new Xe(Ke.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));f.afterPreviousPageStart=h,f.pageStart!=n.pageStart?i<f.lastDecodedSample?n=f:r=f:n=f}if(!(r.lastDecodedSample<=i&&i<n.lastDecodedSample))throw new M(new Xe(Ke.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(e,n.pageStart,r.lastDecodedSample,i)}}},seekFrameFromPage:function(e,t,i,r){var n=0,a=i;e(this.decodeState.inputPosition=t),this.decodeState.nextSeg=-1;for(var s=0,o=0,l=null,u=null;;){l=u,u=this.decodeState.clone(e);var h=this.decodeInitial();if(null==h){u=l;break}o=h.left.start,s=h.left.end;var d=0==n?s:o;if(r<a+h.right.start-d)break;for(var c=this.decodeState;0!=c.bytesInSeg||!c.lastSeg&&0!=c.next();)c.bytesInSeg--,c.inputPosition+=1,c.input.readByte();a+=h.right.start-d,++n}this.decodeState=u,e(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=a,this.skipSamples(r-a)},ensurePosition:function(e){e(this.decodeState.inputPosition)},getFrameFloat:function(){var e=this.decodePacket();if(null==e)return this.channelBufferStart=this.channelBufferEnd=0,0;var t=this.finishFrame(e);return this.channelBufferStart=e.left,this.channelBufferEnd=e.left+t,t},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(e){var t=e.len,i=e.right,r=e.left;if(0!=this.previousLength)for(var n=this.previousLength,a=this.getWindow(n),s=0,o=this.header.channel;s<o;)for(var l=s++,u=this.channelBuffers[l],h=this.previousWindow[l],d=0,c=n;d<c;){var f=d++;u[r+f]=u[r+f]*a[f]+h[f]*a[n-1-f]}var _=this.previousLength;this.previousLength=t-i;for(var g=0,m=this.header.channel;g<m;)for(var p=g++,v=this.previousWindow[p],b=this.channelBuffers[p],w=0,y=t-i;w<y;){var x=w++;v[x]=b[i+x]}return 0==_?0:(t<i&&(i=t),i-r)},getWindow:function(e){return(e<<=1)==this.header.blocksize0?this.window[0]:e==this.header.blocksize1?this.window[1]:null},initBlocksize:function(e,t){var i=t>>1,r=t>>2,n=t>>3,a=this.a,s=new Array(i);a[e]=s;var o=this.b,l=new Array(i);o[e]=l;var u=this.c,h=new Array(r);u[e]=h;var d=this.window,c=new Array(i);d[e]=c;var f=this.bitReverseData,_=new Array(n);f[e]=_,Pe.computeTwiddleFactors(t,this.a[e],this.b[e],this.c[e]),Pe.computeWindow(t,this.window[e]),Pe.computeBitReverse(t,this.bitReverseData[e])},inverseMdct:function(e,t,i){for(var r=i?1:0,n=this.a[r],a=this.b[r],s=this.c[r],o=this.bitReverseData[r],l=t>>1,u=t>>2,h=t>>3,d=new Array(l),c=l-2,f=0,_=0,g=l;_!=g;)d[c+1]=e[_]*n[f]-e[_+2]*n[f+1],d[c]=e[_]*n[f+1]+e[_+2]*n[f],c-=2,f+=2,_+=4;for(_=l-3;c>=0;)d[c+1]=-e[_+2]*n[f]- -e[_]*n[f+1],d[c]=-e[_+2]*n[f+1]+-e[_]*n[f],c-=2,f+=2,_-=4;for(var m=e,p=d,v=l-8,b=u,w=0,y=u,x=0;v>=0;){var k=p[b+1]-p[w+1],I=p[b]-p[w];m[y+1]=p[b+1]+p[w+1],m[y]=p[b]+p[w],m[x+1]=k*n[v+4]-I*n[v+5],m[x]=I*n[v+4]+k*n[v+5],k=p[b+3]-p[w+3],I=p[b+2]-p[w+2],m[y+3]=p[b+3]+p[w+3],m[y+2]=p[b+2]+p[w+2],m[x+3]=k*n[v]-I*n[v+1],m[x+2]=I*n[v]+k*n[v+1],v-=8,y+=4,x+=4,b+=4,w+=4}for(var B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],S=(t<16384?t<16?B[t]:t<512?5+B[t>>5]:10+B[t>>10]:t<16777216?t<524288?15+B[t>>15]:20+B[t>>20]:t<536870912?25+B[t>>25]:t<-2147483648?30+B[t>>30]:0)-1,A=l-1-0*u,T=A,N=A+-(t>>3),C=0,D=1+(t>>4>>2);--D>0;){var E=m[T]-m[N],P=m[T+-1]-m[N+-1],L=T,V=m;V[L]=V[L]+m[N];var F=T+-1,W=m;W[F]=W[F]+m[N+-1],m[N]=E*n[C]-P*n[C+1],m[N+-1]=P*n[C]+E*n[C+1],C+=8,E=m[T+-2]-m[N+-2],P=m[T+-3]-m[N+-3];var M=T+-2,R=m;R[M]=R[M]+m[N+-2];var G=T+-3,H=m;H[G]=H[G]+m[N+-3],m[N+-2]=E*n[C]-P*n[C+1],m[N+-3]=P*n[C]+E*n[C+1],C+=8,E=m[T+-4]-m[N+-4],P=m[T+-5]-m[N+-5];var U=T+-4,Z=m;Z[U]=Z[U]+m[N+-4];var O=T+-5,z=m;z[O]=z[O]+m[N+-5],m[N+-4]=E*n[C]-P*n[C+1],m[N+-5]=P*n[C]+E*n[C+1],C+=8,E=m[T+-6]-m[N+-6],P=m[T+-7]-m[N+-7];var X=T+-6,K=m;K[X]=K[X]+m[N+-6];var j=T+-7,Y=m;Y[j]=Y[j]+m[N+-7],m[N+-6]=E*n[C]-P*n[C+1],m[N+-7]=P*n[C]+E*n[C+1],C+=8,T-=8,N-=8}for(var Q=l-1-u,J=Q,q=Q+-(t>>3),$=0,ee=1+(t>>4>>2);--ee>0;){var te=m[J]-m[q],ie=m[J+-1]-m[q+-1],re=J,ne=m;ne[re]=ne[re]+m[q];var ae=J+-1,se=m;se[ae]=se[ae]+m[q+-1],m[q]=te*n[$]-ie*n[$+1],m[q+-1]=ie*n[$]+te*n[$+1],$+=8,te=m[J+-2]-m[q+-2],ie=m[J+-3]-m[q+-3];var oe=J+-2,le=m;le[oe]=le[oe]+m[q+-2];var ue=J+-3,he=m;he[ue]=he[ue]+m[q+-3],m[q+-2]=te*n[$]-ie*n[$+1],m[q+-3]=ie*n[$]+te*n[$+1],$+=8,te=m[J+-4]-m[q+-4],ie=m[J+-5]-m[q+-5];var de=J+-4,ce=m;ce[de]=ce[de]+m[q+-4];var fe=J+-5,_e=m;_e[fe]=_e[fe]+m[q+-5],m[q+-4]=te*n[$]-ie*n[$+1],m[q+-5]=ie*n[$]+te*n[$+1],$+=8,te=m[J+-6]-m[q+-6],ie=m[J+-7]-m[q+-7];var ge=J+-6,me=m;me[ge]=me[ge]+m[q+-6];var pe=J+-7,ve=m;ve[pe]=ve[pe]+m[q+-7],m[q+-6]=te*n[$]-ie*n[$+1],m[q+-7]=ie*n[$]+te*n[$+1],$+=8,J-=8,q-=8}for(var be=l-1-0*h,we=0,ye=be,xe=be+-(t>>4),ke=1+(t>>5>>2);--ke>0;){var Ie=m[ye]-m[xe],Be=m[ye+-1]-m[xe+-1],Se=ye,Ae=m;Ae[Se]=Ae[Se]+m[xe];var Te=ye+-1,Ne=m;Ne[Te]=Ne[Te]+m[xe+-1],m[xe]=Ie*n[we]-Be*n[we+1],m[xe+-1]=Be*n[we]+Ie*n[we+1],we+=16,Ie=m[ye+-2]-m[xe+-2],Be=m[ye+-3]-m[xe+-3];var Ce=ye+-2,De=m;De[Ce]=De[Ce]+m[xe+-2];var Ee=ye+-3,Pe=m;Pe[Ee]=Pe[Ee]+m[xe+-3],m[xe+-2]=Ie*n[we]-Be*n[we+1],m[xe+-3]=Be*n[we]+Ie*n[we+1],we+=16,Ie=m[ye+-4]-m[xe+-4],Be=m[ye+-5]-m[xe+-5];var Le=ye+-4,Ve=m;Ve[Le]=Ve[Le]+m[xe+-4];var Fe=ye+-5,We=m;We[Fe]=We[Fe]+m[xe+-5],m[xe+-4]=Ie*n[we]-Be*n[we+1],m[xe+-5]=Be*n[we]+Ie*n[we+1],we+=16,Ie=m[ye+-6]-m[xe+-6],Be=m[ye+-7]-m[xe+-7];var Me=ye+-6,Re=m;Re[Me]=Re[Me]+m[xe+-6];var Ge=ye+-7,He=m;He[Ge]=He[Ge]+m[xe+-7],m[xe+-6]=Ie*n[we]-Be*n[we+1],m[xe+-7]=Be*n[we]+Ie*n[we+1],ye-=8,xe-=8,we+=16}for(var Ue=l-1-h,Ze=0,Oe=Ue,ze=Ue+-(t>>4),Xe=1+(t>>5>>2);--Xe>0;){var Ke=m[Oe]-m[ze],je=m[Oe+-1]-m[ze+-1],Ye=Oe,Qe=m;Qe[Ye]=Qe[Ye]+m[ze];var Je=Oe+-1,qe=m;qe[Je]=qe[Je]+m[ze+-1],m[ze]=Ke*n[Ze]-je*n[Ze+1],m[ze+-1]=je*n[Ze]+Ke*n[Ze+1],Ze+=16,Ke=m[Oe+-2]-m[ze+-2],je=m[Oe+-3]-m[ze+-3];var $e=Oe+-2,et=m;et[$e]=et[$e]+m[ze+-2];var tt=Oe+-3,it=m;it[tt]=it[tt]+m[ze+-3],m[ze+-2]=Ke*n[Ze]-je*n[Ze+1],m[ze+-3]=je*n[Ze]+Ke*n[Ze+1],Ze+=16,Ke=m[Oe+-4]-m[ze+-4],je=m[Oe+-5]-m[ze+-5];var rt=Oe+-4,nt=m;nt[rt]=nt[rt]+m[ze+-4];var at=Oe+-5,st=m;st[at]=st[at]+m[ze+-5],m[ze+-4]=Ke*n[Ze]-je*n[Ze+1],m[ze+-5]=je*n[Ze]+Ke*n[Ze+1],Ze+=16,Ke=m[Oe+-6]-m[ze+-6],je=m[Oe+-7]-m[ze+-7];var ot=Oe+-6,lt=m;lt[ot]=lt[ot]+m[ze+-6];var ut=Oe+-7,ht=m;ht[ut]=ht[ut]+m[ze+-7],m[ze+-6]=Ke*n[Ze]-je*n[Ze+1],m[ze+-7]=je*n[Ze]+Ke*n[Ze+1],Oe-=8,ze-=8,Ze+=16}for(var dt=l-1-2*h,ct=0,ft=dt,_t=dt+-(t>>4),gt=1+(t>>5>>2);--gt>0;){var mt=m[ft]-m[_t],pt=m[ft+-1]-m[_t+-1],vt=ft,bt=m;bt[vt]=bt[vt]+m[_t];var wt=ft+-1,yt=m;yt[wt]=yt[wt]+m[_t+-1],m[_t]=mt*n[ct]-pt*n[ct+1],m[_t+-1]=pt*n[ct]+mt*n[ct+1],ct+=16,mt=m[ft+-2]-m[_t+-2],pt=m[ft+-3]-m[_t+-3];var xt=ft+-2,kt=m;kt[xt]=kt[xt]+m[_t+-2];var It=ft+-3,Bt=m;Bt[It]=Bt[It]+m[_t+-3],m[_t+-2]=mt*n[ct]-pt*n[ct+1],m[_t+-3]=pt*n[ct]+mt*n[ct+1],ct+=16,mt=m[ft+-4]-m[_t+-4],pt=m[ft+-5]-m[_t+-5];var St=ft+-4,At=m;At[St]=At[St]+m[_t+-4];var Tt=ft+-5,Nt=m;Nt[Tt]=Nt[Tt]+m[_t+-5],m[_t+-4]=mt*n[ct]-pt*n[ct+1],m[_t+-5]=pt*n[ct]+mt*n[ct+1],ct+=16,mt=m[ft+-6]-m[_t+-6],pt=m[ft+-7]-m[_t+-7];var Ct=ft+-6,Dt=m;Dt[Ct]=Dt[Ct]+m[_t+-6];var Et=ft+-7,Pt=m;Pt[Et]=Pt[Et]+m[_t+-7],m[_t+-6]=mt*n[ct]-pt*n[ct+1],m[_t+-7]=pt*n[ct]+mt*n[ct+1],ft-=8,_t-=8,ct+=16}for(var Lt=l-1-3*h,Vt=0,Ft=Lt,Wt=Lt+-(t>>4),Mt=1+(t>>5>>2);--Mt>0;){var Rt=m[Ft]-m[Wt],Gt=m[Ft+-1]-m[Wt+-1],Ht=Ft,Ut=m;Ut[Ht]=Ut[Ht]+m[Wt];var Zt=Ft+-1,Ot=m;Ot[Zt]=Ot[Zt]+m[Wt+-1],m[Wt]=Rt*n[Vt]-Gt*n[Vt+1],m[Wt+-1]=Gt*n[Vt]+Rt*n[Vt+1],Vt+=16,Rt=m[Ft+-2]-m[Wt+-2],Gt=m[Ft+-3]-m[Wt+-3];var zt=Ft+-2,Xt=m;Xt[zt]=Xt[zt]+m[Wt+-2];var Kt=Ft+-3,jt=m;jt[Kt]=jt[Kt]+m[Wt+-3],m[Wt+-2]=Rt*n[Vt]-Gt*n[Vt+1],m[Wt+-3]=Gt*n[Vt]+Rt*n[Vt+1],Vt+=16,Rt=m[Ft+-4]-m[Wt+-4],Gt=m[Ft+-5]-m[Wt+-5];var Yt=Ft+-4,Qt=m;Qt[Yt]=Qt[Yt]+m[Wt+-4];var Jt=Ft+-5,qt=m;qt[Jt]=qt[Jt]+m[Wt+-5],m[Wt+-4]=Rt*n[Vt]-Gt*n[Vt+1],m[Wt+-5]=Gt*n[Vt]+Rt*n[Vt+1],Vt+=16,Rt=m[Ft+-6]-m[Wt+-6],Gt=m[Ft+-7]-m[Wt+-7];var $t=Ft+-6,ei=m;ei[$t]=ei[$t]+m[Wt+-6];var ti=Ft+-7,ii=m;ii[ti]=ii[ti]+m[Wt+-7],m[Wt+-6]=Rt*n[Vt]-Gt*n[Vt+1],m[Wt+-7]=Gt*n[Vt]+Rt*n[Vt+1],Ft-=8,Wt-=8,Vt+=16}for(var ri=2,ni=S-3>>1;ri<ni;)for(var ai=ri++,si=t>>ai+2,oi=si>>1,li=0,ui=1<<ai+1;li<ui;)for(var hi=l-1-si*li++,di=1<<ai+3,ci=0,fi=hi,_i=hi+-oi,gi=1+(t>>ai+4>>2);--gi>0;){var mi=m[fi]-m[_i],pi=m[fi+-1]-m[_i+-1],vi=fi,bi=m;bi[vi]=bi[vi]+m[_i];var wi=fi+-1,yi=m;yi[wi]=yi[wi]+m[_i+-1],m[_i]=mi*n[ci]-pi*n[ci+1],m[_i+-1]=pi*n[ci]+mi*n[ci+1],ci+=di,mi=m[fi+-2]-m[_i+-2],pi=m[fi+-3]-m[_i+-3];var xi=fi+-2,ki=m;ki[xi]=ki[xi]+m[_i+-2];var Ii=fi+-3,Bi=m;Bi[Ii]=Bi[Ii]+m[_i+-3],m[_i+-2]=mi*n[ci]-pi*n[ci+1],m[_i+-3]=pi*n[ci]+mi*n[ci+1],ci+=di,mi=m[fi+-4]-m[_i+-4],pi=m[fi+-5]-m[_i+-5];var Si=fi+-4,Ai=m;Ai[Si]=Ai[Si]+m[_i+-4];var Ti=fi+-5,Ni=m;Ni[Ti]=Ni[Ti]+m[_i+-5],m[_i+-4]=mi*n[ci]-pi*n[ci+1],m[_i+-5]=pi*n[ci]+mi*n[ci+1],ci+=di,mi=m[fi+-6]-m[_i+-6],pi=m[fi+-7]-m[_i+-7];var Ci=fi+-6,Di=m;Di[Ci]=Di[Ci]+m[_i+-6];var Ei=fi+-7,Pi=m;Pi[Ei]=Pi[Ei]+m[_i+-7],m[_i+-6]=mi*n[ci]-pi*n[ci+1],m[_i+-7]=pi*n[ci]+mi*n[ci+1],fi-=8,_i-=8,ci+=di}for(var Li=S-3>>1,Vi=S-6;Li<Vi;)for(var Fi=Li++,Wi=t>>Fi+2,Mi=1<<Fi+3,Ri=Wi>>1,Gi=1<<Fi+1,Hi=0,Ui=l-1,Zi=(t>>Fi+6)+1;--Zi>0;){for(var Oi=n[Hi],zi=n[Hi+1],Xi=n[Hi+Mi],Ki=n[Hi+Mi+1],ji=n[Hi+2*Mi],Yi=n[Hi+2*Mi+1],Qi=n[Hi+3*Mi],Ji=n[Hi+3*Mi+1],qi=Ui,$i=Ui+-Ri,er=Gi+1;--er>0;){var tr=m[qi]-m[$i],ir=m[qi+-1]-m[$i+-1];m[qi]=m[qi]+m[$i],m[qi+-1]=m[qi+-1]+m[$i+-1],m[$i]=tr*Oi-ir*zi,m[$i+-1]=ir*Oi+tr*zi,tr=m[qi+-2]-m[$i+-2],ir=m[qi+-3]-m[$i+-3],m[qi+-2]=m[qi+-2]+m[$i+-2],m[qi+-3]=m[qi+-3]+m[$i+-3],m[$i+-2]=tr*Xi-ir*Ki,m[$i+-3]=ir*Xi+tr*Ki,tr=m[qi+-4]-m[$i+-4],ir=m[qi+-5]-m[$i+-5],m[qi+-4]=m[qi+-4]+m[$i+-4],m[qi+-5]=m[qi+-5]+m[$i+-5],m[$i+-4]=tr*ji-ir*Yi,m[$i+-5]=ir*ji+tr*Yi,tr=m[qi+-6]-m[$i+-6],ir=m[qi+-7]-m[$i+-7],m[qi+-6]=m[qi+-6]+m[$i+-6],m[qi+-7]=m[qi+-7]+m[$i+-7],m[$i+-6]=tr*Qi-ir*Ji,m[$i+-7]=ir*Qi+tr*Ji,qi-=Wi,$i-=Wi}Hi+=4*Mi,Ui-=8}for(var rr=l-1,nr=n[t>>3],ar=rr,sr=rr-16*(t>>5);ar>sr;){var or=m[ar],lr=m[ar+-8];m[ar+-8]=or-lr,m[ar]=or+lr,or=m[ar+-1],lr=m[ar+-9],m[ar+-9]=or-lr,m[ar+-1]=or+lr;var ur=(or=m[ar+-2])-(lr=m[ar+-10]);m[ar+-2]=or+lr;var hr=(or=m[ar+-3])-(lr=m[ar+-11]);m[ar+-3]=or+lr,m[ar+-10]=(ur+hr)*nr,m[ar+-11]=(hr-ur)*nr,or=m[ar+-4],ur=(lr=m[ar+-12])-or,m[ar+-4]=or+lr,hr=(or=m[ar+-5])-(lr=m[ar+-13]),m[ar+-5]=or+lr,m[ar+-12]=hr,m[ar+-13]=ur,or=m[ar+-6],ur=(lr=m[ar+-14])-or,m[ar+-6]=or+lr,hr=(or=m[ar+-7])-(lr=m[ar+-15]),m[ar+-7]=or+lr,m[ar+-14]=(ur+hr)*nr,m[ar+-15]=(ur-hr)*nr;var dr=m[ar],cr=m[ar+-4],fr=dr-cr,_r=dr+cr,gr=(dr=m[ar+-2])+(cr=m[ar+-6]),mr=dr-cr;m[ar]=_r+gr,m[ar+-2]=_r-gr;var pr=m[ar+-3]-m[ar+-7];m[ar+-4]=fr+pr,m[ar+-6]=fr-pr;var vr=(dr=m[ar+-1])-(cr=m[ar+-5]),br=dr+cr,wr=m[ar+-3]+m[ar+-7];m[ar+-1]=br+wr,m[ar+-3]=br-wr,m[ar+-5]=vr-mr,m[ar+-7]=vr+mr;var yr=ar-8,xr=m[yr],kr=m[yr+-4],Ir=xr-kr,Br=xr+kr,Sr=(xr=m[yr+-2])+(kr=m[yr+-6]),Ar=xr-kr;m[yr]=Br+Sr,m[yr+-2]=Br-Sr;var Tr=m[yr+-3]-m[yr+-7];m[yr+-4]=Ir+Tr,m[yr+-6]=Ir-Tr;var Nr=(xr=m[yr+-1])-(kr=m[yr+-5]),Cr=xr+kr,Dr=m[yr+-3]+m[yr+-7];m[yr+-1]=Cr+Dr,m[yr+-3]=Cr-Dr,m[yr+-5]=Nr-Ar,m[yr+-7]=Nr+Ar,ar-=16}for(var Er=0,Pr=u-4,Lr=l-4;Pr>=0;){var Vr=o[Er];p[Lr+3]=m[Vr],p[Lr+2]=m[Vr+1],p[Pr+3]=m[Vr+2],p[Pr+2]=m[Vr+3],Vr=o[Er+1],p[Lr+1]=m[Vr],p[Lr]=m[Vr+1],p[Pr+1]=m[Vr+2],p[Pr]=m[Vr+3],Pr-=4,Lr-=4,Er+=2}for(var Fr=0,Wr=0,Mr=l-4;Wr<Mr;){var Rr=p[Wr]-p[Mr+2],Gr=p[Wr+1]+p[Mr+3],Hr=s[Fr+1]*Rr+s[Fr]*Gr,Ur=s[Fr+1]*Gr-s[Fr]*Rr,Zr=p[Wr]+p[Mr+2],Or=p[Wr+1]-p[Mr+3];p[Wr]=Zr+Hr,p[Wr+1]=Or+Ur,p[Mr+2]=Zr-Hr,p[Mr+3]=Ur-Or,Rr=p[Wr+2]-p[Mr],Gr=p[Wr+3]+p[Mr+1],Hr=s[Fr+3]*Rr+s[Fr+2]*Gr,Ur=s[Fr+3]*Gr-s[Fr+2]*Rr,Zr=p[Wr+2]+p[Mr],Or=p[Wr+3]-p[Mr+1],p[Wr+2]=Zr+Hr,p[Wr+3]=Or+Ur,p[Mr]=Zr-Hr,p[Mr+1]=Ur-Or,Fr+=4,Wr+=4,Mr-=4}for(var zr=l-8,Xr=l-8,Kr=0,jr=l-4,Yr=l,Qr=t-4;Xr>=0;){var Jr=d[Xr+6]*a[zr+7]-d[Xr+7]*a[zr+6],qr=-d[Xr+6]*a[zr+6]-d[Xr+7]*a[zr+7];e[Kr]=Jr,e[jr+3]=-Jr,e[Yr]=qr,e[Qr+3]=qr;var $r=d[Xr+4]*a[zr+5]-d[Xr+5]*a[zr+4],en=-d[Xr+4]*a[zr+4]-d[Xr+5]*a[zr+5];e[Kr+1]=$r,e[jr+2]=-$r,e[Yr+1]=en,e[Qr+2]=en,Jr=d[Xr+2]*a[zr+3]-d[Xr+3]*a[zr+2],qr=-d[Xr+2]*a[zr+2]-d[Xr+3]*a[zr+3],e[Kr+2]=Jr,e[jr+1]=-Jr,e[Yr+2]=qr,e[Qr+1]=qr,$r=d[Xr]*a[zr+1]-d[Xr+1]*a[zr],en=-d[Xr]*a[zr]-d[Xr+1]*a[zr+1],e[Kr+3]=$r,e[jr]=-$r,e[Yr+3]=en,e[Qr]=en,zr-=8,Xr-=8,Kr+=4,Yr+=4,jr-=4,Qr-=4}},decodePacket:function(){var e=this.decodeInitial();return null==e?null:this.decodePacketRest(e)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var e,t=this.decodeState;if(0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,e=t.input.readByte()):e=-1,t.validBits=0,-1==e)break}}var i=this.header.modes.length-1,r=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=this.decodeState.readBits(i<16384?i<16?r[i]:i<512?5+r[i>>5]:10+r[i>>10]:i<16777216?i<524288?15+r[i>>15]:20+r[i>>20]:i<536870912?25+r[i>>25]:i<-2147483648?30+r[i>>30]:0);if(-1==n||n>=this.header.modes.length)throw new M(new Xe(Ke.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var a,s,o,l=this.header.modes[n];l.blockflag?(a=this.header.blocksize1,s=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(s=o=0,a=this.header.blocksize0);var u=a>>1;return{mode:n,left:l.blockflag&&0==s?{start:a-this.header.blocksize0>>2,end:a+this.header.blocksize0>>2}:{start:0,end:u},right:l.blockflag&&0==o?{start:3*a-this.header.blocksize0>>2,end:3*a+this.header.blocksize0>>2}:{start:u,end:a}}},decodePacketRest:function(e){for(var t=this.header.modes[e.mode],i=new Array(256),r=new Array(256),n=t.blockflag?this.header.blocksize1:this.header.blocksize0,a=this.header.mapping[t.mapping],s=n>>1,o=[256,128,86,64],l=this.header.codebooks,u=0,h=this.header.channel;u<h;){var d=u++,c=a.chan[d].mux;i[d]=!1;var f=this.header.floorConfig[a.submapFloor[c]];if(0==f.type)throw new M(new Xe(Ke.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var _=f.floor1;if(0!=this.decodeState.readBits(1)){var g=[],m=new Array(256),p=o[_.floor1Multiplier-1],v=2,b=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(g=this.finalY[d])[0]=this.decodeState.readBits((p<16384?p<16?b[p]:p<512?5+b[p>>5]:10+b[p>>10]:p<16777216?p<524288?15+b[p>>15]:20+b[p>>20]:p<536870912?25+b[p>>25]:p<-2147483648?30+b[p>>30]:0)-1);var w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];g[1]=this.decodeState.readBits((p<16384?p<16?w[p]:p<512?5+w[p>>5]:10+w[p>>10]:p<16777216?p<524288?15+w[p>>15]:20+w[p>>20]:p<536870912?25+w[p>>25]:p<-2147483648?30+w[p>>30]:0)-1);for(var y=0,x=_.partitions;y<x;){var k=y++,I=_.partitionClassList[k],B=_.classDimensions[I],S=_.classSubclasses[I],A=(1<<S)-1,T=0;if(0!=S){var N=l[_.classMasterbooks[I]],C=this.decodeState;C.validBits<10&&C.prepHuffman();var D,E=N.fastHuffman[1023&C.acc];if(E>=0){var P=N.codewordLengths[E];C.acc=C.acc>>>P,C.validBits-=P,C.validBits<0?(C.validBits=0,D=-1):D=E}else D=C.decodeScalarRaw(N);N.sparse&&(D=N.sortedValues[D]),T=D}for(var L=_.subclassBooks[I],V=0,F=B;V<F;){V++;var W=L[T&A];T>>=S;var R,G=v++;if(W>=0){var H=this.decodeState,U=l[W];H.validBits<10&&H.prepHuffman();var Z,O=U.fastHuffman[1023&H.acc];if(O>=0){var z=U.codewordLengths[O];H.acc=H.acc>>>z,H.validBits-=z,H.validBits<0?(H.validBits=0,Z=-1):Z=O}else Z=H.decodeScalarRaw(U);U.sparse&&(Z=U.sortedValues[Z]),R=Z}else R=0;g[G]=R}}if(-1==this.decodeState.validBits){i[d]=!0;continue}m[0]=m[1]=!0;for(var X=_.neighbors,K=_.xlist,j=2,Y=_.values;j<Y;){var Q=j++,J=X[Q][0],q=X[Q][1],$=K[J],ee=g[J],te=g[q]-ee,ie=K[q]-$,re=Math.abs(te)*(K[Q]-$)/ie|0,ne=te<0?ee-re:ee+re,ae=g[Q],se=p-ne,oe=se<ne?2*se:2*ne;0!=ae?(m[J]=m[q]=!0,m[Q]=!0,g[Q]=ae>=oe?se>ne?ae-ne+ne:ne-ae+se-1:0!=(1&ae)?ne-(ae+1>>1):ne+(ae>>1)):(m[Q]=!1,g[Q]=ne)}for(var le=0,ue=_.values;le<ue;){var he=le++;m[he]||(g[he]=-1)}}else i[d]=!0}for(var de=0,ce=this.header.channel;de<ce;){var fe=de++;r[fe]=i[fe]}for(var _e=0,ge=a.couplingSteps;_e<ge;){var me=_e++;i[a.chan[me].magnitude]&&i[a.chan[me].angle]||(i[a.chan[me].magnitude]=i[a.chan[me].angle]=!1)}for(var pe=0,ve=a.submaps;pe<ve;){for(var be=pe++,we=new Array(this.header.channel),ye=new Array(256),xe=0,ke=0,Ie=this.header.channel;ke<Ie;){var Be=ke++;a.chan[Be].mux==be&&(i[Be]?(ye[xe]=!0,we[xe]=null):(ye[xe]=!1,we[xe]=this.channelBuffers[Be]),++xe)}var Se=a.submapResidue[be];this.header.residueConfig[Se].decode(this.decodeState,this.header,we,xe,s,ye,this.channelBuffers)}for(var Ae=a.couplingSteps,Te=n>>1;--Ae>=0;)for(var Ne=this.channelBuffers[a.chan[Ae].magnitude],Ce=this.channelBuffers[a.chan[Ae].angle],De=0,Ee=Te;De<Ee;){var Pe,Le,Ve=De++;Ne[Ve]>0?Ce[Ve]>0?(Le=Ne[Ve],Pe=Ne[Ve]-Ce[Ve]):(Pe=Ne[Ve],Le=Ne[Ve]+Ce[Ve]):Ce[Ve]>0?(Le=Ne[Ve],Pe=Ne[Ve]+Ce[Ve]):(Pe=Ne[Ve],Le=Ne[Ve]-Ce[Ve]),Ne[Ve]=Le,Ce[Ve]=Pe}for(var Fe=0,We=this.header.channel;Fe<We;){var Me=Fe++;if(r[Me])for(var Re=0,Ge=Te;Re<Ge;){var He=Re++;this.channelBuffers[Me][He]=0}else a.doFloor(this.header.floorConfig,Me,n,this.channelBuffers[Me],this.finalY[Me],null)}for(var Ue=0,Ze=this.header.channel;Ue<Ze;){var Oe=Ue++;this.inverseMdct(this.channelBuffers[Oe],n,t.blockflag)}for(var ze=this.decodeState;0!=ze.bytesInSeg||!ze.lastSeg&&0!=ze.next();)ze.bytesInSeg--,ze.inputPosition+=1,ze.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,n,e)},__class__:Ee};var Pe=function(){};r["kha.audio2.ogg.vorbis.VorbisTools"]=Pe,Pe.__name__=!0,Pe.pointCompare=function(e,t){return e.x<t.x?-1:e.x>t.x?1:0},Pe.uintAsc=function(e,t){return m.gt(t,e)?-1:e==t?0:1},Pe.lookup1Values=function(e,t){var i=0|Math.exp(Math.log(e)/t);return(0|Math.pow(i+1,t))<=e&&++i,i},Pe.computeWindow=function(e,t){for(var i=e>>1,r=0,n=i;r<n;){var a=r++;t[a]=Math.sin(1.5707963267948966*Pe.square(Math.sin((a+.5)/i*.5*3.141592653589793)))}},Pe.square=function(e){return e*e},Pe.computeBitReverse=function(e,t){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],r=(e<16384?e<16?i[e]:e<512?5+i[e>>5]:10+i[e>>10]:e<16777216?e<524288?15+i[e>>15]:20+i[e>>20]:e<536870912?25+i[e>>25]:e<-2147483648?30+i[e>>30]:0)-1,n=0,a=e>>3;n<a;){var s=n++,o=s;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,t[s]=(o>>>16|o<<16)>>>32-r+3<<2}},Pe.computeTwiddleFactors=function(e,t,i,r){for(var n=e>>3,a=0,s=0,o=e>>2;s<o;){var l=s++;t[a]=Math.cos(4*l*3.141592653589793/e),t[a+1]=-Math.sin(4*l*3.141592653589793/e),i[a]=.5*Math.cos(3.141592653589793*(a+1)/e/2),i[a+1]=.5*Math.sin(3.141592653589793*(a+1)/e/2),a+=2}for(var u=0,h=0,d=n;h<d;){h++;r[u]=Math.cos(2*(u+1)*3.141592653589793/e),r[u+1]=-Math.sin(2*(u+1)*3.141592653589793/e),u+=2}},Pe.drawLine=function(e,t,i,r,n,a){if(null==Pe.integerDivideTable){var s=new Array(32);Pe.integerDivideTable=s;for(var o=0;o<32;){var l=o++,u=Pe.integerDivideTable,h=new Array(64);u[l]=h;for(var d=1;d<64;){var c=d++;Pe.integerDivideTable[l][c]=l/c|0}}}var f,_,g=n-i,m=r-t,p=g<0?-g:g,v=t,b=i,w=0;m<64&&p<32?_=g<0?(f=-Pe.integerDivideTable[p][m])-1:(f=Pe.integerDivideTable[p][m])+1:(f=g/m|0,_=g<0?f-1:f+1),p-=(f<0?-f:f)*m,r>a&&(r=a);var y=v,x=e;x[y]=x[y]*Pe.INVERSE_DB_TABLE[b];for(var k=v+1,I=r;k<I;){(w+=p)>=m?(w-=m,b+=_):b+=f;var B=k++,S=e;S[B]=S[B]*Pe.INVERSE_DB_TABLE[b]}};var Le=function(){};r["kha.audio2.ogg.vorbis.data.Codebook"]=Le,Le.__name__=!0,Le.read=function(e){var t=new Le;if(66!=e.readBits(8)||67!=e.readBits(8)||86!=e.readBits(8))throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=e.readBits(8);t.dimensions=(e.readBits(8)<<8)+i;var r=e.readBits(8),n=e.readBits(8);t.entries=(e.readBits(8)<<16)+(n<<8)+r;var a=e.readBits(1);t.sparse=0==a&&0!=e.readBits(1);var s=new Array(t.entries);t.sparse||(t.codewordLengths=s);var o,l=0;if(0!=a)for(var u=0,h=e.readBits(5)+1;u<t.entries;){var d=t.entries-u,c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],f=e.readBits(d<16384?d<16?c[d]:d<512?5+c[d>>5]:10+c[d>>10]:d<16777216?d<524288?15+c[d>>15]:20+c[d>>20]:d<536870912?25+c[d>>25]:d<-2147483648?30+c[d>>30]:0);if(u+f>t.entries)throw new M(new Xe(Ke.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var _=0,g=f;_<g;){s[u+_++]=h}u+=f,++h}else for(var p=0,v=t.entries;p<v;){var b=p++;0!=(t.sparse?e.readBits(1):1)?(s[b]=e.readBits(5)+1,++l):s[b]=255}if(t.sparse&&l>=t.entries>>2&&(t.codewordLengths=s,t.sparse=!1),t.sparse)o=l;else{for(var w=0,y=0,x=t.entries;y<x;){var k=s[y++];k>10&&255!=k&&++w}o=w}t.sortedEntries=o;var I=null;if(t.sparse){if(0!=t.sortedEntries){var B=new Array(t.sortedEntries);t.codewordLengths=B;var S=new Array(t.entries);t.codewords=S,I=new Array(t.entries)}t.entries,t.sortedEntries}else{var A=new Array(t.entries);t.codewords=A}if(!t.computeCodewords(s,t.entries,I))throw new M(new Xe(Ke.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=t.sortedEntries){t.sortedCodewords=[];var T=new Array(t.sortedEntries);t.sortedValues=T,t.computeSortedHuffman(s,I)}if(t.sparse&&(I=null,t.codewords=null,s=null),t.computeAcceleratedHuffman(),t.lookupType=e.readBits(4),t.lookupType>2)throw new M(new Xe(Ke.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(t.lookupType>0){var N=e.readBits(32),C=m.toFloat(2097151&N),D=(2145386496&N)>>>21,E=0!=(-2147483648&N)?-C:C;t.minimumValue=E*Math.pow(2,D-788);var P=e.readBits(32),L=m.toFloat(2097151&P),V=(2145386496&P)>>>21,F=0!=(-2147483648&P)?-L:L;t.deltaValue=F*Math.pow(2,V-788),t.valueBits=e.readBits(4)+1,t.sequenceP=0!=e.readBits(1),1==t.lookupType?t.lookupValues=Pe.lookup1Values(t.entries,t.dimensions):t.lookupValues=t.entries*t.dimensions;for(var W=new Array(t.lookupValues),R=0,G=t.lookupValues;R<G;){var H=R++,U=e.readBits(t.valueBits);if(-1==U)throw new M(new Xe(Ke.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));W[H]=U}var Z=new Array(t.lookupValues);t.multiplicands=Z;for(var O=0,z=t.lookupValues;O<z;){var X=O++;t.multiplicands[X]=W[X]*t.deltaValue+t.minimumValue}if(2==t.lookupType&&t.sequenceP){for(var K=1,j=t.lookupValues;K<j;){var Y=K++;t.multiplicands[Y]=t.multiplicands[Y-1]}t.sequenceP=!1}}return t},Le.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,computeCodewords:function(e,t,i){var r=new Array(32);r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=0,r[16]=0,r[17]=0,r[18]=0,r[19]=0,r[20]=0,r[21]=0,r[22]=0,r[23]=0,r[24]=0,r[25]=0,r[26]=0,r[27]=0,r[28]=0,r[29]=0,r[30]=0,r[31]=0;for(var n=0;n<t&&!(e[n]<255);)++n;if(n==t)return!0;var a=0,s=a++;this.sparse?(this.codewords[s]=0,this.codewordLengths[s]=e[n],i[s]=n):this.codewords[n]=0;for(var o=0;++o<=e[n];)r[o]=1<<32-o;for(o=n;++o<t;){var l=e[o];if(255!=l){for(;l>0&&0==r[l];)--l;if(0==l)return!1;var u=r[l];r[l]=0;var h=u,d=(h=(-16711936&(h=(-252645136&(h=(-858993460&(h=(-1431655766&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8)>>>16|h<<16,c=a++;if(this.sparse?(this.codewords[c]=d,this.codewordLengths[c]=e[o],i[c]=o):this.codewords[o]=d,l!=e[o])for(var f=e[o];f>l;)r[f]=u+(1<<32-f),--f}}return!0},computeSortedHuffman:function(e,t){if(this.sparse)for(var i=0,r=this.sortedEntries;i<r;){var n=i++,a=this.codewords[n];a=(-16711936&(a=(-252645136&(a=(-858993460&(a=(-1431655766&a)>>>1|(1431655765&a)<<1))>>>2|(858993459&a)<<2))>>>4|(252645135&a)<<4))>>>8|(16711935&a)<<8,this.sortedCodewords[n]=a>>>16|a<<16}else for(var s=0,o=0,l=this.entries;o<l;){var u=o++,h=e[u];if(this.sparse||255!=h&&h>10){var d=this.codewords[u];d=(-16711936&(d=(-252645136&(d=(-858993460&(d=(-1431655766&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,this.sortedCodewords[s++]=d>>>16|d<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Pe.uintAsc);for(var c=0,f=this.sparse?this.sortedEntries:this.entries;c<f;){var _=c++,g=this.sparse?e[t[_]]:e[_];if(this.sparse||255!=g&&g>10){for(var p=this.codewords[_],v=(p=(-16711936&(p=(-252645136&(p=(-858993460&(p=(-1431655766&p)>>>1|(1431655765&p)<<1))>>>2|(858993459&p)<<2))>>>4|(252645135&p)<<4))>>>8|(16711935&p)<<8)>>>16|p<<16,b=0,w=this.sortedEntries;w>1;){var y=b+(w>>1);m.gte(v,this.sortedCodewords[y])?(b=y,w-=w>>1):w>>=1}this.sparse?(this.sortedValues[b]=t[_],this.codewordLengths[b]=g):this.sortedValues[b]=_}}},computeAcceleratedHuffman:function(){var e=new Array(1024);this.fastHuffman=e,this.fastHuffman[0]=-1;for(var t=0;t<1024;){var i=t++;this.fastHuffman[i]=-1}for(var r=0,n=this.sparse?this.sortedEntries:this.entries;r<n;){var a=r++;if(this.codewordLengths[a]<=10){var s;if(this.sparse){var o=this.sortedCodewords[a];s=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else s=this.codewords[a];for(;s<1024;)this.fastHuffman[s]=a,s+=1<<this.codewordLengths[a]}}},codebookDecode:function(e,t,i,r){e.validBits<10&&e.prepHuffman();var n,a=this.fastHuffman[1023&e.acc];if(a>=0){var s=this.codewordLengths[a];e.acc=e.acc>>>s,e.validBits-=s,e.validBits<0?(e.validBits=0,n=-1):n=a}else n=e.decodeScalarRaw(this);this.sparse&&(n=this.sortedValues[n]);var o=n,l=this.lookupValues,u=this.sequenceP,h=this.multiplicands,d=this.minimumValue;if(o<0)return!1;if(r>this.dimensions&&(r=this.dimensions),1==this.lookupType){for(var c=1,f=0,_=0,g=r;_<g;){var p=_++,v=h[m.toFloat(o/c|0)%m.toFloat(l)|0]+f,b=i+p,w=t;w[b]=w[b]+v,u&&(f=v+d),c*=l}return!0}if(o*=this.dimensions,u)for(var y=0,x=0,k=r;x<k;){var I=x++,B=h[o+I]+y,S=i+I,A=t;A[S]=A[S]+B,y=B+d}else for(var T=0,N=r;T<N;){var C=T++,D=i+C,E=t;E[D]=E[D]+(h[o+C]+0)}return!0},codebookDecodeStep:function(e,t,i,r,n){e.validBits<10&&e.prepHuffman();var a,s=this.fastHuffman[1023&e.acc];if(s>=0){var o=this.codewordLengths[s];e.acc=e.acc>>>o,e.validBits-=o,e.validBits<0?(e.validBits=0,a=-1):a=s}else a=e.decodeScalarRaw(this);this.sparse&&(a=this.sortedValues[a]);var l=a,u=0;if(l<0)return!1;r>this.dimensions&&(r=this.dimensions);var h=this.lookupValues,d=this.sequenceP,c=this.multiplicands;if(1==this.lookupType){for(var f=1,_=0,g=r;_<g;){var p=_++,v=c[m.toFloat(l/f|0)%m.toFloat(h)|0]+u,b=i+p*n,w=t;w[b]=w[b]+v,d&&(u=v),f*=h}return!0}l*=this.dimensions;for(var y=0,x=r;y<x;){var k=y++,I=c[l+k]+u,B=i+k*n,S=t;S[B]=S[B]+I,d&&(u=I)}return!0},decodeDeinterleaveRepeat:function(e,t,i,r,n,a,s){var o=this.dimensions;if(0==this.lookupType)throw new M(new Xe(Ke.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,u=this.sequenceP,h=this.lookupValues;s>0;){var d=0;e.validBits<10&&e.prepHuffman();var c,f=this.fastHuffman[1023&e.acc];if(f>=0){var _=this.codewordLengths[f];e.acc=e.acc>>>_,e.validBits-=_,e.validBits<0?(e.validBits=0,c=-1):c=f}else c=e.decodeScalarRaw(this);this.sparse&&(c=this.sortedValues[c]);var g=c;if(g<0){if(0==e.bytesInSeg&&e.lastSeg)return null;throw new M(new Xe(Ke.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(r+n*i+o>a*i&&(o=a*i-(n*i-r)),1==this.lookupType){var p=1;if(u)for(var v=0,b=o;v<b;){v++;var w=l[m.toFloat(g/p|0)%m.toFloat(h)|0]+d,y=n,x=t[r];x[y]=x[y]+w,++r==i&&(r=0,++n),d=w,p*=h}else for(var k=0,I=o;k<I;){k++;var B=l[m.toFloat(g/p|0)%m.toFloat(h)|0]+d,S=n,A=t[r];A[S]=A[S]+B,++r==i&&(r=0,++n),p*=h}}else if(g*=this.dimensions,u)for(var T=0,N=o;T<N;){var C=l[g+T++]+d,D=n,E=t[r];E[D]=E[D]+C,++r==i&&(r=0,++n),d=C}else for(var P=0,L=o;P<L;){var V=l[g+P++]+d,F=n,W=t[r];W[F]=W[F]+V,++r==i&&(r=0,++n)}s-=o}return{cInter:r,pInter:n}},residueDecode:function(e,t,i,r,n){if(0==n)for(var a=r/this.dimensions|0,s=0,o=a;s<o;){var l=s++;if(!this.codebookDecodeStep(e,t,i+l,r-i-l,a))return!1}else for(var u=0;u<r;){if(!this.codebookDecode(e,t,i,r-u))return!1;u+=this.dimensions,i+=this.dimensions}return!0},__class__:Le};var Ve=function(){this.data=new T};r["kha.audio2.ogg.vorbis.data.Comment"]=Ve,Ve.__name__=!0,Ve.prototype={data:null,get_loopStart:function(){return f.parseInt(this.getString("loopstart"))},get_loopLength:function(){return f.parseInt(this.getString("looplength"))},add:function(e,t){e=e.toLowerCase();var i=this.data;if(null!=mi[e]?i.existsReserved(e):i.h.hasOwnProperty(e)){var r=this.data;(null!=mi[e]?r.getReserved(e):r.h[e]).push(t)}else{var n=[t],a=this.data;null!=mi[e]?a.setReserved(e,n):a.h[e]=n}},getString:function(e){e=e.toLowerCase();var t=this.data;if(null!=mi[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var i=this.data;return(null!=mi[e]?i.getReserved(e):i.h[e])[0]}return null},__class__:Ve};var Fe=function(){};r["kha.audio2.ogg.vorbis.data.Floor"]=Fe,Fe.__name__=!0,Fe.read=function(e,t){var i=new Fe;if(i.type=e.readBits(16),i.type>1)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var r=i.floor0=new We;r.order=e.readBits(8),r.rate=e.readBits(16),r.barkMapSize=e.readBits(16),r.amplitudeBits=e.readBits(6),r.amplitudeOffset=e.readBits(8),r.numberOfBooks=e.readBits(4)+1;for(var n=0,a=r.numberOfBooks;n<a;){var s=n++;r.bookList[s]=e.readBits(8)}throw new M(new Xe(Ke.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new Me,u=-1;l.partitions=e.readBits(5);var h=new Array(l.partitions);l.partitionClassList=h;for(var d=0,c=l.partitions;d<c;){var f=d++;l.partitionClassList[f]=e.readBits(4),l.partitionClassList[f]>u&&(u=l.partitionClassList[f])}var _=new Array(u+1);l.classDimensions=_;var g=new Array(u+1);l.classMasterbooks=g;var m=new Array(u+1);l.classSubclasses=m;var p=new Array(u+1);l.subclassBooks=p;for(var v=0,b=u+1;v<b;){var w=v++;if(l.classDimensions[w]=e.readBits(3)+1,l.classSubclasses[w]=e.readBits(2),0!=l.classSubclasses[w]&&(l.classMasterbooks[w]=e.readBits(8),l.classMasterbooks[w]>=t.length))throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var y=1<<l.classSubclasses[w],x=l.subclassBooks,k=new Array(y);x[w]=k;for(var I=0,B=y;I<B;){var S=I++;if(l.subclassBooks[w][S]=e.readBits(8)-1,l.subclassBooks[w][S]>=t.length)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=e.readBits(2)+1,l.rangebits=e.readBits(4);var A=new Array(250);l.xlist=A,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var T=0,N=l.partitions;T<N;)for(var C=T++,D=l.partitionClassList[C],E=0,P=l.classDimensions[D];E<P;){E++;l.xlist[l.values]=e.readBits(l.rangebits),l.values++}for(var L=0,V=l.values;L<V;){var F=L++;o.push(new Ge),o[F].x=l.xlist[F],o[F].y=F}o.sort(Pe.pointCompare);var W=new Array(l.values);l.sortedOrder=W;for(var R=0,G=l.values;R<G;){var H=R++;l.sortedOrder[H]=o[H].y}var U=new Array(l.values);l.neighbors=U;for(var Z=2,O=l.values;Z<O;){for(var z=Z++,X=l.xlist,K=-1,j=65536,Y=0,Q=0,J=0,q=z;J<q;){var $=J++;X[$]>K&&X[$]<X[z]&&(Y=$,K=X[$]),X[$]<j&&X[$]>X[z]&&(Q=$,j=X[$])}var ee=Y,te=Q,ie=l.neighbors,re=new Array(l.values);ie[z]=re,l.neighbors[z][0]=ee,l.neighbors[z][1]=te}return i},Fe.prototype={floor0:null,floor1:null,type:null,__class__:Fe};var We=function(){};r["kha.audio2.ogg.vorbis.data.Floor0"]=We,We.__name__=!0,We.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:We};var Me=function(){};r["kha.audio2.ogg.vorbis.data.Floor1"]=Me,Me.__name__=!0,Me.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Me};var Re=function(){};r["kha.audio2.ogg.vorbis.data.Header"]=Re,Re.__name__=!0,Re.read=function(e){var t=e.page;if(t.start(e),0==(2&t.flag))throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&t.flag))throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&t.flag))throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.firstPageValidate(),e.inputPosition+=1,1!=e.input.readByte())throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,r,n,a,s,o,l=new x(new ArrayBuffer(6));if(0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,i=e.input.readByte()):i=-1,e.validBits=0,l.b[0]=i,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,r=e.input.readByte()):r=-1,e.validBits=0,l.b[1]=r,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,n=e.input.readByte()):n=-1,e.validBits=0,l.b[2]=n,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,a=e.input.readByte()):a=-1,e.validBits=0,l.b[3]=a,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,s=e.input.readByte()):s=-1,e.validBits=0,l.b[4]=s,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,o=e.input.readByte()):o=-1,e.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new M(new Xe(Ke.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));e.inputPosition+=4;var u=e.input.readInt32();if(0!=u)throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"vorbis version : "+u,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var h=new Re;if(e.inputPosition+=1,h.channel=e.input.readByte(),0==h.channel)throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h.channel>16)throw new M(new Xe(Ke.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.inputPosition+=4,h.sampleRate=e.input.readInt32(),0==h.sampleRate)throw new M(new Xe(Ke.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=4,h.maximumBitRate=e.input.readInt32(),e.inputPosition+=4,h.nominalBitRate=e.input.readInt32(),e.inputPosition+=4,h.minimumBitRate=e.input.readInt32(),e.inputPosition+=1;var d=e.input.readByte(),c=15&d,f=d>>4;if(h.blocksize0=1<<c,h.blocksize1=1<<f,c<6||c>13)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(f<6||f>13)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(c>f)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=1;var _=e.input.readByte();if(0==(1&_))throw new M(new Xe(Ke.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.page.start(e),e.startPacket();for(var g=0,m=new P;0!=(g=e.next());)e.inputPosition+=g,m.write(e.input.read(g)),e.bytesInSeg=0;var p=new D(m.getBytes());p.readByte(),p.read(6);var v,b=p.readInt32();h.vendor=p.readString(b),h.comment=new Ve;for(var w=0,y=p.readInt32();w<y;){w++;var k=p.readInt32(),I=p.readString(k),B=I.indexOf("=");-1!=B&&h.comment.add(I.substring(0,B),I.substring(B+1))}if(0==(1&p.readByte()))throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.startPacket(),0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,v=e.input.readByte()):v=-1,e.validBits=0,5!=v)throw new M(new Xe(Ke.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var S,A,T,N,C,E,L=new x(new ArrayBuffer(6));if(0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,S=e.input.readByte()):S=-1,e.validBits=0,L.b[0]=S,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,A=e.input.readByte()):A=-1,e.validBits=0,L.b[1]=A,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,T=e.input.readByte()):T=-1,e.validBits=0,L.b[2]=T,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,N=e.input.readByte()):N=-1,e.validBits=0,L.b[3]=N,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,C=e.input.readByte()):C=-1,e.validBits=0,L.b[4]=C,0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,E=e.input.readByte()):E=-1,e.validBits=0,L.b[5]=E,"vorbis"!=L.toString())throw new M(new Xe(Ke.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var V=e.readBits(8)+1,F=new Array(V);h.codebooks=F;for(var W=0,R=V;W<R;){var G=W++;h.codebooks[G]=Le.read(e)}for(var H=0,U=_=e.readBits(6)+1;H<U;){H++;if(0!=e.readBits(16))throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var Z=e.readBits(6)+1,O=new Array(Z);h.floorConfig=O;for(var z=0,X=Z;z<X;){var K=z++;h.floorConfig[K]=Fe.read(e,h.codebooks)}var j=e.readBits(6)+1,Y=new Array(j);h.residueConfig=Y;for(var Q=0,J=j;Q<J;){var q=Q++;h.residueConfig[q]=je.read(e,h.codebooks)}var $=e.readBits(6)+1,ee=new Array($);h.mapping=ee;for(var te=0,ie=$;te<ie;){var re=te++,ne=He.read(e,h.channel);h.mapping[re]=ne;for(var ae=0,se=ne.submaps;ae<se;){var oe=ae++;if(ne.submapFloor[oe]>=h.floorConfig.length)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(ne.submapResidue[oe]>=h.residueConfig.length)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}}var le=e.readBits(6)+1,ue=new Array(le);h.modes=ue;for(var he=0,de=le;he<de;){var ce=he++,fe=Ze.read(e);if(h.modes[ce]=fe,fe.mapping>=h.mapping.length)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next();)e.bytesInSeg--,e.inputPosition+=1,e.input.readByte();return h},Re.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Re};var Ge=function(){};r["kha.audio2.ogg.vorbis.data.IntPoint"]=Ge,Ge.__name__=!0,Ge.prototype={x:null,y:null,__class__:Ge};var He=function(){};r["kha.audio2.ogg.vorbis.data.Mapping"]=He,He.__name__=!0,He.read=function(e,t){var i=new He,r=e.readBits(16);if(0!=r)throw new M(new Xe(Ke.INVALID_SETUP,"mapping type "+r,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var n=new Array(t);i.chan=n;for(var a=0,s=t;a<s;){var o=a++;i.chan[o]=new Ue}if(0!=e.readBits(1)?i.submaps=e.readBits(4)+1:i.submaps=1,0!=e.readBits(1)){i.couplingSteps=e.readBits(8)+1;for(var l=0,u=i.couplingSteps;l<u;){var h=l++,d=t-1,c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[h].magnitude=e.readBits(d<16384?d<16?c[d]:d<512?5+c[d>>5]:10+c[d>>10]:d<16777216?d<524288?15+c[d>>15]:20+c[d>>20]:d<536870912?25+c[d>>25]:d<-2147483648?30+c[d>>30]:0);var f=t-1,_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[h].angle=e.readBits(f<16384?f<16?_[f]:f<512?5+_[f>>5]:10+_[f>>10]:f<16777216?f<524288?15+_[f>>15]:20+_[f>>20]:f<536870912?25+_[f>>25]:f<-2147483648?30+_[f>>30]:0),i.chan[h].magnitude>=t)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].angle>=t)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].magnitude==i.chan[h].angle)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=e.readBits(2))throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.submaps>1)for(var g=0,m=t;g<m;){var p=g++;if(i.chan[p].mux=e.readBits(4),i.chan[p].mux>=i.submaps)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var v=0,b=t;v<b;){var w=v++;i.chan[w].mux=0}var y=new Array(i.submaps);i.submapFloor=y;var x=new Array(i.submaps);i.submapResidue=x;for(var k=0,I=i.submaps;k<I;){var B=k++;e.readBits(8),i.submapFloor[B]=e.readBits(8),i.submapResidue[B]=e.readBits(8)}return i},He.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(e,t,i,r,n,a){var s=i>>1,o=this.chan[t].mux,l=e[this.submapFloor[o]];if(0==l.type)throw new M(new Xe(Ke.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var u=l.floor1,h=0,d=n[0]*u.floor1Multiplier,c=1,f=u.values;c<f;){var _=c++,g=u.sortedOrder[_];if(n[g]>=0){var m=n[g]*u.floor1Multiplier,p=u.xlist[g];Pe.drawLine(r,h,d,p,m,s),h=p,d=m}}if(h<s)for(var v=h,b=s;v<b;){var w=v++,y=r;y[w]=y[w]*Pe.INVERSE_DB_TABLE[d]}},__class__:He};var Ue=function(){};r["kha.audio2.ogg.vorbis.data.MappingChannel"]=Ue,Ue.__name__=!0,Ue.prototype={magnitude:null,angle:null,mux:null,__class__:Ue};var Ze=function(){};r["kha.audio2.ogg.vorbis.data.Mode"]=Ze,Ze.__name__=!0,Ze.read=function(e){var t=new Ze;if(t.blockflag=0!=e.readBits(1),t.windowtype=e.readBits(16),t.transformtype=e.readBits(16),t.mapping=e.readBits(8),0!=t.windowtype)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=t.transformtype)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return t},Ze.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:Ze};var Oe=function(){};r["kha.audio2.ogg.vorbis.data.Page"]=Oe,Oe.__name__=!0,Oe.prototype={flag:null,clone:function(){var e=new Oe;return e.flag=this.flag,e},start:function(e){var t,i,r;if(e.inputPosition+=1,79==e.input.readByte()?(e.inputPosition+=1,r=103!=e.input.readByte()):r=!0,r?i=!0:(e.inputPosition+=1,i=103!=e.input.readByte()),i?t=!0:(e.inputPosition+=1,t=83!=e.input.readByte()),t)throw new M(new Xe(Ke.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(e)},startWithoutCapturePattern:function(e){e.inputPosition+=1;var t=e.input.readByte();if(0!=t)throw new M(new Xe(Ke.INVALID_STREAM_STRUCTURE_VERSION,""+t,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));e.inputPosition+=1,this.flag=e.input.readByte(),e.inputPosition+=4;var i=e.input.readInt32();e.inputPosition+=4;var r=e.input.readInt32();e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.setup(i,r)},__class__:Oe};var ze=function(){};r["kha.audio2.ogg.vorbis.data.ProbedPage"]=ze,ze.__name__=!0,ze.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:ze};var Xe=function(e,t,i){null==t&&(t=""),this.type=e,this.message=t,this.posInfos=i};r["kha.audio2.ogg.vorbis.data.ReaderError"]=Xe,Xe.__name__=!0,Xe.prototype={type:null,message:null,posInfos:null,__class__:Xe};var Ke=a["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n}},je=function(){};r["kha.audio2.ogg.vorbis.data.Residue"]=je,je.__name__=!0,je.read=function(e,t){var i=new je;if(i.type=e.readBits(16),i.type>2)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var r=new Array(64);i.begin=e.readBits(24),i.end=e.readBits(24),i.partSize=e.readBits(24)+1;var n=i.classifications=e.readBits(6)+1;i.classbook=e.readBits(8);for(var a=0,s=i.classifications;a<s;){var o=a++,l=0,u=e.readBits(3);0!=e.readBits(1)&&(l=e.readBits(5)),r[o]=8*l+u}var h=new Array(i.classifications);i.residueBooks=h;for(var d=0,c=i.classifications;d<c;){var f=d++,_=i.residueBooks,g=new Array(8);_[f]=g;for(var m=0;m<8;){var p=m++;if(0!=(r[f]&1<<p)){if(i.residueBooks[f][p]=e.readBits(8),i.residueBooks[f][p]>=t.length)throw new M(new Xe(Ke.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[f][p]=-1}}var v=t[i.classbook].entries,b=t[i.classbook].dimensions,w=new Array(v);i.classdata=w;for(var y=0,x=v;y<x;)for(var k=y++,I=k,B=b,S=i.classdata,A=new Array(b),T=S[k]=A;--B>=0;)T[B]=I%n,I=I/n|0;return i},je.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(e,t,i,r,n,a,s){for(var o=t.codebooks,l=o[this.classbook].dimensions,u=this.end-this.begin,h=this.partSize,d=m.toFloat(u)/m.toFloat(h)|0,c=new Array(t.channel*d+1),f=0,_=r;f<_;){var g=f++;if(!a[g])for(var p=i[g],v=0,b=p.length;v<b;){p[v++]=0}}if(2!=this.type||1==r)for(var w=0;w<8;)for(var y=w++,x=0;x<d;){if(0==y)for(var k=0,I=r;k<I;){var B=k++;if(!a[B]){var S=o[this.classbook];e.validBits<10&&e.prepHuffman();var A,T=S.fastHuffman[1023&e.acc];if(T>=0){var N=S.codewordLengths[T];e.acc=e.acc>>>N,e.validBits-=N,e.validBits<0?(e.validBits=0,A=-1):A=T}else A=e.decodeScalarRaw(S);S.sparse&&(A=S.sortedValues[A]);var C=A;if(-1==C)return;for(var D=l;--D>=0;)c[B*d+D+x]=C%this.classifications,C=C/this.classifications|0}}for(var E=0,P=l;E<P;){E++;if(x>=d)break;for(var L=0,V=r;L<V;){var F=L++;if(!a[F]){var W=c[F*d+x],M=this.residueBooks[W][y];if(M>=0){var R=i[F],G=this.begin+x*h,H=h;if(!o[M].residueDecode(e,R,G,H,this.type))return}}}++x}}else{for(var U=0,Z=r;U<Z;){var O=U++;if(!a[O])break;if(O==r-1)return}for(var z=0;z<8;){var X=z++,K=0;if(2==r)for(;K<d;){var j=this.begin+K*h,Y=1&j,Q=j>>>1;if(0==X){var J=o[this.classbook];e.validBits<10&&e.prepHuffman();var q,$=J.fastHuffman[1023&e.acc];if($>=0){var ee=J.codewordLengths[$];e.acc=e.acc>>>ee,e.validBits-=ee,e.validBits<0?(e.validBits=0,q=-1):q=$}else q=e.decodeScalarRaw(J);J.sparse&&(q=J.sortedValues[q]);var te=q;if(-1==te)return;for(var ie=l;--ie>=0;)c[ie+K]=te%this.classifications,te=te/this.classifications|0}for(var re=0,ne=l;re<ne;){re++;if(K>=d)break;var ae=this.begin+K*h,se=c[K],oe=this.residueBooks[se][X];if(oe>=0){var le=o[oe].decodeDeinterleaveRepeat(e,i,r,Y,Q,n,h);if(null==le)return;Y=le.cInter,Q=le.pInter}else Y=1&(ae+=h),Q=ae>>>1;++K}}else if(1==r)for(;K<d;){var ue=0,he=this.begin+K*h;if(0==X){var de=o[this.classbook];e.validBits<10&&e.prepHuffman();var ce,fe=de.fastHuffman[1023&e.acc];if(fe>=0){var _e=de.codewordLengths[fe];e.acc=e.acc>>>_e,e.validBits-=_e,e.validBits<0?(e.validBits=0,ce=-1):ce=fe}else ce=e.decodeScalarRaw(de);de.sparse&&(ce=de.sortedValues[ce]);var ge=ce;if(-1==ge)return;for(var me=l;--me>=0;)c[me+K]=ge%this.classifications,ge=ge/this.classifications|0}for(var pe=0,ve=l;pe<ve;){pe++;if(K>=d)break;var be=this.begin+K*h,we=this.residueBooks[c[K]][X];if(we>=0){var ye=o[we].decodeDeinterleaveRepeat(e,i,r,ue,he,n,h);if(null==ye)return;ue=ye.cInter,he=ye.pInter}else ue=0,he=be+=h;++K}}else for(;K<d;){var xe=this.begin+K*h,ke=m.toFloat(xe)%m.toFloat(r)|0,Ie=m.toFloat(xe)/m.toFloat(r)|0;if(0==X){var Be=o[this.classbook];e.validBits<10&&e.prepHuffman();var Se,Ae=Be.fastHuffman[1023&e.acc];if(Ae>=0){var Te=Be.codewordLengths[Ae];e.acc=e.acc>>>Te,e.validBits-=Te,e.validBits<0?(e.validBits=0,Se=-1):Se=Ae}else Se=e.decodeScalarRaw(Be);Be.sparse&&(Se=Be.sortedValues[Se]);var Ne=Se;if(-1==Ne)return;for(var Ce=l;--Ce>=0;)c[Ce+K]=Ne%this.classifications,Ne=Ne/this.classifications|0}for(var De=0,Ee=l;De<Ee;){De++;if(K>=d)break;var Pe=this.begin+K*h,Le=this.residueBooks[c[K]][X];if(Le>=0){var Ve=o[Le].decodeDeinterleaveRepeat(e,i,r,ke,Ie,n,h);if(null==Ve)return;ke=Ve.cInter,Ie=Ve.pInter}else Pe+=h,ke=m.toFloat(Pe)%m.toFloat(r)|0,Ie=m.toFloat(Pe)/m.toFloat(r)|0;++K}}}}},__class__:je};var Ye=function(){};r["kha.graphics1.Graphics"]=Ye,Ye.__name__=!0,Ye.__isInterface__=!0;var Qe=function(){this.transformations=[new ii(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};r["kha.graphics2.Graphics"]=Qe,Qe.__name__=!0,Qe.prototype={begin:function(e,t){null==e&&(e=!0)},end:function(){},drawImage:function(e,t,i){this.drawSubImage(e,t,i,0,0,e.get_width(),e.get_height())},drawSubImage:function(e,t,i,r,n,a,s){this.drawScaledSubImage(e,r,n,a,s,t,i,a,s)},drawScaledImage:function(e,t,i,r,n){this.drawScaledSubImage(e,0,0,e.get_width(),e.get_height(),t,i,r,n)},drawScaledSubImage:function(e,t,i,r,n,a,s,o,l){},drawRect:function(e,t,i,r,n){null==n&&(n=1)},drawString:function(e,t,i){},set_color:function(e){return-16777216},set_font:function(e){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(e){return this.myFontSize=e},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(e){return this.setOpacity(e),this.opacities[this.opacities.length-1]=e},pipe:null,transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(e){},setOpacity:function(e){},__class__:Qe};var Je=function(e){this.canvas=e};r["kha.graphics2.Graphics1"]=Je,Je.__name__=!0,Je.__interfaces__=[Ye],Je.prototype={canvas:null,__class__:Je};var qe=function(){};r["kha.graphics2.truetype.VectorOfIntPointer"]=qe,qe.__name__=!0,qe.prototype={value:null,__class__:qe};var $e=function(){};r["kha.graphics2.truetype.Stbtt_temp_rect"]=$e,$e.__name__=!0,$e.prototype={x0:null,y0:null,x1:null,y1:null,__class__:$e};var et=function(){};r["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=et,et.__name__=!0,et.prototype={advanceWidth:null,leftSideBearing:null,__class__:et};var tt=function(){};r["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=tt,tt.__name__=!0,tt.prototype={ascent:null,descent:null,lineGap:null,__class__:tt};var it=function(){};r["kha.graphics2.truetype.Stbtt_bakedchar"]=it,it.__name__=!0,it.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:it};var rt=function(){};r["kha.graphics2.truetype.Stbtt_fontinfo"]=rt,rt.__name__=!0,rt.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:rt};var nt=function(){};r["kha.graphics2.truetype.Stbtt_vertex"]=nt,nt.__name__=!0,nt.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:nt};var at=function(){};r["kha.graphics2.truetype.Stbtt__bitmap"]=at,at.__name__=!0,at.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:at};var st=function(){};r["kha.graphics2.truetype.Stbtt__edge"]=st,st.__name__=!0,st.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:st};var ot=function(){};r["kha.graphics2.truetype.Stbtt__active_edge"]=ot,ot.__name__=!0,ot.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:ot};var lt=function(){};r["kha.graphics2.truetype.Stbtt__point"]=lt,lt.__name__=!0,lt.prototype={x:null,y:null,__class__:lt};var ut=function(){};r["kha.graphics2.truetype.StbTruetype"]=ut,ut.__name__=!0,ut.stbtt__find_table=function(e,t,i){var r=t+4;null==r&&(r=0);for(var n=e.readU8(r),a=t+12,s=0,o=e.readU8(r+1)|n<<8;s<o;){var l=a+16*s++,h=u.cca(i,0),d=u.cca(i,1),c=u.cca(i,2),f=u.cca(i,3);if(e.readU8(l)==h&&e.readU8(l+1)==d&&e.readU8(l+2)==c&&e.readU8(l+3)==f){var _=l+8;null==_&&(_=0);var g=_;null==g&&(g=0);var m=e.readU8(g),p=e.readU8(g+1),v=e.readU8(g+2);return e.readU8(g+3)|v<<8|p<<16|m<<24}}return 0},ut.stbtt_InitFont=function(e,t,i){e.data=t,e.fontstart=i;var r=ut.stbtt__find_table(t,i,"cmap");if(e.loca=ut.stbtt__find_table(t,i,"loca"),e.head=ut.stbtt__find_table(t,i,"head"),e.glyf=ut.stbtt__find_table(t,i,"glyf"),e.hhea=ut.stbtt__find_table(t,i,"hhea"),e.hmtx=ut.stbtt__find_table(t,i,"hmtx"),e.kern=ut.stbtt__find_table(t,i,"kern"),0==r||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;var n=ut.stbtt__find_table(t,i,"maxp");if(0!=n){var a=n+4;null==a&&(a=0);var s=t.readU8(a),o=t.readU8(a+1);e.numGlyphs=o|s<<8}else e.numGlyphs=65535;var l=r+2;null==l&&(l=0);var u=t.readU8(l),h=t.readU8(l+1)|u<<8;e.index_map=0;for(var d=0,c=h;d<c;){var f=r+4+8*d++,_=f;null==_&&(_=0);var g=t.readU8(_);switch(t.readU8(_+1)|g<<8){case 0:var m=f+4;null==m&&(m=0);var p=m;null==p&&(p=0);var v=t.readU8(p),b=t.readU8(p+1),w=t.readU8(p+2),y=t.readU8(p+3);e.index_map=r+(y|w<<8|b<<16|v<<24);break;case 3:var x=f+2;null==x&&(x=0);var k=t.readU8(x);switch(t.readU8(x+1)|k<<8){case 1:case 10:var I=f+4;null==I&&(I=0);var B=I;null==B&&(B=0);var S=t.readU8(B),A=t.readU8(B+1),T=t.readU8(B+2),N=t.readU8(B+3);e.index_map=r+(N|T<<8|A<<16|S<<24)}}}if(0==e.index_map)return!1;var C=e.head+50;null==C&&(C=0);var D=t.readU8(C),E=t.readU8(C+1);return e.indexToLocFormat=E|D<<8,!0},ut.stbtt_FindGlyphIndex=function(e,t){var i=e.data,r=e.index_map,n=r;null==n&&(n=0);var a=i.readU8(n),s=i.readU8(n+1)|a<<8;if(0==s){var o=r+2;null==o&&(o=0);var l=i.readU8(o);if(t<(i.readU8(o+1)|l<<8)-6){var u=r+6+t;return null==u&&(u=0),i.readU8(u)}return 0}if(6==s){var h=r+6;null==h&&(h=0);var d=i.readU8(h),c=i.readU8(h+1)|d<<8,f=r+8;null==f&&(f=0);var _=i.readU8(f),g=i.readU8(f+1);if(t>=c&&t<c+(g|_<<8)){var m=r+10+2*(t-c);null==m&&(m=0);var p=i.readU8(m);return i.readU8(m+1)|p<<8}return 0}if(2==s)throw new M("Error");if(4==s){var v=r+6;null==v&&(v=0);var b=i.readU8(v),w=(i.readU8(v+1)|b<<8)>>1,y=r+8;null==y&&(y=0);var x=i.readU8(y),k=(i.readU8(y+1)|x<<8)>>1,I=r+10;null==I&&(I=0);var B=i.readU8(I),S=i.readU8(I+1)|B<<8,A=r+12;null==A&&(A=0);var T=i.readU8(A),N=(i.readU8(A+1)|T<<8)>>1,C=r+14,D=C;if(t>65535)return 0;var E=D+2*N;null==E&&(E=0);var P=i.readU8(E);for(t>=(i.readU8(E+1)|P<<8)&&(D+=2*N),D-=2;0!=S;){var L=D+2*(k>>=1);null==L&&(L=0);var V=i.readU8(L);t>(i.readU8(L+1)|V<<8)&&(D+=2*k),--S}var F=(D+=2)-C>>1,W=C+2*F;null==W&&(W=0);var R=i.readU8(W);if(t>(i.readU8(W+1)|R<<8))throw new M("Error");var G=r+14+2*w+2+2*F;null==G&&(G=0);var H=i.readU8(G),U=i.readU8(G+1)|H<<8;if(t<U)return 0;var Z=r+14+6*w+2+2*F;null==Z&&(Z=0);var O=i.readU8(Z),z=i.readU8(Z+1)|O<<8;if(0==z){var X=r+14+4*w+2+2*F;null==X&&(X=0);var K=i.readU8(X),j=i.readU8(X+1)|K<<8;return t+(0!=(32768&j)?j-65536:j)}var Y=z+2*(t-U)+r+14+6*w+2+2*F;null==Y&&(Y=0);var Q=i.readU8(Y);return i.readU8(Y+1)|Q<<8}if(12==s||13==s){var J=r+12;null==J&&(J=0);var q=J;null==q&&(q=0);for(var $=i.readU8(q),ee=i.readU8(q+1),te=i.readU8(q+2),ie=0,re=i.readU8(q+3)|te<<8|ee<<16|$<<24;ie<re;){var ne=ie+(re-ie>>1),ae=r+16+12*ne;null==ae&&(ae=0);var se=ae;null==se&&(se=0);var oe=i.readU8(se),le=i.readU8(se+1),ue=i.readU8(se+2),he=i.readU8(se+3)|ue<<8|le<<16|oe<<24,de=r+16+12*ne+4;null==de&&(de=0);var ce=de;null==ce&&(ce=0);var fe=i.readU8(ce),_e=i.readU8(ce+1),ge=i.readU8(ce+2),me=i.readU8(ce+3);if(t<he)re=ne;else{if(!(t>(me|ge<<8|_e<<16|fe<<24))){var pe=r+16+12*ne+8;null==pe&&(pe=0);var ve=pe;null==ve&&(ve=0);var be=i.readU8(ve),we=i.readU8(ve+1),ye=i.readU8(ve+2),xe=i.readU8(ve+3)|ye<<8|we<<16|be<<24;return 12==s?xe+t-he:xe}ie=ne+1}}return 0}throw new M("Error")},ut.stbtt_setvertex=function(e,t,i,r,n,a){e.type=t,e.x=i,e.y=r,e.cx=n,e.cy=a},ut.stbtt__GetGlyfOffset=function(e,t){var i,r;if(t>=e.numGlyphs)return-1;if(e.indexToLocFormat>=2)return-1;if(0==e.indexToLocFormat){var n=e.glyf,a=e.data,s=e.loca+2*t;null==s&&(s=0);var o=a.readU8(s);i=n+2*(a.readU8(s+1)|o<<8);var l=e.glyf,u=e.data,h=e.loca+2*t+2;null==h&&(h=0);var d=u.readU8(h);r=l+2*(u.readU8(h+1)|d<<8)}else{var c=e.glyf,f=e.data,_=e.loca+4*t;null==_&&(_=0);var g=_;null==g&&(g=0);var m=f.readU8(g),p=f.readU8(g+1),v=f.readU8(g+2);i=c+(f.readU8(g+3)|v<<8|p<<16|m<<24);var b=e.glyf,w=e.data,y=e.loca+4*t+4;null==y&&(y=0);var x=y;null==x&&(x=0);var k=w.readU8(x),I=w.readU8(x+1),B=w.readU8(x+2);r=b+(w.readU8(x+3)|B<<8|I<<16|k<<24)}return i==r?-1:i},ut.stbtt_GetGlyphBox=function(e,t,i){var r=ut.stbtt__GetGlyfOffset(e,t);if(r<0)return!1;var n=e.data,a=r+2;null==a&&(a=0);var s=n.readU8(a),o=n.readU8(a+1)|s<<8;i.x0=0!=(32768&o)?o-65536:o;var l=e.data,u=r+4;null==u&&(u=0);var h=l.readU8(u),d=l.readU8(u+1)|h<<8;i.y0=0!=(32768&d)?d-65536:d;var c=e.data,f=r+6;null==f&&(f=0);var _=c.readU8(f),g=c.readU8(f+1)|_<<8;i.x1=0!=(32768&g)?g-65536:g;var m=e.data,p=r+8;null==p&&(p=0);var v=m.readU8(p),b=m.readU8(p+1)|v<<8;return i.y1=0!=(32768&b)?b-65536:b,!0},ut.stbtt__close_shape=function(e,t,i,r,n,a,s,o,l,u){return r?(i&&ut.stbtt_setvertex(e[t++],3,l+s>>1,u+o>>1,l,u),ut.stbtt_setvertex(e[t++],3,n,a,s,o)):i?ut.stbtt_setvertex(e[t++],3,n,a,l,u):ut.stbtt_setvertex(e[t++],2,n,a,0,0),t},ut.copyVertices=function(e,t,i,r){for(var n=0,a=r;n<a;){var s=n++;t[i+s]=e[s]}},ut.stbtt_GetGlyphShape=function(e,t){var i=e.data,r=null,n=0,a=ut.stbtt__GetGlyfOffset(e,t);if(a<0)return null;var s=a;null==s&&(s=0);var o=i.readU8(s),l=i.readU8(s+1)|o<<8,u=0!=(32768&l)?l-65536:l;if(u>0){var h,d=0,c=0,f=0,_=!1,g=!1,m=a+10,p=m+2*u;null==p&&(p=0);var v=i.readU8(p),b=m+2*u+2+(i.readU8(p+1)|v<<8),w=m+2*u-2;null==w&&(w=0);var y=i.readU8(w),x=1+(i.readU8(w+1)|y<<8),k=x+2*u;if(null==(r=new Array(k)))return null;for(var I=0,B=r.length;I<B;){r[I++]=new nt}f=0;var S=0;h=k-x;for(var A=0,T=x;A<T;){var N=A++;0==S?0!=(8&(d=i.readU8(b++)))&&(S=i.readU8(b++)):--S,r[h+N].type=d}for(var C=0,D=0,E=x;D<E;){var P=D++;if(0!=(2&(d=r[h+P].type))){var L=i.readU8(b++);C+=0!=(16&d)?L:-L}else if(0==(16&d)){var V=i.readU8(b),F=i.readU8(b+1)|V<<8;C+=0!=(32768&F)?F-65536:F,b+=2}r[h+P].x=C}for(var W=0,R=0,G=x;R<G;){var H=R++;if(0!=(4&(d=r[h+H].type))){var U=i.readU8(b++);W+=0!=(32&d)?U:-U}else if(0==(32&d)){var Z=i.readU8(b),O=i.readU8(b+1)|Z<<8;W+=0!=(32768&O)?O-65536:O,b+=2}r[h+H].y=W}n=0;for(var z=0,X=z,K=X,j=K,Y=j,Q=Y,J=0;J<x;){if(d=r[h+J].type,C=r[h+J].x,W=r[h+J].y,f==J){0!=J&&(n=ut.stbtt__close_shape(r,n,_,g,Q,Y,X,z,j,K)),(g=0==(1&d))?(X=C,z=W,0==(1&r[h+J+1].type)?(Q=C+r[h+J+1].x>>1,Y=W+r[h+J+1].y>>1):(Q=r[h+J+1].x,Y=r[h+J+1].y,++J)):(Q=C,Y=W),ut.stbtt_setvertex(r[n++],1,Q,Y,0,0),_=!1;var q=m+2*c;null==q&&(q=0);var $=i.readU8(q);f=1+(i.readU8(q+1)|$<<8),++c}else 0==(1&d)?(_&&ut.stbtt_setvertex(r[n++],3,j+C>>1,K+W>>1,j,K),j=C,K=W,_=!0):(_?ut.stbtt_setvertex(r[n++],3,C,W,j,K):ut.stbtt_setvertex(r[n++],2,C,W,0,0),_=!1);++J}n=ut.stbtt__close_shape(r,n,_,g,Q,Y,X,z,j,K)}else if(-1==u){var ee=1,te=a+10;for(n=0,r=null;0!=ee;){var ie,re,ne=null,ae=1,se=0,oe=0,le=1,ue=0,he=0,de=te;null==de&&(de=0);var ce=i.readU8(de),fe=i.readU8(de+1)|ce<<8,_e=0!=(32768&fe)?fe-65536:fe,ge=te+=2;null==ge&&(ge=0);var me=i.readU8(ge),pe=i.readU8(ge+1)|me<<8,ve=0!=(32768&pe)?pe-65536:pe;if(te+=2,0==(2&_e))throw new M("Error");if(0!=(1&_e)){var be=te;null==be&&(be=0);var we=i.readU8(be),ye=i.readU8(be+1)|we<<8;ue=0!=(32768&ye)?ye-65536:ye;var xe=te+=2;null==xe&&(xe=0);var ke=i.readU8(xe),Ie=i.readU8(xe+1)|ke<<8;he=0!=(32768&Ie)?Ie-65536:Ie,te+=2}else{var Be=te;null==Be&&(Be=0);var Se=i.readU8(Be);ue=Se>=128?Se-256:Se;var Ae=++te;null==Ae&&(Ae=0);var Te=i.readU8(Ae);he=Te>=128?Te-256:Te,++te}if(0!=(8&_e)){var Ne=te;null==Ne&&(Ne=0);var Ce=i.readU8(Ne),De=i.readU8(Ne+1)|Ce<<8;ae=le=(0!=(32768&De)?De-65536:De)/16384,te+=2,se=oe=0}else if(0!=(64&_e)){var Ee=te;null==Ee&&(Ee=0);var Pe=i.readU8(Ee),Le=i.readU8(Ee+1)|Pe<<8;ae=(0!=(32768&Le)?Le-65536:Le)/16384,se=oe=0;var Ve=te+=2;null==Ve&&(Ve=0);var Fe=i.readU8(Ve),We=i.readU8(Ve+1)|Fe<<8;le=(0!=(32768&We)?We-65536:We)/16384,te+=2}else if(0!=(128&_e)){var Me=te;null==Me&&(Me=0);var Re=i.readU8(Me),Ge=i.readU8(Me+1)|Re<<8;ae=(0!=(32768&Ge)?Ge-65536:Ge)/16384;var He=te+=2;null==He&&(He=0);var Ue=i.readU8(He),Ze=i.readU8(He+1)|Ue<<8;se=(0!=(32768&Ze)?Ze-65536:Ze)/16384;var Oe=te+=2;null==Oe&&(Oe=0);var ze=i.readU8(Oe),Xe=i.readU8(Oe+1)|ze<<8;oe=(0!=(32768&Xe)?Xe-65536:Xe)/16384;var Ke=te+=2;null==Ke&&(Ke=0);var je=i.readU8(Ke),Ye=i.readU8(Ke+1)|je<<8;le=(0!=(32768&Ye)?Ye-65536:Ye)/16384,te+=2}var Qe=Math.sqrt(ae*ae+se*se),Je=Math.sqrt(oe*oe+le*le);if((ie=null==(re=ut.stbtt_GetGlyphShape(e,ve))?0:re.length)>0){for(var qe=0,$e=ie;qe<$e;){var et=re[qe++],tt=et.x,it=et.y;et.x=Qe*(ae*tt+oe*it+ue)|0,et.y=Je*(se*tt+le*it+he)|0,tt=et.cx,it=et.cy,et.cx=Qe*(ae*tt+oe*it+ue)|0,et.cy=Je*(se*tt+le*it+he)|0}if(null==(ne=new Array(n+ie)))return null;n>0&&ut.copyVertices(r,ne,0,n),ut.copyVertices(re,ne,n,ie),r=ne,n+=ie}ee=32&_e}}else if(u<0)throw new M("Error");if(null==r)return null;if(r.length<n)throw new M("Error");if(n<r.length){var rt=new Array(n);return ut.copyVertices(r,rt,0,n),rt}return r},ut.stbtt_GetGlyphHMetrics=function(e,t){var i=e.data,r=e.hhea+34;null==r&&(r=0);var n=i.readU8(r),a=i.readU8(r+1)|n<<8,s=new et;if(t<a){var o=e.data,l=e.hmtx+4*t;null==l&&(l=0);var u=o.readU8(l),h=o.readU8(l+1)|u<<8;s.advanceWidth=0!=(32768&h)?h-65536:h;var d=e.data,c=e.hmtx+4*t+2;null==c&&(c=0);var f=d.readU8(c),_=d.readU8(c+1)|f<<8;s.leftSideBearing=0!=(32768&_)?_-65536:_}else{var g=e.data,m=e.hmtx+4*(a-1);null==m&&(m=0);var p=g.readU8(m),v=g.readU8(m+1)|p<<8;s.advanceWidth=0!=(32768&v)?v-65536:v;var b=e.data,w=e.hmtx+4*a+2*(t-a);null==w&&(w=0);var y=b.readU8(w),x=b.readU8(w+1)|y<<8;s.leftSideBearing=0!=(32768&x)?x-65536:x}return s},ut.stbtt_GetFontVMetrics=function(e){var t=new tt,i=e.data,r=e.hhea+4;null==r&&(r=0);var n=i.readU8(r),a=i.readU8(r+1)|n<<8;t.ascent=0!=(32768&a)?a-65536:a;var s=e.data,o=e.hhea+6;null==o&&(o=0);var l=s.readU8(o),u=s.readU8(o+1)|l<<8;t.descent=0!=(32768&u)?u-65536:u;var h=e.data,d=e.hhea+8;null==d&&(d=0);var c=h.readU8(d),f=h.readU8(d+1)|c<<8;return t.lineGap=0!=(32768&f)?f-65536:f,t},ut.stbtt_ScaleForPixelHeight=function(e,t){var i=e.data,r=e.hhea+4;null==r&&(r=0);var n=i.readU8(r),a=i.readU8(r+1)|n<<8,s=e.data,o=e.hhea+6;null==o&&(o=0);var l=s.readU8(o),u=s.readU8(o+1)|l<<8;return t/((0!=(32768&a)?a-65536:a)-(0!=(32768&u)?u-65536:u))},ut.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,i,r,n,a){var s=new $e;if(ut.stbtt_GetGlyphBox(e,t,s)){var o=s.x0,l=s.x1,u=s.y0,h=s.y1;s.x0=Math.floor(o*i+n),s.y0=Math.floor(-h*r+a),s.x1=Math.ceil(l*i+n),s.y1=Math.ceil(-u*r+a)}else s.x0=0,s.y0=0,s.x1=0,s.y1=0;return s},ut.stbtt_GetGlyphBitmapBox=function(e,t,i,r){return ut.stbtt_GetGlyphBitmapBoxSubpixel(e,t,i,r,0,0)},ut.stbtt__new_active=function(e,t,i,r){var n=new ot,a=(e[t].x1-e[t].x0)/(e[t].y1-e[t].y0);return null==n?n:(n.fdx=a,n.fdy=0!=a?1/a:0,n.fx=e[t].x0+a*(r-e[t].y0),n.fx-=i,n.direction=e[t].invert?1:-1,n.sy=e[t].y0,n.ey=e[t].y1,n.next=null,n)},ut.stbtt__handle_clipped_edge=function(e,t,i,r,n,a,s,o){if(a!=o){if(!(a<o))throw new M("Error");if(!(r.sy<=r.ey))throw new M("Error");if(!(a>r.ey||o<r.sy)){if(a<r.sy&&(n+=(s-n)*(r.sy-a)/(o-a),a=r.sy),o>r.ey&&(s+=(s-n)*(r.ey-o)/(o-a),o=r.ey),n==i){if(!(s<=i+1))throw new M("Error")}else if(n==i+1){if(!(s>=i))throw new M("Error")}else if(n<=i){if(!(s<=i))throw new M("Error")}else if(n>=i+1){if(!(s>=i+1))throw new M("Error")}else if(!(s>=i&&s<=i+1))throw new M("Error");if(n<=i&&s<=i){var l=t+i,u=e;u[l]=u[l]+r.direction*(o-a)}else if(!(n>=i+1&&s>=i+1)){if(!(n>=i&&n<=i+1&&s>=i&&s<=i+1))throw new M("Error");var h=t+i,d=e;d[h]=d[h]+r.direction*(o-a)*(1-(n-i+(s-i))/2)}}}},ut.stbtt__fill_active_edges_new=function(e,t,i,r,n,a){for(var s=a+1;null!=n;){if(!(n.ey>=a))throw new M("Error");if(0==n.fdx){var o=n.fx;o<r&&(o>=0?(ut.stbtt__handle_clipped_edge(e,0,0|o,n,o,a,o,s),ut.stbtt__handle_clipped_edge(t,i-1,o+1|0,n,o,a,o,s)):ut.stbtt__handle_clipped_edge(t,i-1,0,n,o,a,o,s))}else{var l,u,h,d,c=n.fx,f=n.fdx,_=c+f,g=n.fdy;if(!(n.sy<=s&&n.ey>=a))throw new M("Error");if(n.sy>a?(l=c+f*(n.sy-a),h=n.sy):(l=c,h=a),n.ey<s?(u=c+f*(n.ey-a),d=n.ey):(u=_,d=s),l>=0&&u>=0&&l<r&&u<r)if((0|l)==(0|u)){var m=0|l,p=d-h;if(!(m>=0&&m<r))throw new M("Error");var v=m,b=e;b[v]=b[v]+n.direction*(1-(l-m+(u-m))/2)*p;var w=i+m,y=t;y[w]=y[w]+n.direction*p}else{if(l>u){var x=h=s-(h-a);h=d=s-(d-a),d=x,x=u,u=l,l=x,f=-f,g=-g,x=c,c=_,_=x}var k=0|l,I=0|u,B=(k+1-c)*g+a,S=n.direction,A=S*(B-h),T=k,N=e;N[T]=N[T]+A*(1-(l-k+(k+1-k))/2);for(var C=S*g,D=k+1,E=I;D<E;){var P=D++,L=e;L[P]=L[P]+(A+C/2),A+=C}if(B+=g*(I-(k+1)),!(Math.abs(A)<=1.01))throw new M("Error");var V=I,F=e;F[V]=F[V]+(A+S*(1-(I-I+(u-I))/2)*(d-B));var W=i+I,R=t;R[W]=R[W]+S*(d-h)}else for(var G=0,H=r;G<H;){var U=G++,Z=a,O=U,z=U+1,X=_,K=s,j=(U-c)/f+a,Y=(U+1-c)/f+a;c<O&&X>z?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,O,j),ut.stbtt__handle_clipped_edge(e,0,U,n,O,j,z,Y),ut.stbtt__handle_clipped_edge(e,0,U,n,z,Y,X,K)):X<O&&c>z?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,z,Y),ut.stbtt__handle_clipped_edge(e,0,U,n,z,Y,O,j),ut.stbtt__handle_clipped_edge(e,0,U,n,O,j,X,K)):c<O&&X>O?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,O,j),ut.stbtt__handle_clipped_edge(e,0,U,n,O,j,X,K)):X<O&&c>O?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,O,j),ut.stbtt__handle_clipped_edge(e,0,U,n,O,j,X,K)):c<z&&X>z?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,z,Y),ut.stbtt__handle_clipped_edge(e,0,U,n,z,Y,X,K)):X<z&&c>z?(ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,z,Y),ut.stbtt__handle_clipped_edge(e,0,U,n,z,Y,X,K)):ut.stbtt__handle_clipped_edge(e,0,U,n,c,Z,X,K)}}n=n.next}},ut.stbtt__rasterize_sorted_edges=function(e,t,i,r,n,a){var s,o,l=null,u=0,h=0;e.w>64?s=new Array(2*e.w+1):s=new Array(129);var d=s;o=e.w;var c=a;for(t[h+i].y0=a+e.h+1;u<e.h;){for(var f=c+0,_=c+1,g=l,m=null,p=0,v=e.w;p<v;){s[p++]=0}for(var b=0,w=e.w+1;b<w;){d[o+b++]=0}for(;null!=g;){var y=g;if(y.ey<=f){if(null==m?(l=y.next,g=y.next):(m.next=y.next,g=y.next),0==y.direction)throw new M("Error");y.direction=0}else m=g,g=g.next}for(;t[h].y0<=_;){if(t[h].y0!=t[h].y1){var x=ut.stbtt__new_active(t,h,n,f);if(!(x.ey>=f))throw new M("Error");x.next=l,l=x}++h}null!=l&&ut.stbtt__fill_active_edges_new(s,d,o+1,e.w,l,f);for(var k=0,I=0,B=e.w;I<B;){var S=I++;k+=d[o+S];var A=s[S]+k,T=0|(A=255*Math.abs(A)+.5);T>255&&(T=255),e.pixels.writeU8(e.pixels_offset+u*e.stride+S,T)}for(m=null,g=l;null!=g;){var N=g;N.fx+=N.fdx,m=g,g=g.next}++c,++u}},ut.STBTT__COMPARE=function(e,t){return e.y0<t.y0},ut.stbtt__sort_edges_ins_sort=function(e,t){for(var i,r=1,n=t;r<n;){var a=r++,s=e[a],o=s;for(i=a;i>0;){var l=e[i-1];if(!ut.STBTT__COMPARE(o,l))break;e[i]=e[i-1],--i}a!=i&&(e[i]=s)}},ut.stbtt__sort_edges_quicksort=function(e,t,i){for(;i>12;){var r,n=i>>1,a=ut.STBTT__COMPARE(e[t],e[t+n]),s=ut.STBTT__COMPARE(e[t+n],e[t+i-1]);if(a!=s){var o=ut.STBTT__COMPARE(e[t],e[t+i-1])==s?0:i-1;r=e[t+o],e[t+o]=e[t+n],e[t+n]=r}r=e[t],e[t]=e[t+n],e[t+n]=r;for(var l=1,u=i-1;;){for(;ut.STBTT__COMPARE(e[t+l],e[t]);)++l;for(;ut.STBTT__COMPARE(e[t],e[t+u]);)--u;if(l>=u)break;r=e[t+l],e[t+l]=e[t+u],e[t+u]=r,++l,--u}u<i-l?(ut.stbtt__sort_edges_quicksort(e,t,u),t+=l,i-=l):(ut.stbtt__sort_edges_quicksort(e,t+l,i-l),i=u)}},ut.stbtt__sort_edges=function(e,t){ut.stbtt__sort_edges_quicksort(e,0,t),ut.stbtt__sort_edges_ins_sort(e,t)},ut.stbtt__rasterize=function(e,t,i,r,n,a,s,o,l,u,h){for(var d,c=h?-a:a,f=0,_=0,g=r;_<g;){f+=i[_++]}var m=new Array(f+1);if(null!=m){for(var p=0,v=m.length;p<v;){m[p++]=new st}f=0;for(var b=0,w=0,y=r;w<y;){var x=w++,k=t,I=0+b;b+=i[x],d=i[x]-1;for(var B=0,S=i[x];B<S;){var A=B++,T=A,N=d;k[I+d].y!=k[I+A].y?(m[f].invert=!1,(h?k[I+d].y>k[I+A].y:k[I+d].y<k[I+A].y)&&(m[f].invert=!0,T=d,N=A),m[f].x0=k[I+T].x*n+s,m[f].y0=1*(k[I+T].y*c+o),m[f].x1=k[I+N].x*n+s,m[f].y1=1*(k[I+N].y*c+o),++f,d=A):d=A}}ut.stbtt__sort_edges(m,f),ut.stbtt__rasterize_sorted_edges(e,m,f,1,l,u)}},ut.stbtt__add_point=function(e,t,i,r){null!=e&&(e[t].x=i,e[t].y=r)},ut.stbtt__tesselate_curve=function(e,t,i,r,n,a,s,o,l,u){var h=(i+2*n+s)/4,d=(r+2*a+o)/4,c=(i+s)/2-h,f=(r+o)/2-d;return u>16?1:(c*c+f*f>l?(ut.stbtt__tesselate_curve(e,t,i,r,(i+n)/2,(r+a)/2,h,d,l,u+1),ut.stbtt__tesselate_curve(e,t,h,d,(n+s)/2,(a+o)/2,s,o,l,u+1)):(ut.stbtt__add_point(e,t.value,s,o),t.value+=1),1)},ut.stbtt_FlattenCurves=function(e,t,i,r,n){for(var a=null,s=0,o=i*i,l=0,u=0,h=0,d=t;h<d;){1==e[h++].type&&++l}if(n.value=l,0==l)return null;var c=new Array(l);if(r.value=c,null==r.value)return n.value=0,null;for(var f=0;f<2;){var _=0,g=0;if(1==f++){if(null==(a=new Array(s)))return r.value=null,n.value=0,null;for(var m=0,p=a.length;m<p;){a[m++]=new lt}}s=0,l=-1;for(var v=0,b=t;v<b;){var w=v++;switch(e[w].type){case 1:l>=0&&(r.value[l]=s-u),++l,u=s,_=e[w].x,g=e[w].y,ut.stbtt__add_point(a,s++,_,g);break;case 2:_=e[w].x,g=e[w].y,ut.stbtt__add_point(a,s++,_,g);break;case 3:var y={value:s};ut.stbtt__tesselate_curve(a,y,_,g,e[w].cx,e[w].cy,e[w].x,e[w].y,o,0),s=y.value,_=e[w].x,g=e[w].y}}r.value[l]=s-u}return a},ut.stbtt_Rasterize=function(e,t,i,r,n,a,s,o,l,u,h){var d,c=n>a?a:n,f=0,_={value:f},g=new qe,m=ut.stbtt_FlattenCurves(i,r,t/c,g,_);f=_.value,d=g.value,null!=m&&ut.stbtt__rasterize(e,m,d,f,n,a,s,o,l,u,h)},ut.stbtt_MakeGlyphBitmapSubpixel=function(e,t,i,r,n,a,s,o,l,u,h){var d,c,f=ut.stbtt_GetGlyphShape(e,h),_=null==f?0:f.length,g=new at,m=ut.stbtt_GetGlyphBitmapBoxSubpixel(e,h,s,o,l,u);d=m.x0,c=m.y0,g.pixels=t,g.pixels_offset=i,g.w=r,g.h=n,g.stride=a,0!=g.w&&0!=g.h&&ut.stbtt_Rasterize(g,.35,f,_,s,o,l,u,d,c,!0)},ut.stbtt_MakeGlyphBitmap=function(e,t,i,r,n,a,s,o,l){ut.stbtt_MakeGlyphBitmapSubpixel(e,t,i,r,n,a,s,o,0,0,l)},ut.stbtt_BakeFontBitmap=function(e,t,i,r,n,a,s,o){var l=new rt;if(!ut.stbtt_InitFont(l,e,t))return-1;for(var u=1,h=u,d=1,c=ut.stbtt_ScaleForPixelHeight(l,i),f=0,_=0;_<s.length;){var g=s[_];++_;var m=ut.stbtt_FindGlyphIndex(l,g),p=ut.stbtt_GetGlyphHMetrics(l,m),v=p.advanceWidth,b=(p.leftSideBearing,ut.stbtt_GetGlyphBitmapBox(l,m,c,c)),w=b.x0,y=b.y0,x=b.x1-w,k=b.y1-y;if(h+x+1>=n&&(u=d,h=1),u+k+1>=a)return-f;if(h+x>=n)throw new M("Error");if(u+k>=a)throw new M("Error");o[f].x0=h,o[f].y0=u,o[f].x1=h+x,o[f].y1=u+k,o[f].xadvance=c*v,o[f].xoff=w,o[f].yoff=y,h=h+x+1,u+k+1>d&&(d=u+k+1),++f}for(var I,B=0,S=n*a;B<S;){var A=B++;r.writeU8(A,0)}f=0;for(var T=0;T<s.length;){var N=s[T];++T;var C=ut.stbtt_FindGlyphIndex(l,N);I=o[f],ut.stbtt_MakeGlyphBitmap(l,r,I.x0+I.y0*n,I.x1-I.x0,I.y1-I.y0,n,c,c,C),++f}return d};var ht=function(){};r["kha.graphics4.ConstantLocation"]=ht,ht.__name__=!0,ht.__isInterface__=!0;var dt=function(e,t,i,r){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=e,this.format=t,this.renderTarget=i,this.depthStencilFormat=r,i&&this.createTexture()};r["kha.graphics4.CubeMap"]=dt,dt.__name__=!0,dt.__interfaces__=[K,X],dt.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=ge.gl){if(this.texture=ge.gl.createTexture(),ge.gl.bindTexture(34067,this.texture),ge.gl.texParameteri(34067,10240,9729),ge.gl.texParameteri(34067,10241,9729),ge.gl.texParameteri(34067,10242,33071),ge.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=ge.gl.createFramebuffer(),ge.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:ge.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);break;case 2:ge.gl.texImage2D(34069,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ge.gl.texImage2D(34070,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ge.gl.texImage2D(34071,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ge.gl.texImage2D(34072,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ge.gl.texImage2D(34073,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ge.gl.texImage2D(34074,0,ge.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:ge.gl.texImage2D(34069,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texImage2D(34070,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texImage2D(34071,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texImage2D(34072,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texImage2D(34073,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texImage2D(34074,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:ge.gl.texImage2D(34069,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34070,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34071,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34072,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34073,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34074,0,ge.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ge.halfFloat.HALF_FLOAT_OES,null);break;case 5:ge.gl.texImage2D(34069,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ge.gl.texImage2D(34070,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ge.gl.texImage2D(34071,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ge.gl.texImage2D(34072,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ge.gl.texImage2D(34073,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ge.gl.texImage2D(34074,0,ge.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null);break;case 6:ge.gl.texImage2D(34069,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34070,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34071,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34072,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34073,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null),ge.gl.texImage2D(34074,0,ge.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ge.halfFloat.HALF_FLOAT_OES,null);break;default:ge.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(3==this.format&&(ge.gl.texParameteri(34067,10240,9728),ge.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!ge.gl2)){var e=ge.gl.createTexture();ge.gl.bindTexture(34067,e),ge.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34069,e,0),ge.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34070,e,0),ge.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34071,e,0),ge.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34072,e,0),ge.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34073,e,0),ge.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ge.gl.framebufferTexture2D(36160,36064,34074,e,0),ge.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),ge.gl.bindFramebuffer(36160,null)}ge.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:this.depthTexture=ge.gl.createTexture(),ge.gl.bindTexture(34067,this.depthTexture),1==e?ge.gl.texImage2D(34067,0,ge.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):ge.gl.texImage2D(34067,0,ge.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ge.gl.texParameteri(34067,10240,9728),ge.gl.texParameteri(34067,10241,9728),ge.gl.texParameteri(34067,10242,33071),ge.gl.texParameteri(34067,10243,33071),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=ge.gl.createTexture(),ge.gl.bindTexture(34067,this.depthTexture),ge.gl.texImage2D(34067,0,ge.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,ge.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ge.gl.texParameteri(34067,10240,9728),ge.gl.texParameteri(34067,10241,9728),ge.gl.texParameteri(34067,10242,33071),ge.gl.texParameteri(34067,10243,33071),ge.gl.bindFramebuffer(36160,this.frameBuffer),ge.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},width:null,get_width:function(){return this.myWidth},height:null,get_height:function(){return this.myHeight},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new Jt(this)),this.graphics4},__class__:dt};var ct=function(e,t){this.sources=[];for(var i=0;i<e.length;){var r=e[i];++i,this.sources.push(r.toString())}this.type=35632,this.shader=null,this.files=t};r["kha.graphics4.FragmentShader"]=ct,ct.__name__=!0,ct.prototype={sources:null,type:null,shader:null,files:null,__class__:ct};var ft=function(){};r["kha.graphics4.GeometryShader"]=ft,ft.__name__=!0;var _t=function(){};r["kha.graphics4.Graphics"]=_t,_t.__name__=!0,_t.__isInterface__=!0,_t.prototype={begin:null,end:null,clear:null,setVertexBuffer:null,setIndexBuffer:null,setTexture:null,setTextureParameters:null,setPipeline:null,setMatrix:null,drawIndexedVertices:null,__class__:_t};var gt=function(e){this.pipeline=e;try{this.projectionLocation=e.getConstantLocation("projectionMatrix")}catch(e){b.trace(e instanceof M?e.val:e,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:39,className:"kha.graphics4.PipelineCache",methodName:"new"})}try{this.textureLocation=e.getTextureUnit("tex")}catch(e){b.trace(e instanceof M?e.val:e,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:40,className:"kha.graphics4.PipelineCache",methodName:"new"})}};r["kha.graphics4.PipelineCache"]=gt,gt.__name__=!0,gt.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:gt};var mt=function(e){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,mt.bufferIndex=0,mt.initShaders(),this.myPipeline=mt.standardImagePipeline,this.initBuffers()};r["kha.graphics4.ImageShaderPainter"]=mt,mt.__name__=!0,mt.initShaders=function(){if(null==mt.structure&&(mt.structure=bt.createImageVertexStructure()),null==mt.standardImagePipeline){var e=bt.createImagePipeline(mt.structure);e.compile(),mt.standardImagePipeline=new gt(e)}},mt.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==mt.rectVertexBuffer){mt.rectVertexBuffer=new At(6e3,mt.structure,1),mt.rectVertices=mt.rectVertexBuffer.lock(),mt.indexBuffer=new wt(9e3,0);for(var e=mt.indexBuffer.lock(),t=0;t<1500;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}mt.indexBuffer.unlock()}},drawBuffer:function(){mt.rectVertexBuffer.unlock(4*mt.bufferIndex),this.g.setVertexBuffer(mt.rectVertexBuffer),this.g.setIndexBuffer(mt.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,mt.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*mt.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),mt.bufferIndex=0,mt.rectVertices=mt.rectVertexBuffer.lock()},end:function(){mt.bufferIndex>0&&this.drawBuffer(),mt.lastTexture=null},__class__:mt};var pt=function(e){this.myPipeline=null,this.g=e,pt.bufferIndex=0,pt.triangleBufferIndex=0,pt.initShaders(),this.myPipeline=pt.standardColorPipeline,this.initBuffers()};r["kha.graphics4.ColoredShaderPainter"]=pt,pt.__name__=!0,pt.initShaders=function(){if(null==pt.structure&&(pt.structure=bt.createColoredVertexStructure()),null==pt.standardColorPipeline){var e=bt.createColoredPipeline(pt.structure);e.compile(),pt.standardColorPipeline=new gt(e)}},pt.prototype={projectionMatrix:null,g:null,myPipeline:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==pt.rectVertexBuffer){pt.rectVertexBuffer=new At(4e3,pt.structure,1),pt.rectVertices=pt.rectVertexBuffer.lock(),pt.indexBuffer=new wt(6e3,0);for(var e=pt.indexBuffer.lock(),t=0;t<1e3;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}pt.indexBuffer.unlock(),pt.triangleVertexBuffer=new At(3e3,pt.structure,1),pt.triangleVertices=pt.triangleVertexBuffer.lock(),pt.triangleIndexBuffer=new wt(3e3,0);for(var r=pt.triangleIndexBuffer.lock(),n=0;n<1e3;){var a=n++;r[3*a]=3*a,r[3*a+1]=3*a+1,r[3*a+2]=3*a+2}pt.triangleIndexBuffer.unlock()}},setRectVertices:function(e,t,i,r,n,a,s,o){var l=7*pt.bufferIndex*4;pt.rectVertices[l]=e,pt.rectVertices[l+1]=t,pt.rectVertices[l+2]=-5,pt.rectVertices[l+7]=i,pt.rectVertices[l+8]=r,pt.rectVertices[l+9]=-5,pt.rectVertices[l+14]=n,pt.rectVertices[l+15]=a,pt.rectVertices[l+16]=-5,pt.rectVertices[l+21]=s,pt.rectVertices[l+22]=o,pt.rectVertices[l+23]=-5},setRectColors:function(e,t){var i=7*pt.bufferIndex*4,r=e*(.00392156862745098*(t>>>24)),n=r*(.00392156862745098*((16711680&t)>>>16)),a=r*(.00392156862745098*((65280&t)>>>8)),s=r*(.00392156862745098*(255&t));pt.rectVertices[i+3]=n,pt.rectVertices[i+4]=a,pt.rectVertices[i+5]=s,pt.rectVertices[i+6]=r,pt.rectVertices[i+10]=n,pt.rectVertices[i+11]=a,pt.rectVertices[i+12]=s,pt.rectVertices[i+13]=r,pt.rectVertices[i+17]=n,pt.rectVertices[i+18]=a,pt.rectVertices[i+19]=s,pt.rectVertices[i+20]=r,pt.rectVertices[i+24]=n,pt.rectVertices[i+25]=a,pt.rectVertices[i+26]=s,pt.rectVertices[i+27]=r},drawBuffer:function(e){e||pt.triangleBufferIndex>0&&this.drawTriBuffer(!0),pt.rectVertexBuffer.unlock(4*pt.bufferIndex),this.g.setVertexBuffer(pt.rectVertexBuffer),this.g.setIndexBuffer(pt.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*pt.bufferIndex*3),pt.bufferIndex=0,pt.rectVertices=pt.rectVertexBuffer.lock()},drawTriBuffer:function(e){e||pt.bufferIndex>0&&this.drawBuffer(!0),pt.triangleVertexBuffer.unlock(3*pt.triangleBufferIndex),this.g.setVertexBuffer(pt.triangleVertexBuffer),this.g.setIndexBuffer(pt.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*pt.triangleBufferIndex),pt.triangleBufferIndex=0,pt.triangleVertices=pt.triangleVertexBuffer.lock()},fillRect:function(e,t,i,r,n,a,s,o,l,u){pt.triangleBufferIndex>0&&this.drawTriBuffer(!0),pt.bufferIndex+1>=1e3&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(i,r,n,a,s,o,l,u),++pt.bufferIndex},__class__:pt};var vt=function(e){this.bakedQuadCache=new te,this.bilinear=!1,this.myPipeline=null,this.g=e,vt.bufferIndex=0,vt.initShaders(),this.myPipeline=vt.standardTextPipeline,this.initBuffers()};r["kha.graphics4.TextShaderPainter"]=vt,vt.__name__=!0,vt.initShaders=function(){if(null==vt.structure&&(vt.structure=bt.createTextVertexStructure()),null==vt.standardTextPipeline){var e=bt.createTextPipeline(vt.structure);e.compile(),vt.standardTextPipeline=new gt(e)}},vt.findIndex=function(e){Qe.fontGlyphs;for(var t=ie.charBlocks,i=0,r=0,n=t.length/2|0;r<n;){var a=r++,s=t[2*a],o=t[2*a+1];if(e>=s&&e<=o)return i+e-s;i+=o-s+1}return 0},vt.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==vt.rectVertexBuffer){vt.rectVertexBuffer=new At(4e3,vt.structure,1),vt.rectVertices=vt.rectVertexBuffer.lock(),vt.indexBuffer=new wt(6e3,0);for(var e=vt.indexBuffer.lock(),t=0;t<1e3;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}vt.indexBuffer.unlock()}},setRectVertices:function(e,t,i,r,n,a,s,o){var l=9*vt.bufferIndex*4;vt.rectVertices[l]=e,vt.rectVertices[l+1]=t,vt.rectVertices[l+2]=-5,vt.rectVertices[l+9]=i,vt.rectVertices[l+10]=r,vt.rectVertices[l+11]=-5,vt.rectVertices[l+18]=n,vt.rectVertices[l+19]=a,vt.rectVertices[l+20]=-5,vt.rectVertices[l+27]=s,vt.rectVertices[l+28]=o,vt.rectVertices[l+29]=-5},setRectTexCoords:function(e,t,i,r){var n=9*vt.bufferIndex*4;vt.rectVertices[n+3]=e,vt.rectVertices[n+4]=r,vt.rectVertices[n+12]=e,vt.rectVertices[n+13]=t,vt.rectVertices[n+21]=i,vt.rectVertices[n+22]=t,vt.rectVertices[n+30]=i,vt.rectVertices[n+31]=r},setRectColors:function(e,t){var i=9*vt.bufferIndex*4,r=e*(.00392156862745098*(t>>>24));vt.rectVertices[i+5]=.00392156862745098*((16711680&t)>>>16),vt.rectVertices[i+6]=.00392156862745098*((65280&t)>>>8),vt.rectVertices[i+7]=.00392156862745098*(255&t),vt.rectVertices[i+8]=r,vt.rectVertices[i+14]=.00392156862745098*((16711680&t)>>>16),vt.rectVertices[i+15]=.00392156862745098*((65280&t)>>>8),vt.rectVertices[i+16]=.00392156862745098*(255&t),vt.rectVertices[i+17]=r,vt.rectVertices[i+23]=.00392156862745098*((16711680&t)>>>16),vt.rectVertices[i+24]=.00392156862745098*((65280&t)>>>8),vt.rectVertices[i+25]=.00392156862745098*(255&t),vt.rectVertices[i+26]=r,vt.rectVertices[i+32]=.00392156862745098*((16711680&t)>>>16),vt.rectVertices[i+33]=.00392156862745098*((65280&t)>>>8),vt.rectVertices[i+34]=.00392156862745098*(255&t),vt.rectVertices[i+35]=r},drawBuffer:function(){vt.rectVertexBuffer.unlock(4*vt.bufferIndex),this.g.setVertexBuffer(vt.rectVertexBuffer),this.g.setIndexBuffer(vt.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,vt.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*vt.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),vt.bufferIndex=0,vt.rectVertices=vt.rectVertexBuffer.lock()},setFont:function(e){this.font=R.__cast(e,re)},bakedQuadCache:null,drawString:function(e,t,i,r,n,a){var s=this.font._get(this.fontSize),o=s.getTexture();null!=vt.lastTexture&&o!=vt.lastTexture&&this.drawBuffer(),vt.lastTexture=o;for(var l=r,u=n,h=0,d=e.length;h<d;){var c=h++,f=e.charCodeAt(c),_=s.getBakedQuad(this.bakedQuadCache,vt.findIndex(f),l,u);if(null!=_){vt.bufferIndex+1>=1e3&&this.drawBuffer(),this.setRectColors(t,i),this.setRectTexCoords(_.s0*o.get_width()/o.get_realWidth(),_.t0*o.get_height()/o.get_realHeight(),_.s1*o.get_width()/o.get_realWidth(),_.t1*o.get_height()/o.get_realHeight());var g=_.x0,m=_.y1;null==m&&(m=0),null==g&&(g=0);var p=g,v=m,b=a._02*p+a._12*v+a._22,w=(a._00*p+a._10*v+a._20)/b,y=(a._01*p+a._11*v+a._21)/b;null==y&&(y=0),null==w&&(w=0);var x=w,k=y,I=_.x0,B=_.y0;null==B&&(B=0),null==I&&(I=0);var S=I,A=B,T=a._02*S+a._12*A+a._22,N=(a._00*S+a._10*A+a._20)/T,C=(a._01*S+a._11*A+a._21)/T;null==C&&(C=0),null==N&&(N=0);var D=N,E=C,P=_.x1,L=_.y0;null==L&&(L=0),null==P&&(P=0);var V=P,F=L,W=a._02*V+a._12*F+a._22,M=(a._00*V+a._10*F+a._20)/W,R=(a._01*V+a._11*F+a._21)/W;null==R&&(R=0),null==M&&(M=0);var G=M,H=R,U=_.x1,Z=_.y1;null==Z&&(Z=0),null==U&&(U=0);var O=U,z=Z,X=a._02*O+a._12*z+a._22,K=(a._00*O+a._10*z+a._20)/X,j=(a._01*O+a._11*z+a._21)/X;null==j&&(j=0),null==K&&(K=0);var Y=K,Q=j;this.setRectVertices(x,k,D,E,G,H,Y,Q),l+=_.xadvance,++vt.bufferIndex}}},end:function(){vt.bufferIndex>0&&this.drawBuffer(),vt.lastTexture=null},__class__:vt};var bt=function(e){Qe.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new mt(this.g),this.coloredPainter=new pt(this.g),this.textPainter=new vt(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new ri(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==bt.videoPipeline&&(bt.videoPipeline=bt.createImagePipeline(bt.createImageVertexStructure()),bt.videoPipeline.fragmentShader=he.painter_video_frag,bt.videoPipeline.vertexShader=he.painter_video_vert,bt.videoPipeline.compile())};r["kha.graphics4.Graphics2"]=bt,bt.__name__=!0,bt.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},bt.createImageVertexStructure=function(){var e=new Ct;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},bt.createImagePipeline=function(e){var t=new xt;return t.fragmentShader=he.painter_image_frag,t.vertexShader=he.painter_image_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},bt.createColoredVertexStructure=function(){var e=new Ct;return e.add("vertexPosition",2),e.add("vertexColor",3),e},bt.createColoredPipeline=function(e){var t=new xt;return t.fragmentShader=he.painter_colored_frag,t.vertexShader=he.painter_colored_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},bt.createTextVertexStructure=function(){var e=new Ct;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},bt.createTextPipeline=function(e){var t=new xt;return t.fragmentShader=he.painter_text_frag,t.vertexShader=he.painter_text_vert,t.inputLayout=[e],t.blendSource=3,t.blendDestination=5,t.alphaBlendSource=3,t.alphaBlendDestination=5,t},bt.__super__=Qe,bt.prototype=s(Qe.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();if(this.canvas instanceof $){var i=this.projectionMatrix,r=2/e,n=-e/e,a=2/(0-t),s=-t/(0-t);i._00=r,i._10=0,i._20=0,i._30=n,i._01=0,i._11=a,i._21=0,i._31=s,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if(j.get_nonPow2Supported()||(e=bt.upperPowerOfTwo(e),t=bt.upperPowerOfTwo(t)),j.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/e,u=-e/e,h=2/t,d=-t/t;o._00=l,o._10=0,o._20=0,o._30=u,o._01=0,o._11=h,o._21=0,o._31=d,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var c=this.projectionMatrix,f=2/e,_=-e/e,g=2/(0-t),m=-t/(0-t);c._00=f,c._10=0,c._20=0,c._30=_,c._01=0,c._11=g,c._21=0,c._31=m,c._02=0,c._12=0,c._22=-.002000200020002,c._32=-1.0002000200020003,c._03=0,c._13=0,c._23=0,c._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(e,t,i){var r=this.coloredPainter;pt.triangleBufferIndex>0&&r.drawTriBuffer(!1),pt.bufferIndex>0&&r.drawBuffer(!1),this.textPainter.end();var n=t+e.get_width(),a=i+e.get_height(),s=this.transformations[this.transformationIndex],o=t,l=a;null==l&&(l=0),null==o&&(o=0);var u=o,h=l,d=s._02*u+s._12*h+s._22,c=(s._00*u+s._10*h+s._20)/d,f=(s._01*u+s._11*h+s._21)/d;null==f&&(f=0),null==c&&(c=0);var _=c,g=f,m=this.transformations[this.transformationIndex],p=t,v=i;null==v&&(v=0),null==p&&(p=0);var b=p,w=v,y=m._02*b+m._12*w+m._22,x=(m._00*b+m._10*w+m._20)/y,k=(m._01*b+m._11*w+m._21)/y;null==k&&(k=0),null==x&&(x=0);var I=x,B=k,S=this.transformations[this.transformationIndex],A=n,T=i;null==T&&(T=0),null==A&&(A=0);var N=A,C=T,D=S._02*N+S._12*C+S._22,E=(S._00*N+S._10*C+S._20)/D,P=(S._01*N+S._11*C+S._21)/D;null==P&&(P=0),null==E&&(E=0);var L=E,V=P,F=this.transformations[this.transformationIndex],W=n,M=a;null==M&&(M=0),null==W&&(W=0);var R=W,G=M,H=F._02*R+F._12*G+F._22,U=(F._00*R+F._10*G+F._20)/H,Z=(F._01*R+F._11*G+F._21)/H;null==Z&&(Z=0),null==U&&(U=0);var O=U,z=Z,X=this.imagePainter,K=this.get_opacity(),j=this.get_color(),Y=e;(mt.bufferIndex+1>=1500||null!=mt.lastTexture&&Y!=mt.lastTexture)&&X.drawBuffer();var Q=.00392156862745098*((16711680&j)>>>16),J=.00392156862745098*((65280&j)>>>8),q=.00392156862745098*(255&j),$=.00392156862745098*(j>>>24)*K,ee=9*mt.bufferIndex*4;mt.rectVertices[ee+5]=Q,mt.rectVertices[ee+6]=J,mt.rectVertices[ee+7]=q,mt.rectVertices[ee+8]=$,mt.rectVertices[ee+14]=Q,mt.rectVertices[ee+15]=J,mt.rectVertices[ee+16]=q,mt.rectVertices[ee+17]=$,mt.rectVertices[ee+23]=Q,mt.rectVertices[ee+24]=J,mt.rectVertices[ee+25]=q,mt.rectVertices[ee+26]=$,mt.rectVertices[ee+32]=Q,mt.rectVertices[ee+33]=J,mt.rectVertices[ee+34]=q,mt.rectVertices[ee+35]=$;var te=Y.get_width()/Y.get_realWidth(),ie=Y.get_height()/Y.get_realHeight(),re=9*mt.bufferIndex*4;mt.rectVertices[re+3]=0,mt.rectVertices[re+4]=ie,mt.rectVertices[re+12]=0,mt.rectVertices[re+13]=0,mt.rectVertices[re+21]=te,mt.rectVertices[re+22]=0,mt.rectVertices[re+30]=te,mt.rectVertices[re+31]=ie;var ne=9*mt.bufferIndex*4;mt.rectVertices[ne]=_,mt.rectVertices[ne+1]=g,mt.rectVertices[ne+2]=-5,mt.rectVertices[ne+9]=I,mt.rectVertices[ne+10]=B,mt.rectVertices[ne+11]=-5,mt.rectVertices[ne+18]=L,mt.rectVertices[ne+19]=V,mt.rectVertices[ne+20]=-5,mt.rectVertices[ne+27]=O,mt.rectVertices[ne+28]=z,mt.rectVertices[ne+29]=-5,++mt.bufferIndex,mt.lastTexture=Y},drawScaledSubImage:function(e,t,i,r,n,a,s,o,l){var u=this.coloredPainter;pt.triangleBufferIndex>0&&u.drawTriBuffer(!1),pt.bufferIndex>0&&u.drawBuffer(!1),this.textPainter.end();var h=this.transformations[this.transformationIndex],d=a,c=s+l;null==c&&(c=0),null==d&&(d=0);var f=d,_=c,g=h._02*f+h._12*_+h._22,m=(h._00*f+h._10*_+h._20)/g,p=(h._01*f+h._11*_+h._21)/g;null==p&&(p=0),null==m&&(m=0);var v=m,b=p,w=this.transformations[this.transformationIndex],y=a,x=s;null==x&&(x=0),null==y&&(y=0);var k=y,I=x,B=w._02*k+w._12*I+w._22,S=(w._00*k+w._10*I+w._20)/B,A=(w._01*k+w._11*I+w._21)/B;null==A&&(A=0),null==S&&(S=0);var T=S,N=A,C=this.transformations[this.transformationIndex],D=a+o,E=s;null==E&&(E=0),null==D&&(D=0);var P=D,L=E,V=C._02*P+C._12*L+C._22,F=(C._00*P+C._10*L+C._20)/V,W=(C._01*P+C._11*L+C._21)/V;null==W&&(W=0),null==F&&(F=0);var M=F,R=W,G=this.transformations[this.transformationIndex],H=a+o,U=s+l;null==U&&(U=0),null==H&&(H=0);var Z=H,O=U,z=G._02*Z+G._12*O+G._22,X=(G._00*Z+G._10*O+G._20)/z,K=(G._01*Z+G._11*O+G._21)/z;null==K&&(K=0),null==X&&(X=0);var j=X,Y=K,Q=this.imagePainter,J=this.get_opacity(),q=this.get_color(),$=e;(mt.bufferIndex+1>=1500||null!=mt.lastTexture&&$!=mt.lastTexture)&&Q.drawBuffer();var ee=t/$.get_realWidth(),te=i/$.get_realHeight(),ie=(t+r)/$.get_realWidth(),re=(i+n)/$.get_realHeight(),ne=9*mt.bufferIndex*4;mt.rectVertices[ne+3]=ee,mt.rectVertices[ne+4]=re,mt.rectVertices[ne+12]=ee,mt.rectVertices[ne+13]=te,mt.rectVertices[ne+21]=ie,mt.rectVertices[ne+22]=te,mt.rectVertices[ne+30]=ie,mt.rectVertices[ne+31]=re;var ae=.00392156862745098*((16711680&q)>>>16),se=.00392156862745098*((65280&q)>>>8),oe=.00392156862745098*(255&q),le=.00392156862745098*(q>>>24)*J,ue=9*mt.bufferIndex*4;mt.rectVertices[ue+5]=ae,mt.rectVertices[ue+6]=se,mt.rectVertices[ue+7]=oe,mt.rectVertices[ue+8]=le,mt.rectVertices[ue+14]=ae,mt.rectVertices[ue+15]=se,mt.rectVertices[ue+16]=oe,mt.rectVertices[ue+17]=le,mt.rectVertices[ue+23]=ae,mt.rectVertices[ue+24]=se,mt.rectVertices[ue+25]=oe,mt.rectVertices[ue+26]=le,mt.rectVertices[ue+32]=ae,mt.rectVertices[ue+33]=se,mt.rectVertices[ue+34]=oe,mt.rectVertices[ue+35]=le;var he=9*mt.bufferIndex*4;mt.rectVertices[he]=v,mt.rectVertices[he+1]=b,mt.rectVertices[he+2]=-5,mt.rectVertices[he+9]=T,mt.rectVertices[he+10]=N,mt.rectVertices[he+11]=-5,mt.rectVertices[he+18]=M,mt.rectVertices[he+19]=R,mt.rectVertices[he+20]=-5,mt.rectVertices[he+27]=j,mt.rectVertices[he+28]=Y,mt.rectVertices[he+29]=-5,++mt.bufferIndex,mt.lastTexture=$},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},drawRect:function(e,t,i,r,n){null==n&&(n=1),this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],s=e-n/2,o=t+n/2;null==o&&(o=0),null==s&&(s=0);var l=s,u=o,h=a._02*l+a._12*u+a._22,d=(a._00*l+a._10*u+a._20)/h,c=(a._01*l+a._11*u+a._21)/h;null==c&&(c=0),null==d&&(d=0);var f=d,_=c,g=this.transformations[this.transformationIndex],m=e-n/2,p=t-n/2;null==p&&(p=0),null==m&&(m=0);var v=m,b=p,w=g._02*v+g._12*b+g._22,y=(g._00*v+g._10*b+g._20)/w,x=(g._01*v+g._11*b+g._21)/w;null==x&&(x=0),null==y&&(y=0);var k=y,I=x,B=this.transformations[this.transformationIndex],S=e+i+n/2,A=t-n/2;null==A&&(A=0),null==S&&(S=0);var T=S,N=A,C=B._02*T+B._12*N+B._22,D=(B._00*T+B._10*N+B._20)/C,E=(B._01*T+B._11*N+B._21)/C;null==E&&(E=0),null==D&&(D=0);var P=D,L=E,V=this.transformations[this.transformationIndex],F=e+i+n/2,W=t+n/2;null==W&&(W=0),null==F&&(F=0);var M=F,R=W,G=V._02*M+V._12*R+V._22,H=(V._00*M+V._10*R+V._20)/G,U=(V._01*M+V._11*R+V._21)/G;null==U&&(U=0),null==H&&(H=0);var Z=H,O=U;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f,_,k,I,P,L,Z,O);var z=this.transformations[this.transformationIndex],X=e-n/2,K=t+r-n/2;null==K&&(K=0),null==X&&(X=0);var j=X,Y=K,Q=z._02*j+z._12*Y+z._22,J=(z._00*j+z._10*Y+z._20)/Q,q=(z._01*j+z._11*Y+z._21)/Q;null==q&&(q=0),null==J&&(J=0),f=J,_=q;var $=this.transformations[this.transformationIndex],ee=e-n/2,te=t+n/2;null==te&&(te=0),null==ee&&(ee=0);var ie=ee,re=te,ne=$._02*ie+$._12*re+$._22,ae=($._00*ie+$._10*re+$._20)/ne,se=($._01*ie+$._11*re+$._21)/ne;null==se&&(se=0),null==ae&&(ae=0),k=ae,I=se;var oe=this.transformations[this.transformationIndex],le=e+n/2,ue=t+n/2;null==ue&&(ue=0),null==le&&(le=0);var he=le,de=ue,ce=oe._02*he+oe._12*de+oe._22,fe=(oe._00*he+oe._10*de+oe._20)/ce,_e=(oe._01*he+oe._11*de+oe._21)/ce;null==_e&&(_e=0),null==fe&&(fe=0),P=fe,L=_e;var ge=this.transformations[this.transformationIndex],me=e+n/2,pe=t+r-n/2;null==pe&&(pe=0),null==me&&(me=0);var ve=me,be=pe,we=ge._02*ve+ge._12*be+ge._22,ye=(ge._00*ve+ge._10*be+ge._20)/we,xe=(ge._01*ve+ge._11*be+ge._21)/we;null==xe&&(xe=0),null==ye&&(ye=0),Z=ye,O=xe,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f,_,k,I,P,L,Z,O);var ke=this.transformations[this.transformationIndex],Ie=e-n/2,Be=t+r+n/2;null==Be&&(Be=0),null==Ie&&(Ie=0);var Se=Ie,Ae=Be,Te=ke._02*Se+ke._12*Ae+ke._22,Ne=(ke._00*Se+ke._10*Ae+ke._20)/Te,Ce=(ke._01*Se+ke._11*Ae+ke._21)/Te;null==Ce&&(Ce=0),null==Ne&&(Ne=0),f=Ne,_=Ce;var De=this.transformations[this.transformationIndex],Ee=e-n/2,Pe=t+r-n/2;null==Pe&&(Pe=0),null==Ee&&(Ee=0);var Le=Ee,Ve=Pe,Fe=De._02*Le+De._12*Ve+De._22,We=(De._00*Le+De._10*Ve+De._20)/Fe,Me=(De._01*Le+De._11*Ve+De._21)/Fe;null==Me&&(Me=0),null==We&&(We=0),k=We,I=Me;var Re=this.transformations[this.transformationIndex],Ge=e+i+n/2,He=t+r-n/2;null==He&&(He=0),null==Ge&&(Ge=0);var Ue=Ge,Ze=He,Oe=Re._02*Ue+Re._12*Ze+Re._22,ze=(Re._00*Ue+Re._10*Ze+Re._20)/Oe,Xe=(Re._01*Ue+Re._11*Ze+Re._21)/Oe;null==Xe&&(Xe=0),null==ze&&(ze=0),P=ze,L=Xe;var Ke=this.transformations[this.transformationIndex],je=e+i+n/2,Ye=t+r+n/2;null==Ye&&(Ye=0),null==je&&(je=0);var Qe=je,Je=Ye,qe=Ke._02*Qe+Ke._12*Je+Ke._22,$e=(Ke._00*Qe+Ke._10*Je+Ke._20)/qe,et=(Ke._01*Qe+Ke._11*Je+Ke._21)/qe;null==et&&(et=0),null==$e&&($e=0),Z=$e,O=et,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f,_,k,I,P,L,Z,O);var tt=this.transformations[this.transformationIndex],it=e+i-n/2,rt=t+r-n/2;null==rt&&(rt=0),null==it&&(it=0);var nt=it,at=rt,st=tt._02*nt+tt._12*at+tt._22,ot=(tt._00*nt+tt._10*at+tt._20)/st,lt=(tt._01*nt+tt._11*at+tt._21)/st;null==lt&&(lt=0),null==ot&&(ot=0),f=ot,_=lt;var ut=this.transformations[this.transformationIndex],ht=e+i-n/2,dt=t+n/2;null==dt&&(dt=0),null==ht&&(ht=0);var ct=ht,ft=dt,_t=ut._02*ct+ut._12*ft+ut._22,gt=(ut._00*ct+ut._10*ft+ut._20)/_t,mt=(ut._01*ct+ut._11*ft+ut._21)/_t;null==mt&&(mt=0),null==gt&&(gt=0),k=gt,I=mt;var pt=this.transformations[this.transformationIndex],vt=e+i+n/2,bt=t+n/2;null==bt&&(bt=0),null==vt&&(vt=0);var wt=vt,yt=bt,xt=pt._02*wt+pt._12*yt+pt._22,kt=(pt._00*wt+pt._10*yt+pt._20)/xt,It=(pt._01*wt+pt._11*yt+pt._21)/xt;null==It&&(It=0),null==kt&&(kt=0),P=kt,L=It;var Bt=this.transformations[this.transformationIndex],St=e+i+n/2,At=t+r-n/2;null==At&&(At=0),null==St&&(St=0);var Tt=St,Nt=At,Ct=Bt._02*Tt+Bt._12*Nt+Bt._22,Dt=(Bt._00*Tt+Bt._10*Nt+Bt._20)/Ct,Et=(Bt._01*Tt+Bt._11*Nt+Bt._21)/Ct;null==Et&&(Et=0),null==Dt&&(Dt=0),Z=Dt,O=Et,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f,_,k,I,P,L,Z,O)},drawString:function(e,t,i){this.imagePainter.end();var r=this.coloredPainter;pt.triangleBufferIndex>0&&r.drawTriBuffer(!1),pt.bufferIndex>0&&r.drawBuffer(!1),this.textPainter.drawString(e,this.get_opacity(),this.get_color(),t,i,this.transformations[this.transformationIndex])},set_font:function(e){return this.textPainter.setFont(e),this.myFont=e},set_fontSize:function(e){return Qe.prototype.set_fontSize.call(this,this.textPainter.fontSize=e)},begin:function(e,t){if(null==e&&(e=!0),null!=bt.current)throw new M("End before you begin");bt.current=this,this.g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;pt.triangleBufferIndex>0&&e.drawTriBuffer(!1),pt.bufferIndex>0&&e.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),bt.current!=this)throw new M("Begin before you end");bt.current=null},__class__:bt});var wt=function(e,t,i){null==i&&(i=!1),this.lockEnd=0,this.lockStart=0,this.usage=t,this.mySize=e,this.buffer=ge.gl.createBuffer();var r=new Uint32Array(e);this._data=r};r["kha.graphics4.IndexBuffer"]=wt,wt.__name__=!0,wt.prototype={buffer:null,_data:null,mySize:null,usage:null,lockStart:null,lockEnd:null,lock:function(e,t){return this.lockStart=null!=e?e:0,this.lockEnd=null!=t?e+t:this.mySize,this._data.subarray(this.lockStart,this.lockEnd)},unlock:function(e){null!=e&&(this.lockEnd=this.lockStart+e),ge.gl.bindBuffer(34963,this.buffer);var t=this._data.subarray(this.lockStart,this.lockEnd),i=null==ge.elementIndexUint?new Uint16Array(t):t;ge.gl.bufferData(34963,i,1==this.usage?35048:35044)},set:function(){ge.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:wt};var yt=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=kt.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};r["kha.graphics4.PipelineStateBase"]=yt,yt.__name__=!0,yt.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,conservativeRasterization:null,__class__:yt};var xt=function(){this.program=null,yt.call(this),this.textures=[],this.textureValues=[]};r["kha.graphics4.PipelineState"]=xt,xt.__name__=!0,xt.__super__=yt,xt.prototype=s(yt.prototype,{program:null,textures:null,textureValues:null,compile:function(){null!=this.program&&ge.gl.deleteProgram(this.program),this.program=ge.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),ge.gl.attachShader(this.program,this.vertexShader.shader),ge.gl.attachShader(this.program,this.fragmentShader.shader);for(var e=0,t=0,i=this.inputLayout;t<i.length;){var r=i[t];++t;for(var n=0,a=r.elements;n<a.length;){var s=a[n];++n,ge.gl.bindAttribLocation(this.program,e,s.name),4==s.data?e+=4:++e}}if(ge.gl.linkProgram(this.program),!ge.gl.getProgramParameter(this.program,35714))throw new M("Could not link the shader program:\n"+ge.gl.getProgramInfoLog(this.program))},set:function(){ge.gl.useProgram(this.program);for(var e=0,t=this.textureValues.length;e<t;){var i=e++;ge.gl.uniform1i(this.textureValues[i],i)}ge.gl.colorMask(this.colorWriteMasksRed[0],this.colorWriteMasksGreen[0],this.colorWriteMasksBlue[0],this.colorWriteMasksAlpha[0])},compileShader:function(e){if(null==e.shader){for(var t=ge.gl.createShader(e.type),i=0!=ge.gl.getShaderPrecisionFormat(35632,36338).precision,r=e.files,n=0,a=r.length;n<a;){var s=n++;if(ge.gl2){if(r[s].indexOf("-webgl2")>=0||r[s].indexOf("runtime-string")>=0){ge.gl.shaderSource(t,e.sources[s]);break}}else{if(!i&&(r[s].indexOf("-relaxed")>=0||r[s].indexOf("runtime-string")>=0)){ge.gl.shaderSource(t,e.sources[s]);break}if(i&&(r[s].indexOf("-relaxed")<0||r[s].indexOf("runtime-string")>=0)){ge.gl.shaderSource(t,e.sources[s]);break}}}if(ge.gl.compileShader(t),!ge.gl.getShaderParameter(t,35713))throw new M("Could not compile shader:\n"+ge.gl.getShaderInfoLog(t));e.shader=t}},getConstantLocation:function(e){var t=ge.gl.getUniformLocation(this.program,e);null==t&&b.trace("Warning: Uniform "+e+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var i=5126,r=0,n=ge.gl.getProgramParameter(this.program,35718);r<n;){var a=r++,s=ge.gl.getActiveUniform(this.program,a);if(s.name==e||s.name==e+"[0]"){i=s.type;break}}return new Qt(t,i)},getTextureUnit:function(e){var t=this.findTexture(e);if(t<0){var i=ge.gl.getUniformLocation(this.program,e);null==i&&b.trace("Warning: Sampler "+e+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),t=this.textures.length,this.textureValues.push(i),this.textures.push(e)}return new $t(t)},findTexture:function(e){for(var t=0,i=this.textures.length;t<i;){var r=t++;if(this.textures[r]==e)return r}return-1},__class__:xt});var kt=a["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:n},Static:(i=function(e){return{_hx_index:1,value:e,__enum__:"kha.graphics4.StencilValue",toString:n}},i.__params__=["value"],i)},It=function(){};r["kha.graphics4.TessellationControlShader"]=It,It.__name__=!0;var Bt=function(){};r["kha.graphics4.TessellationEvaluationShader"]=Bt,Bt.__name__=!0;var St=function(){};r["kha.graphics4.TextureUnit"]=St,St.__name__=!0,St.__isInterface__=!0;var At=function(e,t,i,r,n){null==n&&(n=!1),null==r&&(r=0),this.lockEnd=0,this.lockStart=0,this.usage=i,this.instanceDataStepRate=r,this.mySize=e,this.myStride=0;for(var a=0,s=t.elements;a<s.length;){var o=s[a];switch(++a,o.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64;break;case 5:this.myStride+=4;break;case 6:this.myStride+=8}}this.buffer=ge.gl.createBuffer();var l=new Float32Array(e*this.myStride/4|0);this._data=l,this.sizes=[],this.offsets=[],this.types=[],this.sizes[t.elements.length-1]=0,this.offsets[t.elements.length-1]=0,this.types[t.elements.length-1]=0;for(var u=0,h=0,d=0,c=t.elements;d<c.length;){var f,_,g=c[d];switch(++d,g.data){case 0:f=1,_=5126;break;case 1:f=2,_=5126;break;case 2:f=3,_=5126;break;case 3:f=4,_=5126;break;case 4:f=16,_=5126;break;case 5:f=2,_=5122;break;case 6:f=4,_=5122}switch(this.sizes[h]=f,this.offsets[h]=u,this.types[h]=_,g.data){case 0:u+=4;break;case 1:u+=8;break;case 2:u+=12;break;case 3:u+=16;break;case 4:u+=64;break;case 5:u+=4;break;case 6:u+=8}++h}};r["kha.graphics4.VertexBuffer"]=At,At.__name__=!0,At.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,types:null,usage:null,instanceDataStepRate:null,lockStart:null,lockEnd:null,lock:function(e,t){return this.lockStart=null!=e?e:0,this.lockEnd=null!=t?e+t:this.mySize,this._data.subarray(this.lockStart*this.stride(),this.lockEnd*this.stride())},unlock:function(e){null!=e&&(this.lockEnd=this.lockStart+e),ge.gl.bindBuffer(34962,this.buffer),ge.gl.bufferData(34962,this._data.subarray(this.lockStart*this.stride(),this.lockEnd*this.stride()),1==this.usage?35048:35044)},stride:function(){return this.myStride},set:function(e){var t=!!ge.gl2||ge.gl.getExtension("ANGLE_instanced_arrays");ge.gl.bindBuffer(34962,this.buffer);for(var i=0,r=0,n=this.sizes.length;r<n;){var a=r++;if(this.sizes[a]>4)for(var s=this.sizes[a],o=0;s>0;)ge.gl.enableVertexAttribArray(e+i),ge.gl.vertexAttribPointer(e+i,4,5126,!1,this.myStride,this.offsets[a]+o),t&&(ge.gl2?ge.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),s-=4,o+=16,++i;else{var l=5126!=this.types[a];ge.gl.enableVertexAttribArray(e+i),ge.gl.vertexAttribPointer(e+i,this.sizes[a],this.types[a],l,this.myStride,this.offsets[a]),t&&(ge.gl2?ge.gl.vertexAttribDivisor(e+i,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+i,this.instanceDataStepRate)),++i}}return i},__class__:At};var Tt=function(e,t){this.name=e,this.data=t};r["kha.graphics4.VertexElement"]=Tt,Tt.__name__=!0,Tt.prototype={name:null,data:null,__class__:Tt};var Nt=function(e,t){this.sources=[];for(var i=0;i<e.length;){var r=e[i];++i,this.sources.push(r.toString())}this.type=35633,this.shader=null,this.files=t};r["kha.graphics4.VertexShader"]=Nt,Nt.__name__=!0,Nt.prototype={sources:null,type:null,shader:null,files:null,__class__:Nt};var Ct=function(){this.elements=[],this.instanced=!1};r["kha.graphics4.VertexStructure"]=Ct,Ct.__name__=!0,Ct.prototype={elements:null,instanced:null,add:function(e,t){this.elements.push(new Tt(e,t))},size:function(){return this.elements.length},get:function(e){return this.elements[e]},__class__:Ct};var Dt=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],Dt.instances[e]=this};r["kha.input.Gamepad"]=Dt,Dt.__name__=!0,Dt.get=function(e){return null==e&&(e=0),e>=Dt.instances.length?null:Dt.instances[e]},Dt.notifyOnConnect=function(e,t){null!=e&&Dt.connectListeners.push(e),null!=t&&Dt.disconnectListeners.push(t)},Dt.removeConnect=function(e,t){null!=e&&u.remove(Dt.connectListeners,e),null!=t&&u.remove(Dt.disconnectListeners,t)},Dt.sendConnectEvent=function(e){Dt.instances[e].connected=!0;for(var t=0,i=Dt.connectListeners;t<i.length;){var r=i[t];++t,r(e)}},Dt.sendDisconnectEvent=function(e){Dt.instances[e].connected=!1;for(var t=0,i=Dt.disconnectListeners;t<i.length;){var r=i[t];++t,r(e)}},Dt.prototype={index:null,notify:function(e,t){null!=e&&this.axisListeners.push(e),null!=t&&this.buttonListeners.push(t)},remove:function(e,t){null!=e&&u.remove(this.axisListeners,e),null!=t&&u.remove(this.buttonListeners,t)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return ge.getGamepadId(this.index)},sendAxisEvent:function(e,t){for(var i=0,r=this.axisListeners;i<r.length;){var n=r[i];++i,n(e,t)}},sendButtonEvent:function(e,t){for(var i=0,r=this.buttonListeners;i<r.length;){var n=r[i];++i,n(e,t)}},__class__:Dt};var Et=a["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:n},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:n},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:n},Custom:(i=function(e){return{_hx_index:3,func:e,__enum__:"kha.input.BlockInterventions",toString:n}},i.__params__=["func"],i)},Pt=function(){this.__id=ni.nextId++,this._inputBuffer=new x(new ArrayBuffer(1))};r["kha.netsync.Controller"]=Pt,Pt.__name__=!0,Pt.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:Pt};var Lt=e.kha.input.Keyboard=function(){Pt.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Lt.instance=this};r["kha.input.Keyboard"]=Lt,Lt.__name__=!0,Lt.get=function(e){return null==e&&(e=0),ge.getKeyboard(e)},Lt.disableSystemInterventions=function(e){Lt.keyBehavior=e},Lt.__super__=Pt,Lt.prototype=s(Pt.prototype,{notify:function(e,t,i){null!=e&&this.downListeners.push(e),null!=t&&this.upListeners.push(t),null!=i&&this.pressListeners.push(i)},remove:function(e,t,i){null!=e&&u.remove(this.downListeners,e),null!=t&&u.remove(this.upListeners,t),null!=i&&u.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(e){if(null!=ai.the()){var t=new x(new ArrayBuffer(5));t.setInt32(0,0),t.b[4]=e,ai.the().sendControllerUpdate(this._id(),t)}for(var i=0,r=this.downListeners;i<r.length;){var n=r[i];++i,n(e)}},sendUpEvent:function(e){if(null!=ai.the()){var t=new x(new ArrayBuffer(5));t.setInt32(0,1),t.b[4]=e,ai.the().sendControllerUpdate(this._id(),t)}for(var i=0,r=this.upListeners;i<r.length;){var n=r[i];++i,n(e)}},sendPressEvent:function(e){if(null!=ai.the()){var t=new x(new ArrayBuffer(5));t.setInt32(0,2),t.b[4]=u.cca(e,0),ai.the().sendControllerUpdate(this._id(),t)}for(var i=0,r=this.pressListeners;i<r.length;){var n=r[i];++i,n(e)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t);else{var i=e.b[4],r=String.fromCodePoint(i);this.sendPressEvent(r)}else{var n=e.b[4];this.sendUpEvent(n)}else{var a=e.b[4];this.sendDownEvent(a)}},__class__:Lt});var Vt=e.kha.input.Mouse=function(){Pt.call(this),Vt.instance=this};r["kha.input.Mouse"]=Vt,Vt.__name__=!0,Vt.get=function(e){return null==e&&(e=0),ge.getMouse(e)},Vt.__super__=Pt,Vt.prototype=s(Pt.prototype,{notify:function(e,t,i,r,n){this.notifyWindowed(0,e,t,i,r,n)},remove:function(e,t,i,r,n){this.removeWindowed(0,e,t,i,r,n)},notifyWindowed:function(e,t,i,r,n,a){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(i)}if(null!=r){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(r)}if(null!=n){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(n)}if(null!=a){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(a)}},removeWindowed:function(e,t,i,r,n,a){null!=t&&(null!=this.windowDownListeners?e<this.windowDownListeners.length?u.remove(this.windowDownListeners[e],t):b.trace('no downListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):b.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?e<this.windowUpListeners.length?u.remove(this.windowUpListeners[e],i):b.trace('no upListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):b.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowMoveListeners?e<this.windowMoveListeners.length?u.remove(this.windowMoveListeners[e],r):b.trace('no moveListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):b.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowWheelListeners?e<this.windowWheelListeners.length?u.remove(this.windowWheelListeners[e],n):b.trace('no wheelListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):b.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=a&&(null!=this.windowLeaveListeners?e<this.windowLeaveListeners.length?u.remove(this.windowLeaveListeners[e],a):b.trace('no leaveListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):b.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(e,t){},removeFromLockChange:function(e,t){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(e){if(null!=ai.the()){var t=new x(new ArrayBuffer(8));t.setInt32(0,0),t.setInt32(4,e),ai.the().sendControllerUpdate(this._id(),t)}if(null!=this.windowLeaveListeners)for(var i=0,r=this.windowLeaveListeners[e];i<r.length;){var n=r[i];++i,n()}},sendDownEvent:function(e,t,i,r){if(null!=ai.the()){var n=new x(new ArrayBuffer(20));n.setInt32(0,1),n.setInt32(4,e),n.setInt32(8,t),n.setInt32(12,i),n.setInt32(16,r),ai.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowDownListeners)for(var a=0,s=this.windowDownListeners[e];a<s.length;){var o=s[a];++a,o(t,i,r)}},sendUpEvent:function(e,t,i,r){if(null!=ai.the()){var n=new x(new ArrayBuffer(20));n.setInt32(0,2),n.setInt32(4,e),n.setInt32(8,t),n.setInt32(12,i),n.setInt32(16,r),ai.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowUpListeners)for(var a=0,s=this.windowUpListeners[e];a<s.length;){var o=s[a];++a,o(t,i,r)}},sendMoveEvent:function(e,t,i,r,n){if(null!=ai.the()){var a=new x(new ArrayBuffer(24));a.setInt32(0,3),a.setInt32(4,e),a.setInt32(8,t),a.setInt32(12,i),a.setInt32(16,r),a.setInt32(20,n),ai.the().sendControllerUpdate(this._id(),a)}if(null!=this.windowMoveListeners)for(var s=0,o=this.windowMoveListeners[e];s<o.length;){var l=o[s];++s,l(t,i,r,n)}},sendWheelEvent:function(e,t){if(null!=ai.the()){var i=new x(new ArrayBuffer(12));i.setInt32(0,4),i.setInt32(4,e),i.setInt32(8,t),ai.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowWheelListeners)for(var r=0,n=this.windowWheelListeners[e];r<n.length;){var a=n[r];++r,a(t)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t)if(3!=t)if(4!=t);else{var i=e.getInt32(4),r=e.getInt32(8);this.sendWheelEvent(i,r)}else{var n=e.getInt32(4),a=e.getInt32(8),s=e.getInt32(12),o=e.getInt32(16),l=e.getInt32(20);this.sendMoveEvent(n,a,s,o,l)}else{var u=e.getInt32(4),h=e.getInt32(8),d=e.getInt32(12),c=e.getInt32(16);this.sendUpEvent(u,h,d,c)}else{var f=e.getInt32(4),_=e.getInt32(8),g=e.getInt32(12),m=e.getInt32(16);this.sendDownEvent(f,_,g,m)}else{var p=e.getInt32(4);this.sendLeaveEvent(p)}},__class__:Vt});var Ft=function(){Vt.call(this)};r["kha.input.MouseImpl"]=Ft,Ft.__name__=!0,Ft.__super__=Vt,Ft.prototype=s(Vt.prototype,{lock:function(){ge.lockMouse()},unlock:function(){ge.unlockMouse()},canLock:function(){return ge.canLockMouse()},isLocked:function(){return ge.isMouseLocked()},notifyOnLockChange:function(e,t){ge.notifyOfMouseLockChange(e,t)},removeFromLockChange:function(e,t){ge.removeFromMouseLockChange(e,t)},hideSystemCursor:function(){ge.khanvas.style.cursor="none"},showSystemCursor:function(){ge.khanvas.style.cursor="default"},_receive:function(e){e.getInt32(0)},__class__:Ft});var Wt=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],Wt.instance=this};r["kha.input.Surface"]=Wt,Wt.__name__=!0,Wt.get=function(e){return null==e&&(e=0),0!=e?null:Wt.instance},Wt.prototype={notify:function(e,t,i){null!=e&&this.touchStartListeners.push(e),null!=t&&this.touchEndListeners.push(t),null!=i&&this.moveListeners.push(i)},remove:function(e,t,i){null!=e&&u.remove(this.touchStartListeners,e),null!=t&&u.remove(this.touchEndListeners,t),null!=i&&u.remove(this.moveListeners,i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(e,t,i){for(var r=0,n=this.touchStartListeners;r<n.length;){var a=n[r];++r,a(e,t,i)}},sendTouchEndEvent:function(e,t,i){for(var r=0,n=this.touchEndListeners;r<n.length;){var a=n[r];++r,a(e,t,i)}},sendMoveEvent:function(e,t,i){for(var r=0,n=this.moveListeners;r<n.length;){var a=n[r];++r,a(e,t,i)}},__class__:Wt};var Mt=function(e){this.bytes=e};r["kha.internal.BytesBlob"]=Mt,Mt.__name__=!0,Mt.__interfaces__=[K],Mt.fromBytes=function(e){return new Mt(e)},Mt.alloc=function(e){return new Mt(new x(new ArrayBuffer(e)))},Mt.prototype={bytes:null,length:null,get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=t},readU8:function(e){var t=this.bytes.b[e];return++e,t},toString:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},__class__:Mt};var Rt=function(){};r["kha.internal.HdrFormat"]=Rt,Rt.__name__=!0,Rt.readBuf=function(e){for(var t=0;e[t++]=Rt.buffer[Rt.fileOffset],++Rt.fileOffset<Rt.bufferLength&&t<e.length;);return t},Rt.readBufOffset=function(e,t,i){for(var r=0;e[t+r++]=Rt.buffer[Rt.fileOffset],++Rt.fileOffset<Rt.bufferLength&&r<i;);return r},Rt.readPixelsRaw=function(e,t,i,r){var n=4*r,a=Rt.readBufOffset(t,i,n);a<n&&b.trace("Error reading raw pixels: got "+a+" bytes, expected "+n,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},Rt.readPixelsRawRLE=function(e,t,i,r,n){var a,s,o,l=new Uint8Array(4),u=null,h=new Uint8Array(2);for(e.length;n>0;){if(Rt.readBuf(l)<l.length)return void b.trace("Error reading bytes: expected "+l.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=l[0]||2!=l[1]||0!=(128&l[2]))return t[i++]=l[0],t[i++]=l[1],t[i++]=l[2],t[i++]=l[3],void Rt.readPixelsRaw(e,t,i,r*n-1);if(((255&l[2])<<8|255&l[3])!=r)return void b.trace("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+r,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==u)u=new Uint8Array(4*r);a=0;for(var d=0;d<4;){for(s=(d+++1)*r;a<s;){if(Rt.readBuf(h)<h.length)return void b.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if((255&h[0])>128){if(0==(o=(255&h[0])-128)||o>s-a)return void b.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;o-- >0;)u[a++]=h[1]}else{if(0==(o=255&h[0])||o>s-a)return void b.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(u[a++]=h[1],--o>0){if(Rt.readBufOffset(u,a,o)<o)return void b.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});a+=o}}}}for(var c=0,f=r;c<f;){var _=c++;t[i]=u[_],t[i+1]=u[_+r],t[i+2]=u[_+2*r],t[i+3]=u[_+3*r],i+=4}--n}},Rt.readLine=function(){for(var e="";;){var t=Rt.buffer[Rt.fileOffset];if(10==t){++Rt.fileOffset;break}if(e+=String.fromCodePoint(t),!(++Rt.fileOffset<Rt.bufferLength))break}return e},Rt.parse=function(e){Rt.buffer=W.fromBytes(e),Rt.bufferLength=Rt.buffer.length,Rt.fileOffset=0;for(var t=0,i=0,r=!1,n=0;n<20;){n++;var a=Rt.readLine();if(Rt.formatPattern.match(a))r=!0;else if(Rt.exposurePattern.match(a))parseFloat(Rt.exposurePattern.matched(1));else if(Rt.widthHeightPattern.match(a)){i=f.parseInt(Rt.widthHeightPattern.matched(1)),t=f.parseInt(Rt.widthHeightPattern.matched(2));break}}if(!r)return b.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var s=new Uint8Array(t*i*4),o=t,l=i;Rt.readPixelsRawRLE(Rt.buffer,s,0,o,l);for(var u=new Float32Array(t*i*4),h=0;h<s.length;){var d=s[h]/255,c=s[h+1]/255,_=s[h+2]/255,g=s[h+3],m=Math.pow(2,g-128);d*=m,c*=m,_*=m,u[h]=d,u[h+1]=c,u[h+2]=_,u[h+3]=1,h+=4}return{width:t,height:i,data:u}};var Gt=function(e,t){this.stopped=!1,this.element=e,this.looping=t};r["kha.js.AEAudioChannel"]=Gt,Gt.__name__=!0,Gt.__interfaces__=[we],Gt.prototype={element:null,stopped:null,looping:null,play:function(){this.stopped=!1,this.element.play()},length:null,get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},set_position:function(e){return this.element.currentTime=e},__class__:Gt};var Ht=function(){};r["kha.js.AudioElementAudio"]=Ht,Ht.__name__=!0,Ht.play=function(e,t){return null==t&&(t=!1),Ht.stream(e,t)},Ht.stream=function(e,t){null==t&&(t=!1),e.element.loop=t;var i=new Gt(e.element,t);return i.play(),i};var Ut=function(e){this.bakedQuadCache=new te,Qe.call(this),this.canvas=e,Ut.instance=this,this.myColor=Q.fromBytes(0,0,0)};r["kha.js.CanvasGraphics"]=Ut,Ut.__name__=!0,Ut.__super__=Qe,Ut.prototype=s(Qe.prototype,{canvas:null,webfont:null,myColor:null,begin:function(e,t){null==e&&(e=!0),e&&this.clear(t)},clear:function(e){null==e&&(e=0),this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",.00392156862745098*(e>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(e,t,i){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(R.__cast(e,Y).image,t,i),this.canvas.globalAlpha=1},drawScaledSubImage:function(e,t,i,r,n,a,s,o,l){this.canvas.globalAlpha=this.get_opacity();try{if(o<0||l<0){this.canvas.save(),this.canvas.translate(a,s);var u=0,h=0;o<0&&(this.canvas.scale(-1,1),u=-o),l<0&&(this.canvas.scale(1,-1),h=-l),this.canvas.drawImage(R.__cast(e,Y).image,t,i,r,n,u,h,o,l),this.canvas.restore()}else this.canvas.drawImage(R.__cast(e,Y).image,t,i,r,n,a,s,o,l)}catch(e){e instanceof M&&e.val}this.canvas.globalAlpha=1},set_color:function(e){return this.myColor=e,this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",e},drawRect:function(e,t,i,r,n){null==n&&(n=1),this.canvas.beginPath();var a=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(n),this.canvas.rect(e,t,i,r),this.canvas.stroke(),this.canvas.lineWidth=a},bakedQuadCache:null,drawString:function(e,t,i){var r=this.webfont.getImage(this.get_fontSize(),this.myColor);if(r.width>0)for(var n=t,a=i,s=0,o=e.length;s<o;){var l=s++,h=this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,Qe.fontGlyphs.indexOf(u.cca(e,l)),n,a);null!=h&&(h.s1-h.s0>0&&h.t1-h.t0>0&&h.x1-h.x0>0&&h.y1-h.y0>0&&this.canvas.drawImage(r,h.s0*r.width,h.t0*r.height,(h.s1-h.s0)*r.width,(h.t1-h.t0)*r.height,h.x0,h.y0,h.x1-h.x0,h.y1-h.y0),n+=h.xadvance)}},set_font:function(e){return this.webfont=R.__cast(e,Zt),this.webfont},setTransformation:function(e){this.canvas.setTransform(e._00,e._01,e._10,e._11,e._20,e._21)},__class__:Ut});var Zt=function(e){this.images=new I,this.kravur=new Zt.Kravur(e)};r["kha.js.Font"]=Zt,Zt.__name__=!0,Zt.__interfaces__=[K],Zt.prototype={kravur:null,images:null,getImage:function(e,t){var i=1e4*e+Qe.fontGlyphs.length;if(!this.images.h.hasOwnProperty(i)){var r=this.images,n=new I;r.h[i]=n}if(!this.images.h[i].h.hasOwnProperty(t)){var a=this.kravur._get(e),s=window.document.createElement("canvas");s.width=a.width,s.height=a.height;var o=s.getContext("2d");o.fillStyle="black",o.fillRect(0,0,a.width,a.height);for(var l=o.getImageData(0,0,a.width,a.height),u=R.__cast(a.getTexture(),Y).bytes,h=0,d=u.length;h<d;){var c=h++;l.data[4*c]=(16711680&t)>>>16,l.data[4*c+1]=(65280&t)>>>8,l.data[4*c+2]=255&t,l.data[4*c+3]=u.b[c]}o.putImageData(l,0,0);var f=window.document.createElement("img");return f.src=s.toDataURL("image/png"),this.images.h[i].h[t]=f,f}return this.images.h[i].h[t]},__class__:Zt};var Ot=function(){};r["kha.js.MobileWebAudio"]=Ot,Ot.__name__=!0,Ot._init=function(){try{return void(Ot._context=new AudioContext)}catch(e){e instanceof M&&e.val}try{return void(this._context=new webkitAudioContext)}catch(e){e instanceof M&&e.val}},Ot.play=function(e,t){null==t&&(t=!1);var i=new zt(e,t);return i.play(),i},Ot.stream=function(e,t){return null==t&&(t=!1),Ot.play(e,t)};var zt=function(e,t){this.stopped=!1,this.paused=!1,this.buffer=e._buffer,this.loop=t,this.createSource()};r["kha.js.MobileWebAudioChannel"]=zt,zt.__name__=!0,zt.__interfaces__=[we],zt.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var e=this;this.source=Ot._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){e.stopped=!0},this.gain=Ot._context.createGain(),this.source.connect(this.gain),this.gain.connect(Ot._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=Ot._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=Ot._context.currentTime,this.source.start())},__class__:zt};var Xt=function(e,t,i){var r=this;de.call(this);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onerror=function(){i({url:e})},n.onload=function(){r.compressedData=x.ofData(n.response),r.uncompressedData=null,Ot._context.decodeAudioData(r.compressedData.b.bufferValue,function(e){r.length=e.duration,r.channels=e.numberOfChannels,r._buffer=e,t(r)},function(){i({url:e,error:"Audio format not supported"})})},n.send(null)};r["kha.js.MobileWebAudioSound"]=Xt,Xt.__name__=!0,Xt.__super__=de,Xt.prototype=s(de.prototype,{_buffer:null,uncompress:function(e){e()},__class__:Xt});var Kt=function(e,t,i){de.call(this),this.done=t,this.failed=i,Kt.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var r=0;r<e.length;){var n=e[r];++r,""!=this.element.canPlayType("audio/ogg")&&_.endsWith(n,".ogg")&&this.filenames.push(n),""!=this.element.canPlayType("audio/mp4")&&_.endsWith(n,".mp4")&&this.filenames.push(n),""!=this.element.canPlayType("audio/wav")&&_.endsWith(n,".wav")&&this.filenames.push(n)}this.element.addEventListener("error",ui(this,this.errorListener),!1),this.element.addEventListener("canplay",ui(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};r["kha.js.Sound"]=Kt,Kt.__name__=!0,Kt.__super__=de,Kt.prototype=s(de.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var r=t++;if(this.element.src==this.filenames[r])return void(this.element.src=this.filenames[r+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ui(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ui(this,this.canPlayThroughListener),!1),this.done(this),u.remove(Kt.loading,this)},uncompress:function(e){e()},__class__:Kt});var jt=function(){me.call(this)};r["kha.js.Video"]=jt,jt.__name__=!0,jt.fromFile=function(e,t){var i=new jt;i.done=t,i.element=window.document.createElement("video"),i.filenames=[];for(var r=0;r<e.length;){var n=e[r];++r,""!=i.element.canPlayType("video/webm")&&_.endsWith(n,".webm")&&i.filenames.push(n),""!=i.element.canPlayType("video/mp4")&&_.endsWith(n,".mp4")&&i.filenames.push(n)}i.element.addEventListener("error",ui(i,i.errorListener),!1),i.element.addEventListener("canplaythrough",ui(i,i.canPlayThroughListener),!1),i.element.preload="auto",i.element.src=i.filenames[0]},jt.__super__=me,jt.prototype=s(me.prototype,{filenames:null,element:null,done:null,texture:null,errorListener:function(e){if(4==this.element.error.code)for(var t=0,i=this.filenames.length-1;t<i;){var r=t++;if(this.element.src==this.filenames[r])return void(this.element.src=this.filenames[r+1])}b.trace("Error loading "+this.element.src,{fileName:"kha/js/Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ui(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ui(this,this.canPlayThroughListener),!1),null!=ge.gl&&(this.texture=j.fromVideo(this)),this.done(this)},__class__:jt});var Yt=function(e,t,i){var r=this;de.call(this);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onerror=function(){i({url:e})},n.onload=function(){r.compressedData=x.ofData(n.response),r.uncompressedData=null,t(r)},n.send(null)};r["kha.js.WebAudioSound"]=Yt,Yt.__name__=!0,Yt.__super__=de,Yt.prototype=s(de.prototype,{superUncompress:function(e){de.prototype.uncompress.call(this,e)},uncompress:function(e){var t=this;xe._context.decodeAudioData(this.compressedData.b.bufferValue,function(i){var r=i.getChannelData(0),n=1==i.numberOfChannels?r:i.getChannelData(1),a=r.length,s=new Float32Array(2*a);t.uncompressedData=s,t.length=i.duration,t.channels=i.numberOfChannels,t.sampleRate=Math.round(i.sampleRate);var o=0,l=0,u=2*a,h=null;(h=function(){for(var i=o+11025,a=i>u?u:i;o<a;)t.uncompressedData[o]=r[l],t.uncompressedData[o+1]=n[l],o+=2,l+=1;o<u?window.setTimeout(h,0):(t.compressedData=null,e())})()},function(){t.superUncompress(e)})},__class__:Yt});var Qt=function(e,t){this.value=e,this.type=t};r["kha.js.graphics4.ConstantLocation"]=Qt,Qt.__name__=!0,Qt.__interfaces__=[ht],Qt.prototype={value:null,type:null,__class__:Qt};var Jt=function(e){this.matrixCache=new Float32Array(16),this.useVertexAttributes=0,this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.currentPipeline=null,this.renderTarget=e,this.init(),ge.gl2?this.instancedExtension=!0:(this.instancedExtension=ge.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=ge.gl.getExtension("EXT_blend_minmax"))};r["kha.js.graphics4.Graphics"]=Jt,Jt.__name__=!0,Jt.__interfaces__=[_t],Jt.getBlendFunc=function(e){switch(e){case 1:return 1;case 0:case 2:return 0;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},Jt.getBlendOp=function(e){switch(e){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},Jt.prototype={currentPipeline:null,depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetMSAA:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,useVertexAttributes:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof dt,this.isCubeMap){var e=R.__cast(this.renderTarget,dt);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture,this.isDepthAttachment=e.isDepthAttachment}else{var t=R.__cast(this.renderTarget,pe);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetMSAA=t.MSAAFrameBuffer,this.renderTargetTexture=t.texture}},begin:function(e){if(ge.gl.enable(3042),ge.gl.blendFunc(770,771),null==this.renderTarget)ge.gl.bindFramebuffer(36160,null),ge.gl.viewport(0,0,fe.windowWidth(),fe.windowHeight());else if(ge.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),ge.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=e){ge.gl.framebufferTexture2D(36160,ge.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var t=0,i=e.length;t<i;){var r=t++;ge.gl.framebufferTexture2D(36160,ge.drawBuffers.COLOR_ATTACHMENT0_WEBGL+r+1,3553,R.__cast(e[r],pe).texture,0)}for(var n=[ge.drawBuffers.COLOR_ATTACHMENT0_WEBGL],a=0,s=e.length;a<s;){var o=a++;n.push(ge.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}ge.gl2?ge.gl.drawBuffers(n):ge.drawBuffers.drawBuffersWEBGL(n)}},end:function(){null!=this.renderTargetMSAA&&(ge.gl.bindFramebuffer(ge.gl.READ_FRAMEBUFFER,this.renderTargetFrameBuffer),ge.gl.bindFramebuffer(ge.gl.DRAW_FRAMEBUFFER,this.renderTargetMSAA),ge.gl.blitFramebuffer(0,0,this.renderTarget.get_width(),this.renderTarget.get_height(),0,0,this.renderTarget.get_width(),this.renderTarget.get_height(),16384,9728))},clear:function(e,t,i){var r=0;null!=e&&(r|=16384,ge.gl.colorMask(!0,!0,!0,!0),ge.gl.clearColor(.00392156862745098*((16711680&e)>>>16),.00392156862745098*((65280&e)>>>8),.00392156862745098*(255&e),.00392156862745098*(e>>>24))),null!=t&&(r|=256,ge.gl.enable(2929),ge.gl.depthMask(!0),ge.gl.clearDepth(t)),null!=i&&(r|=1024,ge.gl.enable(2960),ge.gl.stencilMask(255),ge.gl.clearStencil(i)),ge.gl.clear(r),ge.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?ge.gl.enable(2929):ge.gl.disable(2929),ge.gl.depthMask(this.depthMask)},setDepthMode:function(e,t){switch(t){case 0:e?ge.gl.enable(2929):ge.gl.disable(2929),this.depthTest=e,ge.gl.depthFunc(519);break;case 1:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(512);break;case 2:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(514);break;case 3:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(517);break;case 4:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(513);break;case 5:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(515);break;case 6:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(516);break;case 7:ge.gl.enable(2929),this.depthTest=!0,ge.gl.depthFunc(518)}ge.gl.depthMask(e),this.depthMask=e},setBlendingMode:function(e,t,i,r,n,a){1==e&&2==t?ge.gl.disable(3042):(ge.gl.enable(3042),ge.gl.blendFuncSeparate(Jt.getBlendFunc(e),Jt.getBlendFunc(t),Jt.getBlendFunc(r),Jt.getBlendFunc(n)),ge.gl.blendEquationSeparate(Jt.getBlendOp(i),Jt.getBlendOp(a)))},setVertexBuffer:function(e){this.useVertexAttributes=R.__cast(e,At).set(0)},setIndexBuffer:function(e){this.indicesCount=e.count(),R.__cast(e,wt).set()},setTexture:function(e,t){null==t?(ge.gl.activeTexture(33984+R.__cast(e,$t).value),ge.gl.bindTexture(3553,null)):R.__cast(t,pe).set(R.__cast(e,$t).value)},setTextureParameters:function(e,t,i,r,n,a){switch(ge.gl.activeTexture(33984+R.__cast(e,$t).value),t){case 0:ge.gl.texParameteri(3553,10242,10497);break;case 1:ge.gl.texParameteri(3553,10242,33648);break;case 2:ge.gl.texParameteri(3553,10242,33071)}switch(i){case 0:ge.gl.texParameteri(3553,10243,10497);break;case 1:ge.gl.texParameteri(3553,10243,33648);break;case 2:ge.gl.texParameteri(3553,10243,33071)}switch(r){case 0:switch(a){case 0:ge.gl.texParameteri(3553,10241,9728);break;case 1:ge.gl.texParameteri(3553,10241,9984);break;case 2:ge.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(a){case 0:ge.gl.texParameteri(3553,10241,9729);break;case 1:ge.gl.texParameteri(3553,10241,9985);break;case 2:ge.gl.texParameteri(3553,10241,9987)}2==r&&ge.gl.texParameteri(3553,ge.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(n){case 0:ge.gl.texParameteri(3553,10240,9728);break;case 1:case 2:ge.gl.texParameteri(3553,10240,9729)}},setCullMode:function(e){switch(e){case 0:ge.gl.enable(2884),ge.gl.cullFace(1029);break;case 1:ge.gl.enable(2884),ge.gl.cullFace(1028);break;case 2:ge.gl.disable(2884)}},setPipeline:function(e){this.setCullMode(e.cullMode),this.setDepthMode(e.depthWrite,e.depthMode),this.setStencilParameters(e.stencilMode,e.stencilBothPass,e.stencilDepthFail,e.stencilFail,e.stencilReferenceValue,e.stencilReadMask,e.stencilWriteMask),this.setBlendingMode(e.blendSource,e.blendDestination,e.blendOperation,e.alphaBlendSource,e.alphaBlendDestination,e.alphaBlendOperation),this.currentPipeline=e,e.set(),this.colorMaskRed=e.colorWriteMasksRed[0],this.colorMaskGreen=e.colorWriteMasksGreen[0],this.colorMaskBlue=e.colorWriteMasksBlue[0],this.colorMaskAlpha=e.colorWriteMasksAlpha[0]},matrixCache:null,setMatrix:function(e,t){this.matrixCache[0]=t._00,this.matrixCache[1]=t._01,this.matrixCache[2]=t._02,this.matrixCache[3]=t._03,this.matrixCache[4]=t._10,this.matrixCache[5]=t._11,this.matrixCache[6]=t._12,this.matrixCache[7]=t._13,this.matrixCache[8]=t._20,this.matrixCache[9]=t._21,this.matrixCache[10]=t._22,this.matrixCache[11]=t._23,this.matrixCache[12]=t._30,this.matrixCache[13]=t._31,this.matrixCache[14]=t._32,this.matrixCache[15]=t._33,ge.gl.uniformMatrix4fv(R.__cast(e,Qt).value,!1,this.matrixCache)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0);var i=null==ge.elementIndexUint?5123:5125,r=5123==i?2:4;ge.gl.drawElements(4,-1==t?this.indicesCount:t,i,e*r);for(var n=0,a=this.useVertexAttributes;n<a;){var s=n++;ge.gl.disableVertexAttribArray(s)}},convertStencilAction:function(e){switch(e){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},convertCompareMode:function(e){switch(e){case 0:return 519;case 1:return 512;case 2:return 514;case 3:return 517;case 4:return 513;case 5:return 515;case 6:return 516;case 7:return 518}},setStencilParameters:function(e,t,i,r,n,a,s){if(null==s&&(s=255),null==a&&(a=255),0==e&&0==t&&0==i&&0==r)ge.gl.disable(2960);else{ge.gl.enable(2960);var o=this.convertCompareMode(e);switch(ge.gl.stencilMask(s),ge.gl.stencilOp(this.convertStencilAction(r),this.convertStencilAction(i),this.convertStencilAction(t)),n._hx_index){case 0:ge.gl.stencilFunc(o,0,a);break;case 1:var l=n.value;ge.gl.stencilFunc(o,l,a)}}},__class__:Jt};var qt=function(e){bt.call(this,e)};r["kha.js.graphics4.Graphics2"]=qt,qt.__name__=!0,qt.__super__=bt,qt.prototype=s(bt.prototype,{begin:function(e,t){null==e&&(e=!0),ge.gl.colorMask(!0,!0,!0,!0),ge.gl.disable(2929),ge.gl.depthFunc(519),bt.prototype.begin.call(this,e,t)},__class__:qt});var $t=function(e){this.value=e};r["kha.js.graphics4.TextureUnit"]=$t,$t.__name__=!0,$t.__interfaces__=[St],$t.prototype={value:null,__class__:$t};var ei=function(){};r["kha.vr.VrInterface"]=ei,ei.__name__=!0,ei.prototype={IsVrEnabled:function(){return!1},__class__:ei};var ti=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,ei.call(this)};r["kha.js.vr.VrInterface"]=ti,ti.__name__=!0,ti.__super__=ei,ti.prototype=s(ei.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var e=this;navigator.getVRDisplays().then(function(t){if(t.length>0){e.frameData=new VRFrameData,e.vrDisplay=t[0],e.vrDisplay.depthNear=.1,e.vrDisplay.depthFar=1024;var i=e.vrDisplay.getEyeParameters("left"),r=e.vrDisplay.getEyeParameters("right");e.width=ge.khanvas.width,e.height=ge.khanvas.height,e.vrWidth=2*Math.max(i.renderWidth,r.renderWidth)|0,e.vrHeight=0|Math.max(i.renderHeight,r.renderHeight)}else b.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:ti});var ii=function(e,t,i,r,n,a,s,o,l){this._00=e,this._10=t,this._20=i,this._01=r,this._11=n,this._21=a,this._02=s,this._12=o,this._22=l};r["kha.math.FastMatrix3"]=ii,ii.__name__=!0,ii.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:ii};var ri=function(e,t,i,r,n,a,s,o,l,u,h,d,c,f,_,g){this._00=e,this._10=t,this._20=i,this._30=r,this._01=n,this._11=a,this._21=s,this._31=o,this._02=l,this._12=u,this._22=h,this._32=d,this._03=c,this._13=f,this._23=_,this._33=g};r["kha.math.FastMatrix4"]=ri,ri.__name__=!0,ri.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ri};var ni=function(){};r["kha.netsync.ControllerBuilder"]=ni,ni.__name__=!0;var ai=function(e,t,i){this.controllers=new I,ai.instance=this,this.maxPlayers=e,this.address=t,this.port=i};r["kha.netsync.Session"]=ai,ai.__name__=!0,ai.the=function(){return ai.instance},ai.prototype={controllers:null,maxPlayers:null,address:null,port:null,sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var i=new x(new ArrayBuffer(this.controllers.h[e]._inputBufferIndex+4+t.length));i.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=i}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},__class__:ai};var si=function(e,t,i,r,n,a){this.tree=e,this.depth=t,this.bounds=new li(i,r,n,a),this.nodes=[],this.shapes=[],this.indexList=[]};r["quadtree.Quad"]=si,si.__name__=!0,si.prototype={depth:null,shapes:null,bounds:null,nodes:null,tree:null,indexList:null,insert:function(e){if(this.nodes.length>0){var t=this.getIndex(e.bounds);if(-1!=t)this.nodes[t].insert(e);else{this.getIndexes(e.bounds,this.indexList);for(var i=0,r=this.indexList;i<r.length;){var n=r[i];++i,this.nodes[n].insert(e)}}}else if(this.shapes.push(e),this.shapes.length>this.tree.maxShapes&&this.depth<this.tree.maxDepth)for(this.split();this.shapes.length>0;){var a=this.shapes.pop(),s=this.getIndex(a.bounds);if(-1==s){this.getIndexes(a.bounds,this.indexList);for(var o=0,l=this.indexList;o<l.length;){var u=l[o];++o,this.nodes[u].insert(a)}}else this.nodes[s].insert(a)}},getShapeList:function(e,t){var i=this.getIndex(e.bounds);if(this.nodes.length>0)if(-1==i){this.getIndexes(e.bounds,this.indexList);for(var r=0,n=this.indexList;r<n.length;){var a=n[r];++r,this.nodes[a].getShapeList(e,t)}}else this.nodes[i].getShapeList(e,t);else for(var s=0,o=this.shapes;s<o.length;){var l=o[s];++s,l!=e&&t.push(l)}},getQuadBounds:function(e){for(var t=0,i=this.nodes;t<i.length;){var r=i[t];++t,r.getQuadBounds(e)}e.push(this.bounds)},clear:function(){for(;this.shapes.length>0;)this.shapes.pop();for(;this.nodes.length>0;){var e=this.nodes.pop();e.clear(),this.tree.putQuad(e)}},reset:function(e,t,i,r,n){this.depth=e,this.bounds.x=t,this.bounds.y=i,this.bounds.width=r,this.bounds.height=n},split:function(){var e=.5*this.bounds.width,t=.5*this.bounds.height,i=this.bounds.x,r=this.bounds.y,n=this.depth+1;this.nodes.push(this.tree.getQuad(n,i,r,e,t)),this.nodes.push(this.tree.getQuad(n,i+e,r,e,t)),this.nodes.push(this.tree.getQuad(n,i,r+t,e,t)),this.nodes.push(this.tree.getQuad(n,i+e,r+t,e,t))},getIndex:function(e){var t=-1,i=this.bounds.x+.5*this.bounds.width,r=this.bounds.y+.5*this.bounds.height,n=e.y+e.height<r,a=e.y>r,s=e.x+e.width<i,o=e.x>i;return s?n?t=0:a&&(t=2):o&&(n?t=1:a&&(t=3)),t},getIndexes:function(e,t){for(;t.length>0;)t.pop();for(var i=0,r=this.nodes.length;i<r;){var n=i++,a=this.nodes[n].bounds;(a.hasPoint(e.x,e.y)||a.hasPoint(e.x+e.width,e.y)||a.hasPoint(e.x,e.y+e.height)||a.hasPoint(e.x+e.width,e.y+e.height))&&t.push(n)}},__class__:si};var oi=function(e,t,i){null==i&&(i=6),null==t&&(t=4),this.bounds=e,this.maxShapes=t,this.maxDepth=i,this.pool=[],this.root=new si(this,1,e.x,e.y,e.width,e.height),this.allBounds=[],this.treeColor=Q.fromFloats(.5,.5,.5)};r["quadtree.Quadtree"]=oi,oi.__name__=!0,oi.prototype={maxShapes:null,maxDepth:null,root:null,pool:null,bounds:null,allBounds:null,treeColor:null,insert:function(e){this.root.insert(e)},getShapeList:function(e,t){if(null==t){var i=[];return this.root.getShapeList(e,i),i}return this.root.getShapeList(e,t),t},clear:function(){this.root.clear(),this.root.reset(1,this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height)},drawTree:function(e){for(;this.allBounds.length>0;)this.allBounds.pop();this.root.getQuadBounds(this.allBounds),e.set_color(this.treeColor);for(var t=0,i=this.allBounds;t<i.length;){var r=i[t];++t,e.drawRect(r.x,r.y,r.width,r.height)}},getQuad:function(e,t,i,r,n){if(this.pool.length>0){var a=this.pool.pop();return a.reset(e,t,i,r,n),a}return new si(this,e,t,i,r,n)},putQuad:function(e){this.pool.push(e)},__class__:oi};var li=function(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r};function ui(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:r=e.hx__closures__[i.__id__],null==r&&(r=i.bind(e),e.hx__closures__[i.__id__]=r),r);var r}r["quadtree.Rect"]=li,li.__name__=!0,li.prototype={x:null,y:null,width:null,height:null,intersects:function(e){return!(this.x+this.width<e.x||this.x>e.x+e.width||this.y+this.width<e.y||this.y>e.y+e.height)},hasPoint:function(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height},__class__:li},t.$haxeUID|=0,r.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),String.prototype.__class__=r.String=String,String.__name__=!0,r.Array=Array,Array.__name__=!0,Date.prototype.__class__=r.Date=Date,Date.__name__="Date";var hi={},di={},ci=Number,fi=Boolean,_i={},gi={};A.count=0;var mi={};Object.defineProperty(M.prototype,"message",{get:function(){return String(this.val)}}),R.__toStr={}.toString,d.width=800,d.height=600,y.DEFAULT_RESOLVER=new w,y.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",F.helper=new DataView(new ArrayBuffer(8)),z.images=new G,z.sounds=new H,z.blobs=new U,z.fonts=new Z,z.videos=new O,J.instance=new J,ue.DIF_COUNT=3,ue.maxframetime=.5,ue.startTime=0,he.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",he.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",he.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",he.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",he.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",he.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",he.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",he.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",he.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",he.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",he.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",he.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",he.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",he.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",he.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",fe.renderListeners=[],fe.foregroundListeners=[],fe.backgroundListeners=[],fe.shutdownListeners=[],ge.mobile=!1,ge.ios=!1,ge.mobileAudioPlaying=!1,ge.chrome=!1,ge.firefox=!1,ge.ie=!1,ge.insideInputEvent=!1,ge.minimumScroll=999,ge.lastFirstTouchX=0,ge.lastFirstTouchY=0,ge.iosSoundEnabled=!1,ge.soundEnabled=!1,ge.iosTouchs=[],ve.windows=[],xe.disableGcInteractions=!1,xe.intBox=new ye(0),xe.virtualChannels=[],ke.lastAllocationCount=0,Pe.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Qe.fontGlyphs=function(e){for(var t=[],i=32;i<256;){var r=i++;t.push(r)}return t}(),Dt.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Dt.instances=[],Dt.connectListeners=[],Dt.disconnectListeners=[],Lt.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Lt.keyBehavior=Et.Default,Vt.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},Rt.exposurePattern=new l("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),Rt.formatPattern=new l("FORMAT=32-bit_rle_rgbe","i"),Rt.widthHeightPattern=new l("-Y ([0-9]+) \\+X ([0-9]+)","i"),Kt.loading=[],ni.nextId=0,d.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);